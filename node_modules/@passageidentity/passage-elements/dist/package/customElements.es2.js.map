{"version":3,"file":"customElements.es2.js","sources":["../../src/composables/useCallbacks.ts","../../src/PassageAuth/router/routes.ts","../../src/PassageAuth/router/router.ts","../../src/PassageAuth/composables/useRouter.ts","../../src/composables/useAutofocusButton.ts","../../src/PassageAuth/components/ActivateMagicLink/components/AddDevice.vue","../../src/PassageAuth/components/ActivateMagicLink/composables/useUIState.ts","../../src/utils/userGestureRequired.ts","../../src/PassageAuth/components/ActivateMagicLink/composables/useWebauthnUtils.ts","../../src/PassageAuth/components/ActivateMagicLink/composables/useMagicLinkUtils.ts","../../src/utils/lastLogin.ts","../../src/PassageAuth/components/ActivateMagicLink/composables/useMagicLinkActivation.ts","../../src/PassageAuth/components/ActivateMagicLink/ActivateMagicLink.vue","../../src/PassageAuth/views/ActivateMagicLinkView.vue","../../src/PassageAuth/composables/useMagicLink.ts","../../src/PassageAuth/components/ValidatedIdentifierForm/IntentifierTypes.ts","../../src/PassageAuth/components/ValidatedIdentifierForm/ValidatedIdentifierForm.vue","../../src/PassageAuth/components/Login/Login.vue","../../src/PassageAuth/components/Register/Register.vue","../../src/services/EphemeralAppService.ts","../../src/PassageAuth/components/EphemeralAppInfo/EphemeralAppInfo.vue","../../src/ui-components/Tooltip.vue","../../src/PassageAuth/components/HelpFooter/HelpFooter.vue","../../src/PassageAuth/views/AuthView.vue","../../src/PassageAuth/views/LoginView.vue","../../src/PassageAuth/views/RegisterView.vue","../../src/ui-components/Spinner.vue","../../src/PassageAuth/components/MagicLink/MagicLink.vue","../../src/PassageAuth/views/MagicLinkView.vue","../../src/PassageAuth/components/RegisterDevice/RegisterDevice.vue","../../src/PassageAuth/views/RegisterDeviceView.vue","../../src/PassageAuth/components/WebauthnSignIn/WebauthnSignIn.vue","../../src/PassageAuth/views/WebauthnSignInView.vue","../../src/PassageAuth/views/RouterView/RouterView.vue"],"sourcesContent":["import { ref, readonly, Ref } from 'vue'\nimport { authResult } from '@passageidentity/passage-js'\n\ninterface IUseCallbacks {\n  beforeAuth: Ref<BeforeAuthCallback>\n  onSuccess: Ref<OnSuccessCallback>\n  onEvent: Ref<OnEventCallback>\n  setBeforeAuth: (newBeforeAuth?: BeforeAuthCallback) => void\n  setOnSuccess: (newOnSuccess?: OnSuccessCallback) => void\n  setOnEvent: (newOnEvent?: OnEventCallback) => void\n}\n\nexport enum OnEventType {\n  onLoaded = 'onLoaded',\n  onRegisterDevice = 'onRegisterDevice',\n  onVerifyIdentity = 'onVerifyIdentity',\n  onMagicLinkLogin = 'onMagicLinkLogin',\n  onMagicLinkRegister = 'onMagicLinkRegister',\n  onMagicLinkActivated = 'onMagicLinkActivated',\n  onMagicLinkActivateSuccess = 'onMagicLinkActivateSuccess',\n}\n\nexport type BeforeAuthCallback = (identifier: string) => boolean\n\nexport type OnSuccessCallback = (authResult: authResult) => void\n\nexport type OnEventCallback = (type: OnEventType, data?: unknown) => void\n\nconst defaultBeforeAuth = () => {\n  return true\n}\n\nconst defaultOnSuccess = (authResult: authResult) => {\n  window.location.href = authResult.redirect_url\n}\n\nconst defaultOnEvent = () => {\n  return\n}\n\nconst beforeAuth = ref<BeforeAuthCallback>(defaultBeforeAuth)\n\nconst onSuccess = ref<OnSuccessCallback>(defaultOnSuccess)\n\nconst onEvent = ref<OnEventCallback>(defaultOnEvent)\n\nfunction setBeforeAuth(newBeforeAuth?: BeforeAuthCallback) {\n  if (newBeforeAuth === undefined) {\n    beforeAuth.value = defaultBeforeAuth\n    return\n  }\n  beforeAuth.value = newBeforeAuth\n}\n\nfunction setOnSuccess(newOnSuccess?: OnSuccessCallback) {\n  if (newOnSuccess === undefined) {\n    onSuccess.value = defaultOnSuccess\n    return\n  }\n  onSuccess.value = newOnSuccess\n}\n\nfunction setOnEvent(newOnEvent?: OnEventCallback) {\n  if (newOnEvent === undefined) {\n    onEvent.value = defaultOnEvent\n    return\n  }\n  onEvent.value = newOnEvent\n}\n\nexport function useCallbacks(): IUseCallbacks {\n  return {\n    beforeAuth: readonly(beforeAuth),\n    onSuccess: readonly(onSuccess),\n    onEvent: readonly(onEvent),\n    setBeforeAuth,\n    setOnSuccess,\n    setOnEvent,\n  }\n}\n","import { IdentifierType } from '@/PassageAuth/components/ValidatedIdentifierForm/IntentifierTypes'\n\nexport interface IRoute<T> {\n  component: string\n  props?: T\n}\n\nexport interface IHomeRouteProps {\n  register?: boolean\n}\nexport const AuthRoute: IRoute<IHomeRouteProps> = {\n  component: 'auth-view',\n}\nexport const LoginRoute: IRoute<IHomeRouteProps> = {\n  component: 'login-view',\n}\nexport const RegisterRoute: IRoute<IHomeRouteProps> = {\n  component: 'register-view',\n}\n\nexport interface IRegisterDeviceRouteProps {\n  identifier: string\n  identifierType: IdentifierType\n}\nexport const RegisterDeviceRoute: IRoute<IRegisterDeviceRouteProps> = {\n  component: 'register-device-view',\n}\n\nexport interface IMagicLinkRouteProps {\n  identifier: string\n  identifierType: IdentifierType\n  setupNewDevice?: boolean\n  userIsRegistering?: boolean\n  identifierVerifying?: boolean\n}\nexport const MagicLinkRoute: IRoute<IMagicLinkRouteProps> = {\n  component: 'magic-link-view',\n}\n\nexport interface IWebauthnSignInRouteProps {\n  identifier: string\n  identifierType: IdentifierType\n}\nexport const WebauthnSignInRoute: IRoute<IWebauthnSignInRouteProps> = {\n  component: 'webauthn-sign-in-view',\n}\n\nexport interface IActivateMagicLinkRouteProps {\n  magicLink: string\n}\nexport const ActivateMagicLinkRoute: IRoute<IActivateMagicLinkRouteProps> = {\n  component: 'activate-magic-link-view',\n}\n\nexport type RouteProps =\n  | IHomeRouteProps\n  | IRegisterDeviceRouteProps\n  | IMagicLinkRouteProps\n  | IWebauthnSignInRouteProps\n  | IActivateMagicLinkRouteProps\n","import { IRoute, IHomeRouteProps, AuthRoute, RouteProps } from './routes'\n\nexport class Router {\n  private _history: IRoute<RouteProps>[] = []\n  private _homeRoute: IRoute<IHomeRouteProps> = AuthRoute\n\n  constructor() {\n    this._history.push(this._homeRoute)\n  }\n\n  get homeRoute(): IRoute<IHomeRouteProps> {\n    return this._homeRoute\n  }\n\n  set homeRoute(homeRoute: IRoute<IHomeRouteProps>) {\n    this._homeRoute = homeRoute\n    this._history[0] = homeRoute\n  }\n\n  get currentRoute(): IRoute<RouteProps> {\n    return this._history[this._history.length - 1]\n  }\n\n  push<T>(route: IRoute<T>, props?: T): void {\n    /* eslint-disable-next-line @typescript-eslint/ban-ts-comment */\n    // @ts-ignore\n    this._history.push({ ...route, props })\n  }\n\n  resetRouter(): void {\n    this._history = []\n    this._homeRoute = AuthRoute\n    this._history.push(this._homeRoute)\n  }\n}\n","import { reactive, computed } from 'vue'\nimport { Router } from '../router/router'\nimport { IRoute, RouteProps } from '../router/routes'\n\nconst router = reactive<Router>(new Router())\nconst currentRoute = computed<IRoute<RouteProps>>(() => router.currentRoute)\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function useRouter() {\n  return {\n    router,\n    currentRoute,\n  }\n}\n","import { Ref, ref, watch } from 'vue'\n\ninterface IAutoFocusButton {\n  autofocusButton: Ref<HTMLElement | undefined>\n}\n\nexport function useAutofocusButton(): IAutoFocusButton {\n  const autofocusButton = ref<HTMLElement>()\n\n  function autofocus() {\n    if (autofocusButton.value === undefined) {\n      return\n    }\n    autofocusButton.value.focus()\n  }\n\n  watch(autofocusButton, () => {\n    autofocus()\n  })\n\n  return {\n    autofocusButton,\n  }\n}\n","<template>\n  <div class=\"title has-text-centered\" :class=\"[showFailure ? 'secondary-title' : 'main-title']\">\n    {{ title }}\n  </div>\n\n  <figure class=\"image has-text-centered\">\n    <inline-svg v-if=\"showFailure\" :src=\"Icons.fingerprintFailed\" alt=\"Device failure\" />\n    <platform-icon v-else />\n  </figure>\n\n  <div class=\"content has-text-centered\" data-test=\"activate-magic-link-message\">\n    <div v-if=\"showFailure\">{{ t('failed-to-add-this-device') }}</div>\n    <div v-else>\n      <div style=\"margin-bottom: 10px\">\n        <strong>{{ t('save-device') }}</strong>\n      </div>\n      <div style=\"margin-bottom: 10px\">\n        {{ t('trust-device') }}\n      </div>\n      <div style=\"margin-bottom: 10px\">\n        {{ t('does-not-give-app-personal-info') }}\n      </div>\n    </div>\n  </div>\n\n  <!-- On Safari, we may need text here so the user knows they need to click because of their browser -->\n  <!-- If this is true, show the button -->\n  <div class=\"flex-row flex-center\" style=\"padding: 20px 0px\">\n    <button\n      @click.prevent=\"onButtonClick\"\n      type=\"button\"\n      class=\"button is-primary\"\n      part=\"button\"\n      :class=\"{ 'is-loading': addPending }\"\n      :disabled=\"addPending\"\n      data-test=\"save-device-button\"\n      ref=\"autofocusButton\"\n    >\n      <span v-if=\"showFailure\">{{ t('try-again') }}</span>\n      <span v-else>{{ t('continue') }}</span>\n    </button>\n  </div>\n\n  <div class=\"link has-text-centered\" v-if=\"!showSuccess\">\n    <div>\n      <a @click.prevent=\"onSkipButtonClick\" role=\"button\" data-test=\"add-device-skip\">{{ t('skip') }}</a>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed } from 'vue'\nimport { authResult, PassageDevice } from '@passageidentity/passage-js'\nimport type { PropType } from 'vue'\nimport { useCallbacks } from '@/composables/useCallbacks'\nimport useAddDevice from '../../../../composables/useAddDevice'\nimport { useAppId } from '@/composables/useAppId'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport PlatformIcon from '@/components/PlatformIcon/PlatformIcon.vue'\nimport { useLocale } from '@/composables/useLocale'\nimport { useAutofocusButton } from '@/composables/useAutofocusButton'\n\nexport default defineComponent({\n  name: 'AddDevice',\n  components: {\n    InlineSvg,\n    PlatformIcon,\n  },\n  props: {\n    authResult: {\n      type: Object as PropType<authResult>,\n      required: false,\n    },\n  },\n  setup(props) {\n    const { t } = useLocale()\n    const { appId } = useAppId()\n    const showFailure = ref<boolean>(false)\n    const showSuccess = ref<boolean>(false)\n    const newDevice = ref<PassageDevice>()\n    const { addDevice, addPending, errorMessage } = useAddDevice(appId.value)\n    const { autofocusButton } = useAutofocusButton()\n\n    const title = computed<string>(() => {\n      if (showFailure.value) {\n        return t('something-went-wrong')\n      } else {\n        return t('success')\n      }\n    })\n\n    async function onButtonClick() {\n      newDevice.value = await addDevice()\n      if (newDevice.value?.id) {\n        showSuccess.value = true\n        showFailure.value = false\n        if (props.authResult?.redirect_url) {\n          useCallbacks().onSuccess.value(props.authResult)\n        }\n      } else {\n        showFailure.value = true\n        showSuccess.value = false\n      }\n    }\n\n    const onSkipButtonClick = () => {\n      if (props.authResult?.redirect_url) {\n        useCallbacks().onSuccess.value(props.authResult)\n      }\n    }\n    return {\n      showSuccess,\n      showFailure,\n      title,\n      addPending,\n      errorMessage,\n      newDevice,\n      onButtonClick,\n      onSkipButtonClick,\n      Icons,\n      t,\n      autofocusButton,\n    }\n  },\n})\n</script>\n","import { useLocale } from '@/composables/useLocale'\nimport { ref, Ref, computed, ComputedRef } from 'vue'\n\nexport interface IUseUIState {\n  showFailure: Ref<boolean>\n  showSuccess: Ref<boolean>\n  loading: Ref<boolean>\n  pageLoading: Ref<boolean>\n  showAddDevice: Ref<boolean>\n  title: ComputedRef<string>\n  uiSuccess: (props: { addDevice: boolean }) => void\n  uiLoading: (props: { addDevice: boolean }) => void\n  uiError: () => void\n}\n\nexport default function useUIState(): IUseUIState {\n  const showFailure = ref<boolean>(false)\n  const showSuccess = ref<boolean>(false)\n  const loading = ref<boolean>(false)\n  const pageLoading = ref<boolean>(true)\n  const showAddDevice = ref<boolean>(false)\n  const { t } = useLocale()\n\n  const title = computed<string>(() => {\n    if (showSuccess.value) {\n      return t('success')\n    }\n    if (showFailure.value) {\n      return t('something-went-wrong')\n    }\n    return t('verify-your-identity')\n  })\n\n  const uiSuccess = ({ addDevice = false }) => {\n    showSuccess.value = true\n    showFailure.value = false\n    showAddDevice.value = addDevice\n    loading.value = false\n  }\n\n  const uiError = () => {\n    showSuccess.value = false\n    showFailure.value = true\n    showAddDevice.value = false\n    loading.value = false\n  }\n\n  const uiLoading = ({ addDevice = false }) => {\n    showSuccess.value = false\n    showFailure.value = false\n    showAddDevice.value = addDevice\n    loading.value = true\n  }\n\n  return {\n    showFailure,\n    showSuccess,\n    loading,\n    pageLoading,\n    showAddDevice,\n    title,\n    uiSuccess,\n    uiError,\n    uiLoading,\n  }\n}\n","export function checkUserGestureRequired(): boolean {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return typeof (window as any).webkitConvertPointFromNodeToPage === 'function'\n}\n","import { Ref, ref } from 'vue'\nimport { Passage } from '@passageidentity/passage-js'\nimport { checkUserGestureRequired } from '@/utils/userGestureRequired'\n\nexport interface IUseWebauthnUtils {\n  deviceRecognized: Ref<boolean>\n  webauthnAllowed: Ref<boolean>\n  userGestureRequired: boolean\n  verifyWebAuthnAllowed: () => Promise<boolean>\n  isDeviceRecognized: (magicLink: string) => boolean\n  checkWebauthnAndDeviceRecognized: (magicLink: string) => Promise<void>\n}\n\nexport default function useWebauthnUtils(passage: Passage): IUseWebauthnUtils {\n  const deviceRecognized = ref<boolean>(false)\n  const webauthnAllowed = ref<boolean>(false)\n\n  const userGestureRequired = checkUserGestureRequired()\n\n  const verifyWebAuthnAllowed = async () => {\n    const appInfo = await passage.appInfo()\n    if (passage.checkWebauthnConfig(appInfo)) {\n      webauthnAllowed.value = await passage.isWebauthnSupported(false)\n    } else {\n      webauthnAllowed.value = false\n    }\n    return webauthnAllowed.value\n  }\n\n  const isDeviceRecognized = (magicLink: string): boolean => {\n    const userID = magicLink.split('.')[2]\n    deviceRecognized.value = webauthnAllowed.value && passage.credIDExists(userID) ? true : false\n    return deviceRecognized.value\n  }\n\n  const checkWebauthnAndDeviceRecognized = async (magicLink: string): Promise<void> => {\n    await verifyWebAuthnAllowed()\n    isDeviceRecognized(magicLink)\n  }\n\n  return {\n    deviceRecognized,\n    webauthnAllowed,\n    userGestureRequired,\n    checkWebauthnAndDeviceRecognized,\n    verifyWebAuthnAllowed,\n    isDeviceRecognized,\n  }\n}\n","import { Ref, ref } from 'vue'\n\nexport enum MagicLinkActionEnum {\n  LOGIN = 'psg_magic_link',\n  VERIFY = 'psg_verify_link',\n}\n\nexport interface IUseMagicLinkUtils {\n  magicLinkAction: Ref<MagicLinkActionEnum | undefined>\n  invalidMagicLink: Ref<boolean>\n  isMagicLinkValid: () => boolean\n}\n\nexport type IUseMagicLinkUtilsComposable = (magicLink: string) => IUseMagicLinkUtils\n\nexport const useMagicLinkUtils: IUseMagicLinkUtilsComposable = (magicLink) => {\n  const magicLinkAction = ref<MagicLinkActionEnum>()\n  const invalidMagicLink = ref<boolean>(false)\n\n  const isMagicLinkValid = () => {\n    const searchParams = new URLSearchParams(window.location.href.split('?')[1])\n    if (searchParams.has(MagicLinkActionEnum.LOGIN)) {\n      magicLinkAction.value = MagicLinkActionEnum.LOGIN\n    } else if (searchParams.has(MagicLinkActionEnum.VERIFY)) {\n      magicLinkAction.value = MagicLinkActionEnum.VERIFY\n    }\n    if (!magicLinkAction.value || !magicLink) {\n      invalidMagicLink.value = true\n    }\n    return !invalidMagicLink.value\n  }\n\n  return {\n    magicLinkAction,\n    invalidMagicLink,\n    isMagicLinkValid,\n  }\n}\n\nexport default useMagicLinkUtils\n","import { useAppId } from '@/composables/useAppId'\nimport { Passage, PassageUserInfo } from '@passageidentity/passage-js'\n\nconst storageKey = 'psg_last_login'\n\nexport function getLastLogin(): string | null {\n  return localStorage.getItem(storageKey)\n}\n\nexport async function storeLastLogin(identiferOrUserInfo?: string | PassageUserInfo): Promise<void> {\n  if (identiferOrUserInfo && typeof identiferOrUserInfo === 'string') {\n    localStorage.setItem(storageKey, identiferOrUserInfo)\n    return\n  }\n  let currentInfo = identiferOrUserInfo as PassageUserInfo | undefined\n  if (identiferOrUserInfo === undefined) {\n    const { appId } = useAppId()\n    const passage = new Passage(appId.value)\n    currentInfo = await passage.getCurrentUser().userInfo()\n  }\n  if (currentInfo === undefined) {\n    return\n  }\n  localStorage.setItem(storageKey, currentInfo.email ? currentInfo.email : currentInfo.phone)\n}\n","import { IUseUIState } from './useUIState'\nimport { IUseMagicLinkUtils } from './useMagicLinkUtils'\nimport { IUseWebauthnUtils } from './useWebauthnUtils'\nimport { Passage, authResult, PassageError, PassageErrorCode } from '@passageidentity/passage-js'\nimport { ref, Ref } from 'vue'\nimport { useCallbacks } from '@/composables/useCallbacks'\nimport { storeLastLogin } from '@/utils/lastLogin'\n\ninterface IUseMagicLinkActivationReturn {\n  authResult: Ref<authResult>\n  onBeforeActivate: () => void\n  onActivateError: () => void\n  onActivateErrorInvalidMagicLink: () => void\n  onActivateSuccess: (props: { addDevice: boolean; result: authResult }) => Promise<void>\n  activateWithBiometrics: () => Promise<void>\n  activateWithoutBiometrics: () => Promise<void>\n}\n\ninterface IUseMagicLinkActivationProps {\n  uiState: IUseUIState\n  magicLinkUtils: IUseMagicLinkUtils\n  passage: Passage\n  magicLink: string\n  webauthnUtils: IUseWebauthnUtils\n}\ntype IUseMagicLinkActivation = (props: IUseMagicLinkActivationProps) => IUseMagicLinkActivationReturn\n\nconst useMagicLinkActivation: IUseMagicLinkActivation = ({\n  magicLink,\n  uiState,\n  magicLinkUtils,\n  passage,\n  webauthnUtils,\n}) => {\n  const authResult = ref<authResult>(null as unknown as authResult)\n\n  const onBeforeActivate = () => {\n    uiState.uiLoading({ addDevice: false })\n    authResult.value = { auth_token: '', redirect_url: '' }\n  }\n\n  const onActivateError = () => {\n    uiState.uiError()\n  }\n\n  const onActivateErrorInvalidMagicLink = () => {\n    magicLinkUtils.invalidMagicLink.value = true\n    uiState.uiError()\n  }\n\n  const onActivateSuccess = async ({ addDevice = false, result }: { addDevice: boolean; result: authResult }) => {\n    authResult.value = result\n    const userInfo = await passage.getCurrentUser().userInfo()\n    storeLastLogin(userInfo)\n    uiState.uiSuccess({ addDevice: addDevice })\n\n    await new Promise((resolve) => {\n      setTimeout(resolve, 1000)\n    })\n\n    if (authResult.value.redirect_url && !uiState.showAddDevice.value) {\n      useCallbacks().onSuccess.value(authResult.value)\n    }\n  }\n\n  const activateWithoutBiometrics = async () => {\n    onBeforeActivate()\n    try {\n      const result = await passage.magicLinkActivate(magicLink)\n      onActivateSuccess({ addDevice: webauthnUtils.webauthnAllowed.value, result })\n      //eslint-disable-next-line  @typescript-eslint/no-explicit-any\n    } catch (err: any) {\n      if (err.statusCode === PassageErrorCode.NotFound) {\n        onActivateErrorInvalidMagicLink()\n      } else {\n        onActivateError()\n      }\n    }\n  }\n  const activateWithBiometrics = async () => {\n    onBeforeActivate()\n    try {\n      const result = await passage.magicLinkActivateWebAuthnLogin(magicLink)\n      onActivateSuccess({ addDevice: false, result })\n      //eslint-disable-next-line  @typescript-eslint/no-explicit-any\n    } catch (err: any) {\n      const error = err as PassageError\n      if (error.statusCode === PassageErrorCode.NotFound) {\n        onActivateErrorInvalidMagicLink()\n      } else if (\n        error.statusCode === PassageErrorCode.PSGCredObjectDoesNotExist ||\n        error.statusCode === PassageErrorCode.Unauthorized\n      ) {\n        activateWithoutBiometrics()\n      } else {\n        onActivateError()\n      }\n    }\n  }\n\n  return {\n    authResult,\n    onBeforeActivate,\n    onActivateError,\n    onActivateErrorInvalidMagicLink,\n    onActivateSuccess,\n    activateWithoutBiometrics,\n    activateWithBiometrics,\n  }\n}\n\nexport default useMagicLinkActivation\n","<template>\n  <div class=\"auth-flex-container\" v-show=\"!pageLoading && !showAddDevice\">\n    <div class=\"title has-text-centered\" :class=\"[showSuccess ? 'main-title' : 'secondary-title']\">\n      {{ showFailure ? (invalidMagicLink ? t('invalid-link') : t('device-login-failed-title')) : title }}\n    </div>\n\n    <figure class=\"image has-text-centered\">\n      <inline-svg v-if=\"showSuccess && webauthnAllowed\" :src=\"Icons.fingerprintSuccess\" alt=\"Device success\" />\n      <inline-svg v-else-if=\"showSuccess && !webauthnAllowed\" :src=\"Icons.emailSuccess\" alt=\"Magic link success\" />\n      <inline-svg\n        v-else-if=\"showFailure && magicLinkAction === MagicLinkActionEnum.VERIFY\"\n        :src=\"Icons.emailFailed\"\n        alt=\"Magic link failure\"\n      />\n      <inline-svg v-else-if=\"showFailure && invalidMagicLink\" :src=\"Icons.emailFailed\" alt=\"Magic link failure\" />\n      <inline-svg v-else-if=\"showFailure && webauthnAllowed\" :src=\"Icons.fingerprintFailed\" alt=\"Device failure\" />\n      <platform-icon v-else-if=\"webauthnAllowed\" />\n    </figure>\n\n    <div class=\"content has-text-centered\" data-test=\"activate-magic-link-message\">\n      <!-- Successful Magic Link Activation or Verification -->\n      <div v-if=\"showSuccess && magicLinkAction === MagicLinkActionEnum.LOGIN\">\n        {{ t('successfully-logged-in-redirect') }}\n      </div>\n\n      <div v-else-if=\"showSuccess && magicLinkAction === MagicLinkActionEnum.VERIFY\">\n        {{ t('successfully-changed-email') }}\n      </div>\n\n      <!-- Magic Link Login or Magic Link Verify link is invalid -->\n      <div v-else-if=\"showFailure && invalidMagicLink && magicLinkAction === MagicLinkActionEnum.VERIFY\">\n        {{ t('link-invalid') }}\n      </div>\n      <div v-else-if=\"showFailure && invalidMagicLink\">{{ t('login-link-invalid') }}</div>\n\n      <!-- Magic Link Activation Failed -->\n      <div v-else-if=\"showFailure && magicLinkAction === MagicLinkActionEnum.VERIFY\">\n        {{ t('verification-failed-please-try-again') }}\n      </div>\n      <div v-else-if=\"showFailure\">{{ t('device-login-failed') }}</div>\n\n      <!-- Prompt User To Login Or Verify Via Webauthn -->\n      <div v-else-if=\"webauthnAllowed && magicLinkAction === MagicLinkActionEnum.LOGIN\">\n        {{ t('log-in-to-proceed') }}\n      </div>\n      <div v-else-if=\"webauthnAllowed && magicLinkAction === MagicLinkActionEnum.VERIFY\">\n        {{ t('verify-your-identity-with-device') }}\n      </div>\n\n      <div v-else-if=\"webauthnAllowed\">\n        {{ t('log-into-your-account-extended') }}\n      </div>\n    </div>\n\n    <!-- On Safari, we may need text here so the user knows they need to click because of their browser -->\n    <!-- If this is true, show the button -->\n    <div\n      class=\"flex-row flex-center\"\n      v-if=\"userGestureRequired || showFailure || showSuccess\"\n      style=\"padding: 20px 0px\"\n    >\n      <button\n        @click.prevent=\"onButtonClick\"\n        type=\"button\"\n        class=\"button is-primary\"\n        part=\"button\"\n        :class=\"{ 'is-loading': loading, 'small': showFailure && invalidMagicLink }\"\n        :disabled=\"loading\"\n        data-test=\"activate-magic-link-button\"\n      >\n        <span v-if=\"showFailure && invalidMagicLink\">{{ t('request-new-link') }}</span>\n        <span v-else-if=\"showFailure\">{{ t('try-again') }}</span>\n        <span v-else-if=\"showSuccess\">{{ t('redirect-now') }}</span>\n        <span v-else>{{ t('login-with-device') }}</span>\n      </button>\n    </div>\n  </div>\n  <div\n    class=\"auth-flex-container\"\n    v-if=\"!pageLoading && showAddDevice\"\n    :style=\"showFailure ? 'justify-content: space-between' : ''\"\n  >\n    <AddDevice :auth-result=\"activation.authResult.value\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, onMounted } from 'vue'\nimport { Passage } from '@passageidentity/passage-js'\nimport { useAppId } from '@/composables/useAppId'\nimport { useCallbacks, OnEventType } from '@/composables/useCallbacks'\nimport AddDevice from './components/AddDevice.vue'\nimport useUIState from './composables/useUIState'\nimport useWebauthnUtils from './composables/useWebauthnUtils'\nimport useMagicLinkUtils, { MagicLinkActionEnum } from './composables/useMagicLinkUtils'\nimport useMagicLinkActivation from './composables/useMagicLinkActivation'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport PlatformIcon from '@/components/PlatformIcon/PlatformIcon.vue'\nimport { useLocale } from '@/composables/useLocale'\n\nexport default defineComponent({\n  name: 'ActivateMagicLink',\n  props: {\n    magicLink: {\n      type: String,\n      required: true,\n    },\n  },\n  components: {\n    AddDevice,\n    InlineSvg,\n    PlatformIcon,\n  },\n  setup(props) {\n    const { t } = useLocale()\n    const { appId } = useAppId()\n    const passage = new Passage(appId.value)\n    const uiState = useUIState()\n    const webauthnUtils = useWebauthnUtils(passage)\n    const magicLinkUtils = useMagicLinkUtils(props.magicLink)\n    const activation = useMagicLinkActivation({\n      uiState,\n      webauthnUtils,\n      magicLinkUtils,\n      passage,\n      magicLink: props.magicLink,\n    })\n\n    function onButtonClick() {\n      if (magicLinkUtils.invalidMagicLink.value) {\n        // need to eliminate the `psg_magic_link` url param before redirecting to EmailInputView\n        window.location.href = window.location.href.split('?')[0]\n      } else {\n        if (webauthnUtils.deviceRecognized.value) {\n          activation.activateWithBiometrics()\n        } else {\n          activation.activateWithoutBiometrics()\n        }\n      }\n    }\n\n    function redirectNow() {\n      if (activation.authResult.value?.redirect_url) {\n        useCallbacks().onSuccess.value(activation.authResult.value)\n      }\n    }\n\n    onMounted(async () => {\n      if (magicLinkUtils.isMagicLinkValid()) {\n        await webauthnUtils.checkWebauthnAndDeviceRecognized(props.magicLink)\n\n        const shouldAutoActivate =\n          !webauthnUtils.deviceRecognized.value ||\n          !webauthnUtils.webauthnAllowed.value ||\n          (!webauthnUtils.userGestureRequired && webauthnUtils.deviceRecognized.value)\n\n        const shouldAutoActivateWithBio = !webauthnUtils.userGestureRequired && webauthnUtils.deviceRecognized.value\n\n        if (shouldAutoActivate) {\n          shouldAutoActivateWithBio ? activation.activateWithBiometrics() : activation.activateWithoutBiometrics()\n        }\n\n        useCallbacks().onEvent.value(OnEventType.onMagicLinkActivateSuccess)\n      } else {\n        uiState.uiError()\n      }\n      uiState.pageLoading.value = false\n    })\n\n    return {\n      ...uiState,\n      ...webauthnUtils,\n      ...magicLinkUtils,\n      activation,\n      MagicLinkActionEnum,\n      onButtonClick,\n      redirectNow,\n      Icons,\n      t,\n    }\n  },\n})\n</script>\n","<template>\n  <div class=\"view-verify-token\">\n    <activate-magic-link :magicLink=\"magicLink\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport ActivateMagicLink from '../components/ActivateMagicLink/ActivateMagicLink.vue'\n\nexport default defineComponent({\n  name: 'ActivateMagicLinkView',\n  props: {\n    magicLink: {\n      type: String,\n      required: true,\n    },\n  },\n  components: {\n    ActivateMagicLink,\n  },\n})\n</script>\n","import { ActivateMagicLinkRoute } from '@/PassageAuth/router/routes'\nimport { onMounted } from 'vue'\nimport { useRouter } from './useRouter'\n\nexport function useMagicLink(): void {\n  const { router } = useRouter()\n  onMounted(() => {\n    const queryString = window.location.search\n    const urlParams = new URLSearchParams(queryString)\n\n    // check to see if URL is psg_magic_link or psg_verify_link\n    let magicLink = null\n    if (urlParams.has('psg_magic_link')) {\n      magicLink = urlParams.get('psg_magic_link')\n    } else if (urlParams.has('psg_verify_link')) {\n      magicLink = urlParams.get('psg_verify_link')\n    }\n\n    if (magicLink !== null) {\n      router.push(ActivateMagicLinkRoute, { magicLink: magicLink })\n    }\n  })\n}\n","import { PassageUserStatus } from '@passageidentity/passage-js'\nexport { Identifier as IdentifierMode } from '@passageidentity/passage-js'\nexport interface IValidatedEmailEvent {\n  identifier: string\n  identifierExists: boolean\n  identifierType: IdentifierType\n  userHasWebauthn: boolean\n  userStatus: PassageUserStatus\n  userID: string\n  emailVerified: boolean\n  phoneVerified: boolean\n  userHasPasskey: boolean\n}\n\nexport enum IdentifierType {\n  phone = 'PHONE',\n  email = 'EMAIL',\n}\n","<template>\n  <form @submit.prevent=\"checkIdentifier\">\n    <div class=\"has-text-centered\" v-show=\"showWelcomeBack\">\n      {{ t('welcome-back-sign-in-as') }}<br /><strong>{{ identifierText }}</strong>\n    </div>\n    <div v-show=\"!showWelcomeBack\">\n      <div class=\"label\" ref=\"labelRef\">{{ label }}</div>\n      <input\n        v-model=\"identifierText\"\n        type=\"text\"\n        class=\"input\"\n        part=\"input\"\n        :class=\"{ 'is-danger': error }\"\n        :autocomplete=\"inputMode\"\n        :inputmode=\"inputMode\"\n        id=\"identifier\"\n        :placeholder=\"placeholder\"\n        @input.prevent=\"clearErrors\"\n        ref=\"identifierInput\"\n        data-test=\"identifier-input\"\n      />\n    </div>\n    <div ref=\"controlContainer\" style=\"width: 100%\"></div>\n    <div\n      :style=\"`text-align: ${showWelcomeUI ? 'center' : 'left'};`\"\n      class=\"help is-danger error-message\"\n      data-test=\"validation-error\"\n    >\n      {{ error }}\n    </div>\n    <slot></slot>\n    <div class=\"flex-row flex-center\">\n      <button type=\"submit\" class=\"button is-primary\" part=\"button\" data-test=\"continue-button\" ref=\"autofocusButton\">\n        {{ t('continue') }}\n      </button>\n    </div>\n    <div v-if=\"showWelcomeUI\" style=\"margin-top: 30px\" class=\"link has-text-centered\">\n      <a @click.prevent=\"switchAccount\" role=\"button\" data-test=\"register-link\">{{ t('switch-account') }}</a>\n    </div>\n  </form>\n</template>\n\n<script lang=\"ts\">\nimport { Passage, PassageUserStatus, WebAuthnType } from '@passageidentity/passage-js'\nimport { computed, defineComponent, HTMLAttributes, onMounted, ref, watch } from 'vue'\nimport { isStringNullish } from '@/utils/stringUtils'\nimport { IdentifierMode, IdentifierType } from './IntentifierTypes'\nimport intlTelInput from 'intl-tel-input'\nimport { useLocale } from '@/composables/useLocale'\nimport { useAutofocusButton } from '@/composables/useAutofocusButton'\n\nexport default defineComponent({\n  name: 'ValidatedIdentiferForm',\n  emits: ['onSubmit', 'update:validationError', 'update:identifier', 'update:countryCode', 'update:showWelcomeBack'],\n  props: {\n    appId: {\n      type: String,\n      required: true,\n    },\n    validationError: {\n      type: String,\n      default: '',\n    },\n    identifier: {\n      type: String,\n      required: true,\n    },\n    countryCode: {\n      type: String,\n      required: true,\n    },\n    identifierMode: {\n      type: String as () => IdentifierMode,\n      required: true,\n    },\n    showWelcomeBack: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  setup(props, context) {\n    const { t } = useLocale()\n    const identifierParseError = ref<string>('')\n    const identifierInput = ref()\n    const controlContainer = ref()\n    const { autofocusButton } = useAutofocusButton()\n\n    const showWelcomeUI = computed<boolean>(() => {\n      return props.showWelcomeBack\n    })\n\n    const label = computed<string>(() => {\n      let identifierType\n      switch (props.identifierMode) {\n        case IdentifierMode.phone:\n          identifierType = t('phone-number')\n          break\n        case IdentifierMode.email:\n          identifierType = t('email-address')\n          break\n        case IdentifierMode.both:\n          identifierType = t('email-or-phone-number')\n          break\n      }\n      return identifierType.charAt(0).toUpperCase() + identifierType.slice(1)\n    })\n\n    const placeholder = computed<string>(() => {\n      return 'example@email.com'\n    })\n\n    const inputMode = computed<HTMLAttributes['inputmode']>(() => {\n      if (props.identifierMode === IdentifierMode.phone) {\n        return 'tel'\n      }\n      return 'email'\n    })\n\n    const identifierText = computed<string>({\n      get(): string {\n        return props.identifier\n      },\n      set(newIdentifier): void {\n        context.emit('update:identifier', newIdentifier)\n      },\n    })\n\n    function formattedIdentifier(): string {\n      if (!identifierText.value) {\n        return ''\n      }\n      // the null assertion is safe because isPhoneNumber already checks if phoneInput is undefined\n      let identifier = identifierText.value\n      // if the welcome UI is shown we just want the value of identifierText since intl-tel-input will be null\n      if (!showWelcomeUI.value) {\n        identifier = isPhoneNumber() ? phoneInput?.getNumber() ?? '' : identifierText.value\n      }\n      return identifier.trim().toLowerCase()\n    }\n\n    const error = computed<string>(() => {\n      if (!isStringNullish(props.validationError)) {\n        return props.validationError\n      }\n      if (!isStringNullish(identifierParseError.value)) {\n        return identifierParseError.value\n      }\n      return ''\n    })\n\n    function clearErrors() {\n      identifierParseError.value = ''\n      context.emit('update:validationError', '')\n    }\n\n    async function checkIdentifier() {\n      if (!validateInput()) {\n        return\n      }\n\n      const passage = new Passage(props.appId)\n      let identifierExists,\n        userHasWebauthn,\n        userHasPasskey,\n        emailVerified,\n        phoneVerified = false\n      let userStatus\n      let userID = ''\n      try {\n        const userInfo = await passage.identifierExists(formattedIdentifier())\n        if (userInfo !== null) {\n          identifierExists = true\n          userHasWebauthn = userInfo.webauthn\n          userStatus = userInfo.status\n          userID = userInfo.id\n          emailVerified = userInfo.email_verified\n          phoneVerified = userInfo.phone_verified\n          userHasPasskey = userInfo.webauthn_types.includes(WebAuthnType.Passkey)\n        } else {\n          identifierExists = false\n          userHasWebauthn = false\n          userStatus = PassageUserStatus.INACTIVE\n        }\n      } catch (e) {\n        let errorMessage\n        switch (props.identifierMode) {\n          case IdentifierMode.email:\n            errorMessage = t('enter-a-valid-email-address')\n            break\n          case IdentifierMode.phone:\n            errorMessage = t('enter-a-valid-phone-number')\n            break\n          case IdentifierMode.both:\n            errorMessage = t('enter-a-valid-email-or-phone-number')\n            break\n        }\n        identifierParseError.value = errorMessage\n        return\n      }\n      context.emit('onSubmit', {\n        identifier: formattedIdentifier(),\n        identifierExists: identifierExists,\n        identifierType: isPhoneNumber() ? IdentifierType.phone : IdentifierType.email,\n        userHasWebauthn: userHasWebauthn,\n        userStatus: userStatus,\n        userID: userID,\n        emailVerified: emailVerified,\n        phoneVerified: phoneVerified,\n        userHasPasskey,\n      })\n    }\n\n    function isEmail(): boolean {\n      // There are a ton of Regular expressions for email validation. I picked this one, but this should be thoroughly tested.\n      const emailRegEx =\n        /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\n      return emailRegEx.test(formattedIdentifier())\n    }\n\n    function isPhoneNumber(): boolean {\n      if (showWelcomeUI.value) {\n        return isPhoneNumberRegex()\n      }\n      if (phoneInput === undefined) {\n        return false\n      }\n      return phoneInput.isValidNumber()\n    }\n\n    function validateInput(): boolean {\n      if (formattedIdentifier() === '') {\n        let message = ''\n        switch (props.identifierMode) {\n          case IdentifierMode.phone:\n            message = t('enter-a-phone-number')\n            break\n          case IdentifierMode.email:\n            message = t('enter-an-email-address')\n            break\n          case IdentifierMode.both:\n            message = t('enter-an-email-or-phone-number')\n            break\n        }\n        identifierParseError.value = message\n        return false\n      } else if (props.identifierMode === IdentifierMode.email && !isEmail()) {\n        identifierParseError.value = t('enter-a-valid-email-address')\n        return false\n      } else if (props.identifierMode === IdentifierMode.phone && !isPhoneNumber()) {\n        identifierParseError.value = t('enter-a-valid-phone-number')\n        return false\n      } else if (props.identifierMode === IdentifierMode.both && !isPhoneNumber() && !isEmail()) {\n        identifierParseError.value = t('enter-a-valid-email-or-phone-number')\n        return false\n      }\n      return true\n    }\n\n    let phoneInput: intlTelInput.Plugin | undefined\n    function showCountryCode() {\n      if (phoneInput !== undefined) {\n        return\n      }\n      // we need the country code shared between login and register boxes so we emit it back up to the prop\n      // this also has the effect of storing the country code when the box is destroyed\n      ;(identifierInput.value as HTMLElement).addEventListener('countrychange', () => {\n        context.emit('update:countryCode', phoneInput?.getSelectedCountryData().iso2 ?? '')\n      })\n      phoneInput = intlTelInput(identifierInput.value, {\n        initialCountry: props.countryCode,\n        utilsScript: 'https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js',\n        dropdownContainer: controlContainer.value,\n        autoPlaceholder: 'aggressive',\n      })\n      identifierInput.value.focus()\n    }\n\n    function hideCountryCode() {\n      if (phoneInput === undefined) {\n        return\n      }\n      phoneInput.destroy()\n      phoneInput = undefined\n      if (identifierInput.value) {\n        identifierInput.value.focus()\n      }\n    }\n\n    function moveInput() {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const parent = ((identifierInput.value as HTMLElement).getRootNode() as any).host as HTMLElement\n      parent.appendChild(identifierInput.value)\n    }\n\n    const labelRef = ref<HTMLElement>()\n\n    function moveBack() {\n      labelRef.value?.append(identifierInput.value)\n    }\n\n    onMounted(() => {\n      if (props.identifierMode === IdentifierMode.phone) {\n        showCountryCode()\n      }\n    })\n\n    // a simpler phone number check that supports partially correct phone numbers\n    // only used to handle the toggling of showing & hiding the country code selector\n    function isPhoneNumberRegex(): boolean {\n      const phoneNumberRegex = /^\\+$|^\\+?[0-9,(,),\\-, ]+$/\n      return phoneNumberRegex.test(identifierText.value.trim())\n    }\n\n    // we only need to switch showing country code if we're in both mode\n    if (props.identifierMode === IdentifierMode.both) {\n      watch(identifierText, () => {\n        if (isPhoneNumberRegex()) {\n          showCountryCode()\n        } else {\n          hideCountryCode()\n        }\n      })\n    }\n\n    // if we recieve a new value for the prop it needs to be manually applied to the\n    // country code selector\n    const countryCodeText = computed<string>(() => {\n      return props.countryCode\n    })\n    watch(countryCodeText, (newValue) => {\n      phoneInput?.setCountry(newValue)\n    })\n\n    function switchAccount() {\n      context.emit('update:showWelcomeBack', false)\n      identifierText.value = ''\n    }\n\n    return {\n      error,\n      identifierText,\n      checkIdentifier,\n      clearErrors,\n      identifierInput,\n      controlContainer,\n      placeholder,\n      label,\n      inputMode,\n      moveInput,\n      labelRef,\n      moveBack,\n      showWelcomeUI,\n      switchAccount,\n      t,\n      autofocusButton,\n    }\n  },\n})\n</script>\n","<template>\n  <validated-identifier-form\n    :appId=\"appId\"\n    :identifierMode=\"identifierMode\"\n    v-model:showWelcomeBack=\"showWelcomeBack\"\n    v-model:identifier=\"identifierText\"\n    v-model:validationError=\"error\"\n    v-model:countryCode=\"countryCodeText\"\n    @onSubmit=\"onSubmit($event)\"\n    ref=\"inputForm\"\n  >\n  </validated-identifier-form>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, ref, PropType, watch, onMounted } from 'vue'\nimport { useMagicLink } from '@/PassageAuth/composables/useMagicLink'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport ValidatedIdentifierForm from '../ValidatedIdentifierForm/ValidatedIdentifierForm.vue'\nimport { IdentifierType, IValidatedEmailEvent } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport { useAppId } from '@/composables/useAppId'\nimport { WebauthnSignInRoute, MagicLinkRoute } from '@/PassageAuth/router/routes'\nimport { useCallbacks, OnEventType } from '@/composables/useCallbacks'\nimport { Identifier, Passage, PassageAppInfo, PassageUserStatus } from '@passageidentity/passage-js'\nimport { getLastLogin } from '@/utils/lastLogin'\nimport { useLocale } from '@/composables/useLocale'\n\nexport default defineComponent({\n  name: 'Login',\n  components: {\n    ValidatedIdentifierForm,\n  },\n  props: {\n    canToggleLoginRegister: Boolean,\n    identifier: {\n      type: String,\n      required: true,\n    },\n    countryCode: {\n      type: String,\n      required: true,\n    },\n    appInfo: {\n      type: Object as PropType<PassageAppInfo>,\n      required: true,\n    },\n    webauthnAllowed: {\n      type: Boolean,\n      required: true,\n    },\n    visible: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  emits: ['update:identifier', 'update:countryCode'],\n  setup(props, context) {\n    const { router } = useRouter()\n    const { appId } = useAppId()\n    const { t } = useLocale()\n    const error = ref<string>('')\n\n    const identifierText = computed<string>({\n      get(): string {\n        return props.identifier\n      },\n      set(newIdentifier): void {\n        context.emit('update:identifier', newIdentifier)\n      },\n    })\n\n    const countryCodeText = computed<string>({\n      get(): string {\n        return props.countryCode\n      },\n      set(newCountryCode): void {\n        context.emit('update:countryCode', newCountryCode)\n      },\n    })\n    const passage = new Passage(appId.value)\n\n    const inputForm = ref<Record<string, unknown>>()\n\n    watch(inputForm, async () => {\n      useCallbacks().onEvent.value(OnEventType.onLoaded)\n    })\n\n    const identifierMode = computed<Identifier>(() => {\n      return props.appInfo.allowed_identifier ?? Identifier.email\n    })\n    useMagicLink()\n\n    async function onSubmit(event: IValidatedEmailEvent) {\n      const {\n        identifier,\n        identifierExists,\n        userHasWebauthn,\n        userHasPasskey,\n        userStatus,\n        userID,\n        identifierType,\n        emailVerified,\n        phoneVerified,\n      } = event\n\n      // if a beforeAuth() callback was defined, call it now\n      const beforeAuthResult = useCallbacks().beforeAuth.value(identifier)\n      if (!beforeAuthResult) {\n        return\n      }\n\n      const errorString = checkIdentifierExistsAndStatus(identifierExists, identifierType, userStatus)\n      if (errorString !== '') {\n        error.value = errorString\n        return\n      }\n\n      if (userNeedsToVerify(emailVerified, phoneVerified, identifierType)) {\n        router.push(MagicLinkRoute, { identifier, identifierType, identifierVerifying: true })\n      } else {\n        const browserInfo = await passage.browserInfo()\n        const tryPasskey = userHasPasskey && window.PublicKeyCredential && browserInfo.getPassKeySupported\n        if (tryPasskey) {\n          useCallbacks().onEvent.value(OnEventType.onVerifyIdentity)\n          router.push(WebauthnSignInRoute, { identifier, identifierType })\n          return\n        }\n        if (props.webauthnAllowed) {\n          if (userHasWebauthn && passage.credIDExists(userID)) {\n            useCallbacks().onEvent.value(OnEventType.onVerifyIdentity)\n            router.push(WebauthnSignInRoute, { identifier, identifierType })\n          } else {\n            // Setup new device\n            useCallbacks().onEvent.value(OnEventType.onMagicLinkLogin)\n            router.push(MagicLinkRoute, { identifier, identifierType, setupNewDevice: true })\n          }\n        } else {\n          useCallbacks().onEvent.value(OnEventType.onMagicLinkLogin)\n          router.push(MagicLinkRoute, { identifier, identifierType })\n        }\n      }\n    }\n\n    function checkIdentifierExistsAndStatus(\n      identifierExists: boolean,\n      identifierType: IdentifierType,\n      userStatus: PassageUserStatus,\n    ): string {\n      if (!identifierExists) {\n        let identiferString = identifierType === IdentifierType.email ? t('email') : t('phone')\n        identiferString = identiferString.charAt(0).toUpperCase() + identiferString.slice(1)\n        let message = t('not-recognized', [identiferString])\n        if (props.canToggleLoginRegister) {\n          message = message + '. ' + t('toggle-register')\n        }\n        return message\n      }\n      if (identifierExists && userStatus === PassageUserStatus.INACTIVE) {\n        return t('account-no-longer-active')\n      }\n      return ''\n    }\n\n    function userNeedsToVerify(\n      emailVerified: boolean,\n      phoneVerified: boolean,\n      identifierType: IdentifierType,\n    ): boolean {\n      if (props.appInfo.require_identifier_verification) {\n        if (\n          (identifierType === IdentifierType.email && !emailVerified) ||\n          (identifierType === IdentifierType.phone && !phoneVerified)\n        ) {\n          return true\n        }\n      }\n      return false\n    }\n\n    const showWelcomeBack = ref<boolean>(false)\n    onMounted(() => {\n      const lastLogin = getLastLogin()\n      if (lastLogin) {\n        identifierText.value = lastLogin\n        showWelcomeBack.value = true\n      }\n    })\n    // clear welcome back autofill when switching to register\n    watch(\n      () => props.visible,\n      () => {\n        if (showWelcomeBack.value === true) {\n          identifierText.value = ''\n        }\n        showWelcomeBack.value = false\n      },\n    )\n\n    return {\n      appId,\n      error,\n      identifierText,\n      countryCodeText,\n      onSubmit,\n      identifierMode,\n      inputForm,\n      showWelcomeBack,\n    }\n  },\n})\n</script>\n","<template>\n  <div>\n    <validated-identifier-form\n      :appId=\"appId\"\n      :identifierMode=\"identifierMode\"\n      v-model:identifier=\"identifierText\"\n      v-model:validationError=\"error\"\n      v-model:countryCode=\"countryCodeText\"\n      @onSubmit=\"onSubmit($event)\"\n    >\n      <user-metadata\n        v-if=\"appInfo && appInfo.layouts.registration.length > 0\"\n        :isEditing=\"true\"\n        :appInfo=\"appInfo\"\n        :layoutType=\"LayoutType.Registration\"\n        :userMetadata=\"metadata\"\n        ref=\"metadataComponent\"\n      />\n    </validated-identifier-form>\n    <div v-if=\"!publicSignup\" class=\"notification is-danger has-text-centered\" data-test=\"invalid-app-id\">\n      {{ t('public-registration-not-allowed') }}\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, ref, PropType } from 'vue'\nimport { useMagicLink } from '@/PassageAuth/composables/useMagicLink'\nimport { useAppId } from '@/composables/useAppId'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport ValidatedIdentifierForm from '../ValidatedIdentifierForm/ValidatedIdentifierForm.vue'\nimport { IdentifierType, IValidatedEmailEvent } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport { MagicLinkRoute, RegisterDeviceRoute } from '@/PassageAuth/router/routes'\nimport { useCallbacks, OnEventType } from '@/composables/useCallbacks'\nimport {\n  Identifier,\n  Metadata,\n  Passage,\n  PassageAppInfo,\n  PassageError,\n  PassageUserStatus,\n} from '@passageidentity/passage-js'\nimport UserMetadata, { LayoutType } from '@/components/UserMetadata/UserMetadata.vue'\nimport { transformMetadata } from '@/PassageProfile/composables/useUpdateUser'\nimport { useLocale } from '@/composables/useLocale'\n\nexport default defineComponent({\n  name: 'Register',\n  props: {\n    canToggleLoginRegister: Boolean,\n    identifier: {\n      type: String,\n      required: true,\n    },\n    countryCode: {\n      type: String,\n      required: true,\n    },\n    appInfo: {\n      type: Object as PropType<PassageAppInfo>,\n      required: true,\n    },\n    webauthnAllowed: {\n      type: Boolean,\n      required: true,\n    },\n  },\n  emits: ['update:identifier', 'update:countryCode'],\n  components: {\n    ValidatedIdentifierForm,\n    UserMetadata,\n  },\n  setup(props, context) {\n    const { t } = useLocale()\n    const { router } = useRouter()\n    const { appId } = useAppId()\n    const error = ref<string>('')\n\n    const identifierText = computed<string>({\n      get(): string {\n        return props.identifier\n      },\n      set(newIdentifier): void {\n        context.emit('update:identifier', newIdentifier)\n      },\n    })\n\n    const countryCodeText = computed<string>({\n      get(): string {\n        return props.countryCode\n      },\n      set(newCountryCode): void {\n        context.emit('update:countryCode', newCountryCode)\n      },\n    })\n\n    const publicSignup = computed<boolean>(() => {\n      return props.appInfo.public_signup\n    })\n\n    const identifierMode = computed<Identifier>(() => {\n      return props.appInfo.allowed_identifier\n    })\n    useMagicLink()\n\n    async function onSubmit(event: IValidatedEmailEvent) {\n      const { identifier, identifierExists, userStatus, identifierType } = event\n\n      // if a beforeAuth() callback was defined, call it now\n      const beforeAuthResult = useCallbacks().beforeAuth.value(identifier)\n      if (!beforeAuthResult) {\n        return\n      }\n      let validMetadata = true\n      if (metadataComponent.value) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        validMetadata = (metadataComponent.value as any).validate()\n      }\n\n      if (identifierExists) {\n        if (userStatus === PassageUserStatus.ACTIVE) {\n          let message = t('account-already-exists', [\n            identifierType === IdentifierType.email ? t('email') : t('phone-number'),\n          ])\n          if (props.canToggleLoginRegister) {\n            message = message + t('toggle-login')\n          }\n          error.value = message\n          return\n        } else if (userStatus === PassageUserStatus.INACTIVE) {\n          error.value = t('account-no-longer-active')\n          return\n        }\n      }\n\n      const passage = new Passage(appId.value)\n      if (!validMetadata) {\n        return\n      }\n      try {\n        await passage.createUser({\n          identifier,\n          user_metadata: transformMetadata(metadata.value, props.appInfo.user_metadata_schema, true),\n        })\n      } catch (err) {\n        if (err instanceof PassageError && err.message.startsWith('Public signup')) {\n          error.value = err.message\n        } else {\n          error.value = t('unexpected-error')\n        }\n\n        return\n      }\n\n      if (props.appInfo.require_identifier_verification) {\n        router.push(MagicLinkRoute, { identifier, identifierType, userIsRegistering: true, identifierVerifying: true })\n      } else {\n        if (props.webauthnAllowed) {\n          useCallbacks().onEvent.value(OnEventType.onRegisterDevice, { identifier })\n          router.push(RegisterDeviceRoute, { identifier, identifierType })\n        } else {\n          useCallbacks().onEvent.value(OnEventType.onMagicLinkRegister, { identifier })\n          router.push(MagicLinkRoute, { identifier, identifierType, userIsRegistering: true })\n        }\n      }\n    }\n\n    const metadata = ref<Metadata>({})\n    const metadataComponent = ref()\n\n    return {\n      appId,\n      error,\n      identifierText,\n      countryCodeText,\n      onSubmit,\n      identifierMode,\n      metadata,\n      metadataComponent,\n      LayoutType,\n      publicSignup,\n      t,\n    }\n  },\n})\n</script>\n","export const ephemeralAppIdKey = 'psg_ephemeral_app_id'\nexport const ephemeralAppNameKey = 'psg_ephemeral_app_name'\n\nexport class EphemeralAppService {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  async newEphemeralApp(): Promise<any> {\n    const ephemeralAppUrl: string = process.env.VUE_APP_ROOT_API + '/v1/apps/'\n    const response = await fetch(ephemeralAppUrl, {\n      method: 'POST',\n      body: JSON.stringify({\n        auth_origin: window.location.origin,\n        name: 'Ephemeral Random ' + (Math.random() * 1000000).toString(),\n      }),\n    })\n    const responseBody = await response.json()\n    if (response.status !== 200) {\n      throw responseBody.message\n    }\n\n    localStorage.setItem(ephemeralAppIdKey, responseBody.app.id)\n    localStorage.setItem(ephemeralAppNameKey, responseBody.app.name)\n\n    return responseBody\n  }\n}\n","<template>\n  <div v-if=\"isEphemeral\">\n    <div v-if=\"error\" class=\"notification is-danger\">\n      {{ t('unable-to-create-test-app') }}\n    </div>\n    <div v-else class=\"notification ephemeral-box\" data-test=\"ephemeral-app-message\">\n      <div v-if=\"!claimed\">\n        {{ t('currently-using-test-app') }}\n        <a :href=\"ephemeralClaimUrl\" target=\"_blank\">{{ t('click-here') }}</a\n        >.<!-- eslint-disable-line @intlify/vue-i18n/no-raw-text-->\n      </div>\n      <div v-else>{{ t('add-your-claimed-app-like-this') }} <br />{{ exampleTag }}</div>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, ref, onBeforeMount } from 'vue'\nimport { Passage } from '@passageidentity/passage-js'\nimport { EphemeralAppService, ephemeralAppIdKey, ephemeralAppNameKey } from '@/services/EphemeralAppService'\nimport { useAppId } from '@/composables/useAppId'\nimport { useLocale } from '@/composables/useLocale'\nexport default defineComponent({\n  name: 'EphemeralAppInfo',\n  setup() {\n    const consoleUrl = process.env.VUE_APP_CONSOLE_URL || ''\n\n    const { t } = useLocale()\n\n    const error = ref<boolean>(false)\n    const isEphemeral = ref<boolean>(false)\n    const claimed = ref<boolean>(false)\n    const ephemeralClaimUrl = ref<string>('')\n    const exampleTag = ref<string>('')\n\n    const passageWebSetup = async (): Promise<void> => {\n      const { appIdUnassigned, updateAppId } = useAppId()\n      if (appIdUnassigned.value) {\n        isEphemeral.value = true\n        const ephemeralAppId: string | null = localStorage.getItem(ephemeralAppIdKey)\n        const ephemeralAppName: string | null = localStorage.getItem(ephemeralAppNameKey)\n        // If ephemeral app exists in localStorage\n        if (ephemeralAppId) {\n          const nameParam = ephemeralAppName ? `?name=${encodeURIComponent(ephemeralAppName)}` : ''\n          ephemeralClaimUrl.value = `${consoleUrl}/claim/${ephemeralAppId}${nameParam}`\n          updateAppId(ephemeralAppId)\n          logToConsole()\n        }\n        // Create new ephemeral app\n        else {\n          try {\n            const ephemeralService = new EphemeralAppService()\n            const res = await ephemeralService.newEphemeralApp()\n            updateAppId(res.app.id)\n            const nameParam = res.app.name ? `?name=${encodeURIComponent(res.app.name)}` : ''\n            ephemeralClaimUrl.value = `${consoleUrl}/claim/${res.app.id}${nameParam}`\n            logToConsole()\n          } catch (err) {\n            error.value = true\n            updateAppId('')\n          }\n        }\n      }\n    }\n\n    const checkIfClaimed = async (): Promise<void> => {\n      const { appId } = useAppId()\n      if (!isEphemeral.value) {\n        return\n      }\n      const passage = new Passage(appId.value)\n      try {\n        const res = await passage.appInfo()\n        if (!res.ephemeral) {\n          claimed.value = true\n          exampleTag.value = `<passage-auth app-id=\"${appId.value}\"/>`\n        }\n      } catch {\n        error.value = true\n      }\n    }\n\n    function logToConsole() {\n      const { appId } = useAppId()\n      console.info(`Passage Test App ID: ${appId.value}`)\n      console.info(`Claim your app: ${ephemeralClaimUrl.value}`)\n    }\n\n    onBeforeMount(async () => {\n      await passageWebSetup()\n      await checkIfClaimed()\n    })\n\n    return {\n      error,\n      isEphemeral,\n      claimed,\n      ephemeralClaimUrl,\n      exampleTag,\n      t,\n    }\n  },\n})\n</script>\n","<template>\n  <div class=\"passage-tooltip\" :class=\"`${position} ${cssVisible ? 'show-tooltip' : ''}`\" ref=\"parentItem\">\n    <div\n      v-if=\"active\"\n      v-show=\"domVisible\"\n      class=\"passage-tooltip-body\"\n      :class=\"position\"\n      :style=\"`max-width: ${width}px; ${maxHeight} ${absoluteHeight}`\"\n      @mouseenter.stop=\"clickMode ? () => {} : cancelHide()\"\n      @mouseleave.stop=\"clickMode ? () => {} : hide()\"\n      ref=\"tooltipBody\"\n    >\n      <div v-if=\"title || clickMode\" class=\"tooltip-header\">\n        <div>{{ title }}</div>\n        <inline-svg v-if=\"clickMode\" :src=\"Icons.close\" style=\"cursor: pointer\" @click.stop=\"hide\" />\n      </div>\n      <div class=\"tooltip-content\">\n        <slot name=\"tooltipBody\">{{ label }}</slot>\n      </div>\n    </div>\n    <div\n      style=\"cursor: pointer; user-select: none\"\n      @mouseenter.prevent=\"clickMode ? () => {} : show()\"\n      @mouseleave.prevent=\"clickMode ? () => {} : hide()\"\n      @click.stop=\"handleClick\"\n    >\n      <slot></slot>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, onMounted, PropType, ref } from 'vue'\nimport InlineSvg from 'vue-inline-svg'\nimport { Icons } from '@/utils/Icons'\n\nexport enum TooltipPosition {\n  isTop = 'is-top',\n  isBottom = 'is-bottom',\n  isLeft = 'is-left',\n  isRight = 'is-right',\n}\n\nexport default defineComponent({\n  name: 'Tooltip',\n  components: {\n    InlineSvg,\n  },\n  props: {\n    label: String,\n    active: {\n      type: Boolean,\n      default: true,\n    },\n    sticky: {\n      type: Boolean,\n      default: false,\n    },\n    position: {\n      type: String as PropType<TooltipPosition>,\n      default: TooltipPosition.isTop,\n    },\n    clickMode: {\n      type: Boolean,\n      default: false,\n    },\n    title: {\n      type: String,\n      default: '',\n    },\n  },\n  setup(props) {\n    const parentItem = ref()\n    const tooltipBody = ref<HTMLElement>()\n    const width = ref<number>(0)\n    const maxHeight = ref<string>('')\n    const absoluteHeight = ref<string>('')\n    const cssVisible = ref<boolean>(props.sticky)\n    const domVisible = ref<boolean>(props.sticky)\n\n    function calculateTooltipSize(): void {\n      const absoluteMaxWidth = 500\n      if (parentItem.value === undefined || parentItem.value === null) {\n        return\n      }\n      const parentItemDiv = parentItem.value as HTMLElement\n      const viewport = (parentItemDiv.getRootNode() as ShadowRoot).getElementById('passage-auth-container')\n      if (viewport === null) {\n        return\n      }\n      const { left: viewLeft, right: viewRight } = viewport.getBoundingClientRect()\n      const { left: itemLeft, right: itemRight, top: itemTop } = parentItemDiv.getBoundingClientRect()\n      const itemMidpoint = (itemRight - itemLeft) / 2 + itemLeft\n      const spaceLeft = itemMidpoint - viewLeft - 20\n      const spaceRight = viewRight - itemMidpoint - 20\n      let viewportSafeWidth\n      const viewportSafeHeight = itemTop - 20\n      switch (props.position) {\n        case TooltipPosition.isTop:\n        case TooltipPosition.isBottom:\n          viewportSafeWidth = viewRight - viewLeft - 20\n          break\n        case TooltipPosition.isLeft:\n          viewportSafeWidth = spaceLeft\n          break\n        case TooltipPosition.isRight:\n          viewportSafeWidth = spaceRight\n          break\n      }\n      maxHeight.value = `max-height: ${viewportSafeHeight}px;`\n      width.value = Math.min(viewportSafeWidth, absoluteMaxWidth)\n    }\n\n    function calculateScrollHeight() {\n      const parentItemDiv = parentItem.value as HTMLElement\n      const { top: itemTop } = parentItemDiv.getBoundingClientRect()\n      const contentHeight = tooltipBody.value?.scrollHeight || 0\n      const viewportSafeHeight = itemTop - 20\n      if (contentHeight > viewportSafeHeight) {\n        absoluteHeight.value = `height: ${viewportSafeHeight}px;`\n      }\n    }\n\n    function show(): void {\n      if (props.sticky) {\n        return\n      }\n      clearTimeout(hideTimeout)\n      clearTimeout(innerTimeout)\n      domVisible.value = true\n      calculateTooltipSize()\n      setTimeout(() => {\n        cssVisible.value = true\n        calculateScrollHeight()\n      }, 100)\n    }\n\n    let hideTimeout: NodeJS.Timeout\n    let innerTimeout: NodeJS.Timeout\n    function hide(): void {\n      if (props.sticky) {\n        return\n      }\n      hideTimeout = setTimeout(() => {\n        cssVisible.value = false\n        innerTimeout = setTimeout(() => {\n          domVisible.value = false\n        }, 150)\n      }, 100)\n    }\n\n    function cancelHide(): void {\n      clearTimeout(hideTimeout)\n      clearTimeout(innerTimeout)\n    }\n\n    function handleClick(): void {\n      if (domVisible.value) {\n        hide()\n      } else {\n        show()\n      }\n    }\n\n    onMounted(() => {\n      calculateTooltipSize()\n    })\n\n    return {\n      parentItem,\n      width,\n      maxHeight,\n      absoluteHeight,\n      cssVisible,\n      domVisible,\n      show,\n      hide,\n      cancelHide,\n      handleClick,\n      Icons,\n      tooltipBody,\n    }\n  },\n})\n</script>\n","<template>\n  <div style=\"border-top: 1px solid #dddddd; margin-top: 20px; padding-top: 15px\">\n    <tooltip :title=\"t('where-is-the-password-field')\" :position=\"TooltipPosition.isTop\" clickMode>\n      <template #tooltipBody>\n        <div style=\"text-align: left\">\n          {{ t('helper-footer-line-1', [appInfo?.name ?? '']) }}\n          <ul>\n            <li>\n              {{ t('helper-footer-bullet-0') }}\n            </li>\n            <li>{{ t('helper-footer-bullet-1') }}</li>\n            <li>\n              {{ t('helper-footer-bullet-2', [allowedIdentifier]) }}\n            </li>\n          </ul>\n          <div style=\"margin-top: 10px\">{{ t('helper-footer-line-2', [allowedIdentifier]) }}</div>\n        </div>\n      </template>\n      <div class=\"flex-row flex-center\">\n        <span style=\"opacity: 0.5\" class=\"link\">{{ t('where-is-the-password-field') }}</span\n        ><inline-svg style=\"margin-left: 10px\" :src=\"Icons.help\" />\n      </div>\n    </tooltip>\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport Tooltip, { TooltipPosition } from '@/ui-components/Tooltip.vue'\nimport { PassageAppInfo, Identifier } from '@passageidentity/passage-js'\nimport { computed } from '@vue/reactivity'\nimport InlineSvg from 'vue-inline-svg'\nimport { Icons } from '@/utils/Icons'\nimport { useLocale } from '@/composables/useLocale'\n\nconst props = defineProps<{\n  appInfo?: PassageAppInfo\n}>()\n\nconst { t } = useLocale()\n\nconst allowedIdentifier = computed<string>(() => {\n  switch (props.appInfo?.allowed_identifier) {\n    case Identifier.phone:\n      return t('phone-number')\n    case Identifier.both:\n      return t('email-or-phone-number')\n    default:\n      return t('email-address')\n  }\n})\n</script>\n","<template>\n  <div class=\"view-email-input\">\n    <div class=\"auth-flex-container\">\n      <div v-if=\"!loading\" class=\"title main-title has-text-centered\">\n        {{ showLogin ? t('login-title') : t('register-title') }}\n      </div>\n      <div style=\"height: 20px\"></div>\n      <login\n        v-if=\"!loading\"\n        v-show=\"showLogin\"\n        v-model:identifier=\"identifier\"\n        :canToggleLoginRegister=\"true\"\n        v-model:countryCode=\"countryCode\"\n        :appInfo=\"appInfo!\"\n        :webauthnAllowed=\"webauthnAllowed\"\n        :visible=\"showLogin\"\n      ></login>\n      <register\n        v-if=\"!loading\"\n        v-show=\"!showLogin\"\n        v-model:identifier=\"identifier\"\n        :canToggleLoginRegister=\"true\"\n        v-model:countryCode=\"countryCode\"\n        :appInfo=\"appInfo!\"\n        :webauthnAllowed=\"webauthnAllowed\"\n      />\n      <div v-if=\"invalidAppId\" class=\"notification is-danger has-text-centered\" data-test=\"invalid-app-id\">\n        {{ t('invalid-app-id') }}\n      </div>\n      <div class=\"spacer\">\n        <ephemeral-app-info />\n      </div>\n      <div v-if=\"!loading\" class=\"link has-text-centered\">\n        <div v-if=\"showLogin && publicSignup\">\n          {{ t('dont-have-an-account') }}\n          <a @click.prevent=\"changeInputPage\" role=\"button\" data-test=\"register-link\">{{ t('register-here') }}</a>\n        </div>\n        <div v-else-if=\"!showLogin\">\n          {{ t('already-have-an-account') }}\n          <a @click.prevent=\"changeInputPage\" role=\"button\" data-test=\"login-link\">{{ t('login-here') }}</a>\n        </div>\n      </div>\n      <help-footer v-if=\"!loading\" :appInfo=\"appInfo\" />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref } from 'vue'\nimport { useAppInfo } from '@/composables/useAppInfo'\nimport Login from '../components/Login/Login.vue'\nimport Register from '../components/Register/Register.vue'\nimport EphemeralAppInfo from '../components/EphemeralAppInfo/EphemeralAppInfo.vue'\nimport HelpFooter from '../components/HelpFooter/HelpFooter.vue'\nimport { useLocale } from '@/composables/useLocale'\nimport { useDefaultCountryCode } from '@/composables/useDefaultCountryCode'\n\nconst { t } = useLocale()\n\nconst props = defineProps<{\n  register?: boolean\n}>()\n\nconst showLogin = ref<boolean>(!props.register)\n\nconst { appInfo, loading, webauthnAllowed, invalidAppId } = useAppInfo()\n\nconst identifier = ref<string>('')\n\nconst { defaultCountryCode } = useDefaultCountryCode()\nconst countryCode = defaultCountryCode\n\nconst publicSignup = computed<boolean>(() => {\n  return appInfo.value ? appInfo.value?.public_signup : false\n})\n\nfunction changeInputPage() {\n  showLogin.value = !showLogin.value\n}\n</script>\n","<template>\n  <div class=\"view-email-input\">\n    <login\n      v-if=\"!loading\"\n      v-model:identifier=\"identifier\"\n      v-model:countryCode=\"countryCode\"\n      :canToggleLoginRegister=\"false\"\n      :appInfo=\"appInfo!\"\n      :webauthnAllowed=\"webauthnAllowed\"\n    ></login>\n    <div v-if=\"invalidAppId\" class=\"notification is-danger has-text-centered\" data-test=\"invalid-app-id\">\n      {{ t('invalid-app-id') }}\n    </div>\n    <help-footer v-if=\"!loading\" :appInfo=\"appInfo\" />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { useAppInfo } from '@/composables/useAppInfo'\nimport { ref } from 'vue'\nimport Login from '../components/Login/Login.vue'\nimport HelpFooter from '../components/HelpFooter/HelpFooter.vue'\nimport { useLocale } from '@/composables/useLocale'\nimport { useDefaultCountryCode } from '@/composables/useDefaultCountryCode'\n\nconst { t } = useLocale()\n\nconst identifier = ref<string>('')\nconst { defaultCountryCode } = useDefaultCountryCode()\nconst countryCode = defaultCountryCode\n\nconst { appInfo, loading, webauthnAllowed, invalidAppId } = useAppInfo()\n</script>\n","<template>\n  <div class=\"view-email-input\">\n    <register\n      v-if=\"!loading\"\n      v-model:identifier=\"identifier\"\n      v-model:countryCode=\"countryCode\"\n      :canToggleLoginRegister=\"false\"\n      :appInfo=\"appInfo!\"\n      :webauthnAllowed=\"webauthnAllowed\"\n    />\n    <div v-if=\"invalidAppId\" class=\"notification is-danger has-text-centered\" data-test=\"invalid-app-id\">\n      {{ t('invalid-app-id') }}\n    </div>\n    <help-footer v-if=\"!loading\" :appInfo=\"appInfo\" />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { useAppInfo } from '@/composables/useAppInfo'\nimport { ref } from 'vue'\nimport Register from '../components/Register/Register.vue'\nimport HelpFooter from '../components/HelpFooter/HelpFooter.vue'\nimport { useLocale } from '@/composables/useLocale'\nimport { useDefaultCountryCode } from '@/composables/useDefaultCountryCode'\n\nconst { t } = useLocale()\n\nconst identifier = ref<string>('')\nconst { defaultCountryCode } = useDefaultCountryCode()\nconst countryCode = defaultCountryCode\n\nconst { appInfo, loading, webauthnAllowed, invalidAppId } = useAppInfo()\n</script>\n","<template>\n  <div class=\"spinner-box\">\n    <div class=\"spinner-content\">\n      <slot></slot>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\n\nexport default defineComponent({\n  name: 'Spinner',\n})\n</script>\n","<template>\n  <div class=\"auth-flex-container\">\n    <div class=\"title has-text-centered\">\n      <span>{{ title }}</span>\n    </div>\n\n    <spinner>\n      <inline-svg v-if=\"isEmail\" :src=\"Icons.email\" alt=\"Email envelope\" />\n      <inline-svg v-else :src=\"Icons.phone\" alt=\"Message bubbles\" />\n    </spinner>\n\n    <div v-if=\"message\" class=\"content has-text-centered\" style=\"margin-bottom: 15px !important\">\n      <span v-html=\"message\"></span>\n    </div>\n\n    <div class=\"flex-row flex-center\">\n      <button\n        @click.prevent=\"resendMagicLink\"\n        type=\"button\"\n        class=\"button is-primary\"\n        part=\"button\"\n        :disabled=\"loading\"\n      >\n        {{ t('resend-isemail-email-message', [isEmail ? t('email') : t('message')]) }}\n      </button>\n    </div>\n\n    <div class=\"spacer\"></div>\n\n    <div class=\"link has-text-centered\">\n      <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n        t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n      }}</a>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref } from 'vue'\nimport { Passage, authResult as AuthResult } from '@passageidentity/passage-js'\nimport { useAppId } from '@/composables/useAppId'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport { useCallbacks, OnEventType } from '@/composables/useCallbacks'\nimport { IdentifierType } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport Spinner from '../../../ui-components/Spinner.vue'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport { storeLastLogin } from '@/utils/lastLogin'\nimport { useLocale } from '@/composables/useLocale'\n\nconst props = defineProps<{\n  identifier: string\n  userIsRegistering: boolean\n  identifierVerifying: boolean\n  setupNewDevice: boolean\n  identifierType: IdentifierType\n}>()\nconst { t, locale } = useLocale()\nconst { appId } = useAppId()\nconst passage = new Passage(appId.value)\nconst { router } = useRouter()\nconst isEmail = computed<boolean>(() => {\n  return props.identifierType === IdentifierType.email\n})\n\nconst title = computed<string>(() => {\n  if (props.identifierVerifying) {\n    if (isEmail.value) {\n      if (props.userIsRegistering) {\n        return t('verify-email-to-register')\n      } else {\n        return t('verify-email-to-login')\n      }\n    } else {\n      if (props.userIsRegistering) {\n        return t('verify-phone-to-register')\n      } else {\n        return t('verify-phone-to-login')\n      }\n    }\n  } else {\n    if (isEmail.value) {\n      if (props.userIsRegistering) {\n        return t('check-email-to-register')\n      } else {\n        return t('check-email-to-login')\n      }\n    } else {\n      if (props.userIsRegistering) {\n        return t('check-phone-to-register')\n      } else {\n        return t('check-phone-to-login')\n      }\n    }\n  }\n})\n\nconst message = computed<string>(() => {\n  let messageValue = ''\n  const messageType = props.identifierType === IdentifierType.email ? t('messagetype-email') : t('messagetype-sms')\n  const messageMedium = props.identifierType === IdentifierType.email ? t('email') : t('phone-number')\n  const registrationType = props.userIsRegistering ? t('registration') : t('login')\n  const loginMessage = props.identifierVerifying\n    ? t('please-verify-identifier', [messageMedium, registrationType])\n    : t('you-will-be-automatically-signed-in')\n  messageValue = t('weve-sent-messagetype', [messageType, props.identifier, loginMessage])\n  if (props.setupNewDevice && !props.userIsRegistering) {\n    messageValue = t('we-dont-recognize-this-device') + ' ' + messageValue\n  }\n  return messageValue\n})\n\nonMounted(() => {\n  if (props.userIsRegistering) {\n    magicLinkSendRegister()\n  } else {\n    magicLinkSendLogin()\n  }\n})\n\nfunction changeEmail() {\n  localStorage.removeItem('email')\n  localStorage.removeItem('magic_link_id')\n  localStorage.removeItem('wait_count')\n  waitForActivatedMagicLink(721) // past the 1 hour polling limit\n  router.push(router.homeRoute)\n}\n\nasync function resendMagicLink(): Promise<void> {\n  await magicLinkSendLogin()\n}\n\nconst showWaiting = ref<boolean>(false)\nconst loading = ref<boolean>(true)\nasync function magicLinkSendRegister() {\n  showWaiting.value = false\n  loading.value = true\n\n  // Wait n seconds so user knows something happened\n  await new Promise((resolve) => {\n    setTimeout(resolve, 2000)\n  })\n\n  try {\n    const res = await passage.newRegisterMagicLink(props.identifier, locale.value.split('-')[0])\n\n    if (res.id != '') {\n      localStorage.setItem('magic_link_id', res.id)\n      waitForActivatedMagicLink(0)\n    }\n  } catch (err) {\n    console.log('magicLinkSend error', err)\n  } finally {\n    loading.value = false\n  }\n}\n\nasync function magicLinkSendLogin() {\n  showWaiting.value = false\n  loading.value = true\n\n  try {\n    const res = await passage.newLoginMagicLink(props.identifier, locale.value.split('-')[0])\n\n    if (res.id != '') {\n      localStorage.setItem('magic_link_id', res.id)\n      waitForActivatedMagicLink(0)\n    }\n  } catch (err) {\n    console.log('magicLinkSend error', err)\n  } finally {\n    // Disable the resend email button for 3 seconds\n    await new Promise((resolve) => {\n      setTimeout(resolve, 3000)\n    })\n    loading.value = false\n  }\n}\n\nlet authResult: AuthResult | undefined = undefined\nasync function lookupMagicLink() {\n  const id = localStorage.getItem('magic_link_id')\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  await lookupMagicLinkActivated(id!).then(async () => {\n    if (authResult && authResult.redirect_url != '') {\n      localStorage.removeItem('magic_link_id')\n      localStorage.removeItem('wait_count')\n      await storeLastLogin()\n      useCallbacks().onEvent.value(OnEventType.onMagicLinkActivated)\n      useCallbacks().onSuccess.value(authResult)\n    }\n  })\n}\nasync function lookupMagicLinkActivated(id: string) {\n  await passage\n    .getMagicLinkStatus(id)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    .then((res: AuthResult) => {\n      waitForActivatedMagicLink(721) //past the 1 hour polling limit -- stops lookup\n      authResult = res\n    })\n    .catch(() => {\n      // this is a totally normal error to get to, so don't do anything\n      // waiting for the user to click the magic link\n      //console.error('lookup error', e)\n    })\n  return\n}\n\nlet timer: NodeJS.Timeout\nfunction waitForActivatedMagicLink(count: number) {\n  let i = count\n  if (i < 720) {\n    showWaiting.value = true\n    timer = setTimeout(async () => {\n      delay(i)\n      i++\n      waitForActivatedMagicLink(i)\n    }, 5000)\n  } else {\n    clearTimeout(timer)\n    showWaiting.value = false\n    return\n  }\n}\n\nfunction delay(i: number) {\n  lookupMagicLink()\n  localStorage.setItem('wait_count', i.toString())\n}\n</script>\n","<template>\n  <div class=\"view-access-token\">\n    <magic-link\n      :identifier=\"identifier\"\n      :userIsRegistering=\"userIsRegistering\"\n      :identifierVerifying=\"identifierVerifying\"\n      :setupNewDevice=\"setupNewDevice\"\n      :identifierType=\"identifierType\"\n    />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport MagicLink from '../components/MagicLink/MagicLink.vue'\nimport { IdentifierType } from '../components/ValidatedIdentifierForm/IntentifierTypes'\n\nexport default defineComponent({\n  name: 'MagicLinkView',\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    userIsRegistering: {\n      type: Boolean,\n      default: false,\n    },\n    identifierVerifying: {\n      type: Boolean,\n      default: false,\n    },\n    setupNewDevice: {\n      type: Boolean,\n      default: false,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  components: {\n    MagicLink,\n  },\n})\n</script>\n","<template>\n  <div class=\"auth-flex-container\">\n    <div class=\"title secondary-title has-text-centered\">\n      {{ title }}\n    </div>\n\n    <figure class=\"image has-text-centered\">\n      <inline-svg\n        v-if=\"showFailure && isEmail\"\n        :src=\"Icons.loginWithEmail\"\n        alt=\"Biometrics scan failed\"\n        style=\"margin: 5px\"\n      />\n      <inline-svg\n        v-else-if=\"showFailure && !isEmail\"\n        :src=\"Icons.loginWithText\"\n        alt=\"Biometrics scan failed\"\n        style=\"margin: 5px\"\n      />\n      <platform-icon v-else />\n    </figure>\n\n    <div\n      class=\"content wrap-text has-text-centered\"\n      style=\"margin-bottom: 10px !important\"\n      data-tag=\"register-device-message\"\n    >\n      <div v-if=\"identifier\" style=\"margin-bottom: 5px\">\n        <strong>{{ identifier }}</strong>\n      </div>\n      <div v-if=\"showFailure\">\n        <p>\n          {{\n            isEmail ? t('registration-with-link-error-message-email') : t('registration-with-link-error-message-phone')\n          }}\n        </p>\n      </div>\n      <div v-else>\n        <div style=\"margin-bottom: 10px\">\n          {{ t('register-your-account') }}\n        </div>\n        <div>\n          {{ t('does-not-give-app-personal-info') }}\n        </div>\n      </div>\n    </div>\n\n    <div class=\"flex-row flex-center\" v-if=\"showFailure\">\n      <button\n        @click.prevent=\"registerWithEmail\"\n        type=\"button\"\n        part=\"button\"\n        class=\"button is-primary small\"\n        :disabled=\"loading\"\n        style=\"margin-right: 5px\"\n        data-test=\"login-with-email-button\"\n        ref=\"autofocusButton\"\n      >\n        {{ t('send-email-or-text-link', [isEmail ? t('email') : t('sms-text')]) }}\n      </button>\n      <button\n        @click.prevent=\"onButtonClick\"\n        type=\"button\"\n        part=\"button\"\n        class=\"button is-secondary small\"\n        :disabled=\"loading\"\n        style=\"margin-left: 5px\"\n      >\n        {{ t('try-again') }}\n      </button>\n    </div>\n\n    <div class=\"flex-row flex-center\" v-else>\n      <button\n        @click.prevent=\"onButtonClick\"\n        type=\"button\"\n        class=\"button\"\n        part=\"button\"\n        :class=\"[{ 'is-loading': loading }]\"\n        :disabled=\"loading\"\n        data-test=\"register-main-button\"\n        tabindex=\"0\"\n        ref=\"autofocusButton\"\n      >\n        <span>{{ t('register-with-device') }}</span>\n      </button>\n    </div>\n\n    <div class=\"content has-text-centered\" style=\"margin-top: 20px !important\" v-if=\"showFailure\">\n      <div class=\"link\">\n        <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n          t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n        }}</a>\n      </div>\n    </div>\n\n    <div class=\"spacer\" v-if=\"!showFailure\"></div>\n\n    <div class=\"flex-row flex-wrap flex-between\" v-if=\"!showFailure\">\n      <div class=\"link\">\n        <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n          t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n        }}</a>\n      </div>\n      <div class=\"link\">\n        <a @click.prevent=\"registerWithEmail\" role=\"button\" data-test=\"register-email-button\">{{\n          t('register-with-link', [isEmail ? t('email') : t('sms-text')])\n        }}</a>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, ref } from 'vue'\nimport { Passage, authResult } from '@passageidentity/passage-js'\nimport { useAppId } from '@/composables/useAppId'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport { MagicLinkRoute } from '@/PassageAuth/router/routes'\nimport { useCallbacks } from '@/composables/useCallbacks'\nimport { IdentifierType } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport PlatformIcon from '@/components/PlatformIcon/PlatformIcon.vue'\nimport { storeLastLogin } from '@/utils/lastLogin'\nimport { useLocale } from '@/composables/useLocale'\nimport { useAutofocusButton } from '@/composables/useAutofocusButton'\n\nexport default defineComponent({\n  name: 'RegisterDevice',\n  components: {\n    InlineSvg,\n    PlatformIcon,\n  },\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  setup(props) {\n    const { t } = useLocale()\n    const { appId } = useAppId()\n    const { router } = useRouter()\n    const { onSuccess } = useCallbacks()\n    const showFailure = ref<boolean>(false)\n\n    const { autofocusButton } = useAutofocusButton()\n\n    const isEmail = computed<boolean>(() => {\n      return props.identifierType === IdentifierType.email\n    })\n\n    const title = computed<string>(() => {\n      if (showFailure.value) {\n        return t('register-with-link', [isEmail.value ? t('email') : t('sms-text')])\n      }\n      return t('register-without-a-password')\n    })\n\n    return {\n      appId,\n      router,\n      onSuccess,\n      isEmail,\n      showFailure,\n      title,\n      Icons,\n      t,\n      autofocusButton,\n    }\n  },\n  data: () => {\n    return {\n      loading: false,\n      authResult: null as unknown as authResult,\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      passage: null as any,\n    }\n  },\n  created: function () {\n    this.passage = new Passage(this.appId)\n  },\n  methods: {\n    async signUpWebAuthn(identifier: string): Promise<void> {\n      this.loading = true\n      this.showFailure = false\n      this.authResult = { auth_token: '', redirect_url: '' }\n      try {\n        const res = await this.passage.register(identifier)\n        this.authResult = res\n\n        // Update state\n        this.loading = false\n\n        if (this.authResult.redirect_url) {\n          // alert(\"User with email: \" + this.email + \"--- NOT SIGNED UP\")\n          storeLastLogin(identifier)\n          this.onSuccess(this.authResult)\n        }\n      } catch (err) {\n        this.showFailure = true\n        this.loading = false\n      }\n    },\n    registerWithEmail() {\n      if (this.showFailure) {\n        this.router.push(MagicLinkRoute, {\n          identifier: this.identifier,\n          identifierType: this.identifierType,\n          userIsRegistering: false,\n        })\n      } else {\n        this.router.push(MagicLinkRoute, {\n          identifier: this.identifier,\n          identifierType: this.identifierType,\n          userIsRegistering: true,\n        })\n      }\n    },\n    changeEmail() {\n      localStorage.removeItem('email')\n      this.router.push(this.router.homeRoute, { register: true })\n    },\n    redirectNow() {\n      if (this.authResult.redirect_url) {\n        storeLastLogin(this.identifier)\n        this.onSuccess(this.authResult)\n      }\n    },\n    onButtonClick() {\n      this.signUpWebAuthn(this.identifier)\n    },\n  },\n})\n</script>\n","<template>\n  <register-device :identifier=\"identifier\" :identifierType=\"identifierType\" />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport RegisterDevice from '../components/RegisterDevice/RegisterDevice.vue'\nimport { IdentifierType } from '../components/ValidatedIdentifierForm/IntentifierTypes'\n\nexport default defineComponent({\n  name: 'RegisterDeviceView',\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  components: {\n    RegisterDevice,\n  },\n})\n</script>\n","<template>\n  <div class=\"auth-flex-container\">\n    <div class=\"title has-text-centered\">\n      {{ showFailure ? t('login-with-link', [isEmail ? t('email') : t('sms-text')]) : t('verify-your-identity') }}\n    </div>\n    <figure class=\"image has-text-centered\" style=\"margin: 5px auto\">\n      <inline-svg\n        v-if=\"showFailure && isEmail\"\n        :src=\"Icons.loginWithEmail\"\n        alt=\"Biometrics scan failed\"\n        style=\"margin: 5px\"\n      />\n      <inline-svg\n        v-else-if=\"showFailure && !isEmail\"\n        :src=\"Icons.loginWithText\"\n        alt=\"Biometrics scan failed\"\n        style=\"margin: 5px\"\n      />\n      <platform-icon v-else />\n    </figure>\n    <div class=\"content wrap-text has-text-centered\" style=\"margin-bottom: 25px !important\" v-if=\"!showFailure\">\n      <div v-if=\"identifier\" style=\"margin-bottom: 5px\">\n        <strong>{{ identifier }}</strong>\n      </div>\n      <div>{{ t('log-into-your-account') }}</div>\n    </div>\n\n    <div class=\"content wrap-text has-text-centered\" style=\"margin-bottom: 5px !important\" v-else-if=\"showFailure\">\n      <div v-if=\"identifier\" style=\"margin-bottom: 5px\">\n        <strong>{{ identifier }}</strong>\n      </div>\n      <div data-test=\"failure-message\">\n        <p>{{ isEmail ? t('login-with-link-error-message-email') : t('login-with-link-error-message-phone') }}</p>\n      </div>\n    </div>\n\n    <div class=\"flex-row flex-center\" v-if=\"showFailure\">\n      <button\n        @click.prevent=\"loginWithEmail\"\n        type=\"button\"\n        part=\"button\"\n        class=\"button is-primary small\"\n        :disabled=\"loading\"\n        style=\"margin-right: 5px\"\n        data-test=\"login-with-email-button\"\n        ref=\"autofocusButton\"\n      >\n        {{ t('send-email-or-text-link', [isEmail ? t('email') : t('sms-text')]) }}\n      </button>\n      <button\n        @click.prevent=\"signInWebAuthn\"\n        type=\"button\"\n        part=\"button\"\n        class=\"button is-secondary small\"\n        :disabled=\"loading\"\n        style=\"margin-left: 5px\"\n      >\n        {{ t('try-again') }}\n      </button>\n    </div>\n\n    <div class=\"content has-text-centered\" style=\"margin-top: 20px !important\" v-if=\"showFailure\">\n      <div class=\"link\">\n        <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n          t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n        }}</a>\n      </div>\n    </div>\n\n    <div class=\"spacer\" v-if=\"!showFailure\"></div>\n\n    <div class=\"flex-row flex-wrap flex-between\" v-if=\"!showFailure\">\n      <div class=\"link\">\n        <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n          t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n        }}</a>\n      </div>\n      <div class=\"link\">\n        <a @click.prevent=\"loginWithEmail\" role=\"button\" data-test=\"register-email-button\">{{\n          t('login-with-link', [isEmail ? t('email') : t('sms-text')])\n        }}</a>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent } from 'vue'\nimport { Passage, authResult, PassageError, PassageErrorCode } from '@passageidentity/passage-js'\nimport { useAppId } from '@/composables/useAppId'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport { MagicLinkRoute } from '@/PassageAuth/router/routes'\nimport { useCallbacks } from '@/composables/useCallbacks'\nimport { IdentifierType } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport PlatformIcon from '@/components/PlatformIcon/PlatformIcon.vue'\nimport { storeLastLogin } from '@/utils/lastLogin'\nimport { useLocale } from '@/composables/useLocale'\nimport { useAutofocusButton } from '@/composables/useAutofocusButton'\n\nexport default defineComponent({\n  name: 'WebauthnSignIn',\n  components: {\n    InlineSvg,\n    PlatformIcon,\n  },\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  setup(props) {\n    const { t } = useLocale()\n    const { appId } = useAppId()\n    const { router } = useRouter()\n    const isEmail = computed<boolean>(() => {\n      return props.identifierType === IdentifierType.email\n    })\n\n    const { autofocusButton } = useAutofocusButton()\n\n    return {\n      appId,\n      router,\n      isEmail,\n      Icons,\n      t,\n      autofocusButton,\n    }\n  },\n  data: () => {\n    return {\n      showFailure: false,\n      loading: false,\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      passage: null as any,\n      authResult: null as unknown as authResult,\n    }\n  },\n  created: function () {\n    this.passage = new Passage(this.appId)\n  },\n  mounted() {\n    this.signInWebAuthn()\n  },\n  methods: {\n    async signInWebAuthn() {\n      this.authResult = { auth_token: '', redirect_url: '' }\n      this.showFailure = false\n\n      if (!this.identifier) {\n        return\n      }\n\n      this.loading = true\n\n      try {\n        const res = await this.passage.login(this.identifier)\n        this.authResult = res\n        if (this.authResult.redirect_url) {\n          storeLastLogin(this.identifier)\n          useCallbacks().onSuccess.value(this.authResult)\n        }\n        this.loading = false\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      } catch (err: any) {\n        const error = err as PassageError\n        this.showFailure = true\n        this.loading = false\n        if (error.statusCode === PassageErrorCode.PSGParsePublicKeyForLoginFailed) {\n          // TODO: handle this\n          this.showFailure = true\n        } else {\n          this.router.push(MagicLinkRoute, { identifier: this.identifier, identifierType: this.identifierType })\n        }\n      }\n    },\n    loginWithEmail() {\n      this.router.push(MagicLinkRoute, { identifier: this.identifier, identifierType: this.identifierType })\n    },\n    changeEmail() {\n      localStorage.removeItem('email')\n      this.router.push(this.router.homeRoute)\n    },\n  },\n})\n</script>\n","<template>\n  <div class=\"view-webauthn-sign-in\">\n    <webauthn-sign-in :identifier=\"identifier\" :identifierType=\"identifierType\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport WebauthnSignIn from '../components/WebauthnSignIn/WebauthnSignIn.vue'\nimport { IdentifierType } from '../components/ValidatedIdentifierForm/IntentifierTypes'\n\nexport default defineComponent({\n  name: 'WebauthnSignInView',\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  components: {\n    WebauthnSignIn,\n  },\n})\n</script>\n","<template>\n  <component :is=\"currentComponent\" v-bind=\"currentProps\"><slot></slot></component>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, computed } from 'vue'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport ActivateMagicLinkView from '../../views/ActivateMagicLinkView.vue'\nimport AuthView from '../../views/AuthView.vue'\nimport LoginView from '../../views/LoginView.vue'\nimport RegisterView from '../../views/RegisterView.vue'\nimport MagicLinkView from '../../views/MagicLinkView.vue'\nimport RegisterDeviceView from '../../views/RegisterDeviceView.vue'\nimport WebauthnSignInView from '../../views/WebauthnSignInView.vue'\n\nexport default defineComponent({\n  name: 'RouterView',\n  components: {\n    ActivateMagicLinkView,\n    AuthView,\n    LoginView,\n    RegisterView,\n    MagicLinkView,\n    RegisterDeviceView,\n    WebauthnSignInView,\n  },\n  setup() {\n    const { currentRoute } = useRouter()\n    const currentComponent = computed<string>(() => currentRoute.value.component)\n    const currentProps = computed(() => {\n      const props = currentRoute.value.props\n      if (props === undefined) {\n        return {}\n      }\n      return props\n    })\n\n    return {\n      currentComponent,\n      currentProps,\n    }\n  },\n})\n</script>\n"],"names":["OnEventType","authResult","_sfc_main","PlatformIcon","_hoisted_2","_hoisted_4","_hoisted_8","_openBlock","_createElementBlock","_Fragment","_createElementVNode","_normalizeClass","_hoisted_1","_createBlock","_hoisted_5","_toDisplayString","_hoisted_6","_hoisted_7","_withModifiers","_hoisted_11","_hoisted_12","MagicLinkActionEnum","Passage","PassageErrorCode","_hoisted_3","_withDirectives","_createCommentVNode","_hoisted_9","_hoisted_10","_hoisted_13","_hoisted_15","_hoisted_16","_hoisted_18","_normalizeStyle","_createVNode","router","IdentifierType","IdentifierMode","WebAuthnType","PassageUserStatus","_createTextVNode","_vModelText","_renderSlot","Identifier","PassageError","_withCtx","TooltipPosition","computed","MagicLink","onSuccess","_hoisted_14","_hoisted_17","AuthView","LoginView","RegisterView","currentRoute","_resolveDynamicComponent","_normalizeProps","_guardReactiveProps"],"mappings":"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"}