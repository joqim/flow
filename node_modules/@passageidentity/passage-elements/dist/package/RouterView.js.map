{"version":3,"file":"RouterView.js","sources":["../../src/composables/useCallbacks.ts","../../src/PassageAuth/router/routes.ts","../../src/PassageAuth/composables/useRouter.ts","../../src/PassageAuth/router/router.ts","../../src/composables/useAutofocusButton.ts","../../src/PassageAuth/components/ActivateMagicLink/components/AddDevice.vue","../../src/PassageAuth/components/ActivateMagicLink/composables/useWebauthnUtils.ts","../../src/utils/userGestureRequired.ts","../../src/PassageAuth/components/ActivateMagicLink/composables/useMagicLinkUtils.ts","../../src/utils/lastLogin.ts","../../src/PassageAuth/components/ActivateMagicLink/composables/useMagicLinkActivation.ts","../../src/PassageAuth/components/ActivateMagicLink/ActivateMagicLink.vue","../../src/PassageAuth/components/ActivateMagicLink/composables/useUIState.ts","../../src/PassageAuth/views/ActivateMagicLinkView.vue","../../src/PassageAuth/composables/useMagicLink.ts","../../src/PassageAuth/components/ValidatedIdentifierForm/IntentifierTypes.ts","../../src/PassageAuth/components/ValidatedIdentifierForm/ValidatedIdentifierForm.vue","../../src/PassageAuth/components/Login/Login.vue","../../src/PassageAuth/components/Register/Register.vue","../../src/services/EphemeralAppService.ts","../../src/PassageAuth/components/EphemeralAppInfo/EphemeralAppInfo.vue","../../src/ui-components/Tooltip.vue","../../src/PassageAuth/components/HelpFooter/HelpFooter.vue","../../src/PassageAuth/views/AuthView.vue","../../src/PassageAuth/views/LoginView.vue","../../src/PassageAuth/views/RegisterView.vue","../../src/ui-components/Spinner.vue","../../src/PassageAuth/components/MagicLink/MagicLink.vue","../../src/PassageAuth/views/MagicLinkView.vue","../../src/PassageAuth/components/RegisterDevice/RegisterDevice.vue","../../src/PassageAuth/views/RegisterDeviceView.vue","../../src/PassageAuth/components/WebauthnSignIn/WebauthnSignIn.vue","../../src/PassageAuth/views/WebauthnSignInView.vue","../../src/PassageAuth/views/RouterView/RouterView.vue"],"sourcesContent":["import { ref, readonly, Ref } from 'vue'\nimport { authResult } from '@passageidentity/passage-js'\n\ninterface IUseCallbacks {\n  beforeAuth: Ref<BeforeAuthCallback>\n  onSuccess: Ref<OnSuccessCallback>\n  onEvent: Ref<OnEventCallback>\n  setBeforeAuth: (newBeforeAuth?: BeforeAuthCallback) => void\n  setOnSuccess: (newOnSuccess?: OnSuccessCallback) => void\n  setOnEvent: (newOnEvent?: OnEventCallback) => void\n}\n\nexport enum OnEventType {\n  onLoaded = 'onLoaded',\n  onRegisterDevice = 'onRegisterDevice',\n  onVerifyIdentity = 'onVerifyIdentity',\n  onMagicLinkLogin = 'onMagicLinkLogin',\n  onMagicLinkRegister = 'onMagicLinkRegister',\n  onMagicLinkActivated = 'onMagicLinkActivated',\n  onMagicLinkActivateSuccess = 'onMagicLinkActivateSuccess',\n}\n\nexport type BeforeAuthCallback = (identifier: string) => boolean\n\nexport type OnSuccessCallback = (authResult: authResult) => void\n\nexport type OnEventCallback = (type: OnEventType, data?: unknown) => void\n\nconst defaultBeforeAuth = () => {\n  return true\n}\n\nconst defaultOnSuccess = (authResult: authResult) => {\n  window.location.href = authResult.redirect_url\n}\n\nconst defaultOnEvent = () => {\n  return\n}\n\nconst beforeAuth = ref<BeforeAuthCallback>(defaultBeforeAuth)\n\nconst onSuccess = ref<OnSuccessCallback>(defaultOnSuccess)\n\nconst onEvent = ref<OnEventCallback>(defaultOnEvent)\n\nfunction setBeforeAuth(newBeforeAuth?: BeforeAuthCallback) {\n  if (newBeforeAuth === undefined) {\n    beforeAuth.value = defaultBeforeAuth\n    return\n  }\n  beforeAuth.value = newBeforeAuth\n}\n\nfunction setOnSuccess(newOnSuccess?: OnSuccessCallback) {\n  if (newOnSuccess === undefined) {\n    onSuccess.value = defaultOnSuccess\n    return\n  }\n  onSuccess.value = newOnSuccess\n}\n\nfunction setOnEvent(newOnEvent?: OnEventCallback) {\n  if (newOnEvent === undefined) {\n    onEvent.value = defaultOnEvent\n    return\n  }\n  onEvent.value = newOnEvent\n}\n\nexport function useCallbacks(): IUseCallbacks {\n  return {\n    beforeAuth: readonly(beforeAuth),\n    onSuccess: readonly(onSuccess),\n    onEvent: readonly(onEvent),\n    setBeforeAuth,\n    setOnSuccess,\n    setOnEvent,\n  }\n}\n","import { IdentifierType } from '@/PassageAuth/components/ValidatedIdentifierForm/IntentifierTypes'\n\nexport interface IRoute<T> {\n  component: string\n  props?: T\n}\n\nexport interface IHomeRouteProps {\n  register?: boolean\n}\nexport const AuthRoute: IRoute<IHomeRouteProps> = {\n  component: 'auth-view',\n}\nexport const LoginRoute: IRoute<IHomeRouteProps> = {\n  component: 'login-view',\n}\nexport const RegisterRoute: IRoute<IHomeRouteProps> = {\n  component: 'register-view',\n}\n\nexport interface IRegisterDeviceRouteProps {\n  identifier: string\n  identifierType: IdentifierType\n}\nexport const RegisterDeviceRoute: IRoute<IRegisterDeviceRouteProps> = {\n  component: 'register-device-view',\n}\n\nexport interface IMagicLinkRouteProps {\n  identifier: string\n  identifierType: IdentifierType\n  setupNewDevice?: boolean\n  userIsRegistering?: boolean\n  identifierVerifying?: boolean\n}\nexport const MagicLinkRoute: IRoute<IMagicLinkRouteProps> = {\n  component: 'magic-link-view',\n}\n\nexport interface IWebauthnSignInRouteProps {\n  identifier: string\n  identifierType: IdentifierType\n}\nexport const WebauthnSignInRoute: IRoute<IWebauthnSignInRouteProps> = {\n  component: 'webauthn-sign-in-view',\n}\n\nexport interface IActivateMagicLinkRouteProps {\n  magicLink: string\n}\nexport const ActivateMagicLinkRoute: IRoute<IActivateMagicLinkRouteProps> = {\n  component: 'activate-magic-link-view',\n}\n\nexport type RouteProps =\n  | IHomeRouteProps\n  | IRegisterDeviceRouteProps\n  | IMagicLinkRouteProps\n  | IWebauthnSignInRouteProps\n  | IActivateMagicLinkRouteProps\n","import { reactive, computed } from 'vue'\nimport { Router } from '../router/router'\nimport { IRoute, RouteProps } from '../router/routes'\n\nconst router = reactive<Router>(new Router())\nconst currentRoute = computed<IRoute<RouteProps>>(() => router.currentRoute)\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function useRouter() {\n  return {\n    router,\n    currentRoute,\n  }\n}\n","import { IRoute, IHomeRouteProps, AuthRoute, RouteProps } from './routes'\n\nexport class Router {\n  private _history: IRoute<RouteProps>[] = []\n  private _homeRoute: IRoute<IHomeRouteProps> = AuthRoute\n\n  constructor() {\n    this._history.push(this._homeRoute)\n  }\n\n  get homeRoute(): IRoute<IHomeRouteProps> {\n    return this._homeRoute\n  }\n\n  set homeRoute(homeRoute: IRoute<IHomeRouteProps>) {\n    this._homeRoute = homeRoute\n    this._history[0] = homeRoute\n  }\n\n  get currentRoute(): IRoute<RouteProps> {\n    return this._history[this._history.length - 1]\n  }\n\n  push<T>(route: IRoute<T>, props?: T): void {\n    /* eslint-disable-next-line @typescript-eslint/ban-ts-comment */\n    // @ts-ignore\n    this._history.push({ ...route, props })\n  }\n\n  resetRouter(): void {\n    this._history = []\n    this._homeRoute = AuthRoute\n    this._history.push(this._homeRoute)\n  }\n}\n","import { Ref, ref, watch } from 'vue'\n\ninterface IAutoFocusButton {\n  autofocusButton: Ref<HTMLElement | undefined>\n}\n\nexport function useAutofocusButton(): IAutoFocusButton {\n  const autofocusButton = ref<HTMLElement>()\n\n  function autofocus() {\n    if (autofocusButton.value === undefined) {\n      return\n    }\n    autofocusButton.value.focus()\n  }\n\n  watch(autofocusButton, () => {\n    autofocus()\n  })\n\n  return {\n    autofocusButton,\n  }\n}\n","<template>\n  <div class=\"title has-text-centered\" :class=\"[showFailure ? 'secondary-title' : 'main-title']\">\n    {{ title }}\n  </div>\n\n  <figure class=\"image has-text-centered\">\n    <inline-svg v-if=\"showFailure\" :src=\"Icons.fingerprintFailed\" alt=\"Device failure\" />\n    <platform-icon v-else />\n  </figure>\n\n  <div class=\"content has-text-centered\" data-test=\"activate-magic-link-message\">\n    <div v-if=\"showFailure\">{{ t('failed-to-add-this-device') }}</div>\n    <div v-else>\n      <div style=\"margin-bottom: 10px\">\n        <strong>{{ t('save-device') }}</strong>\n      </div>\n      <div style=\"margin-bottom: 10px\">\n        {{ t('trust-device') }}\n      </div>\n      <div style=\"margin-bottom: 10px\">\n        {{ t('does-not-give-app-personal-info') }}\n      </div>\n    </div>\n  </div>\n\n  <!-- On Safari, we may need text here so the user knows they need to click because of their browser -->\n  <!-- If this is true, show the button -->\n  <div class=\"flex-row flex-center\" style=\"padding: 20px 0px\">\n    <button\n      @click.prevent=\"onButtonClick\"\n      type=\"button\"\n      class=\"button is-primary\"\n      part=\"button\"\n      :class=\"{ 'is-loading': addPending }\"\n      :disabled=\"addPending\"\n      data-test=\"save-device-button\"\n      ref=\"autofocusButton\"\n    >\n      <span v-if=\"showFailure\">{{ t('try-again') }}</span>\n      <span v-else>{{ t('continue') }}</span>\n    </button>\n  </div>\n\n  <div class=\"link has-text-centered\" v-if=\"!showSuccess\">\n    <div>\n      <a @click.prevent=\"onSkipButtonClick\" role=\"button\" data-test=\"add-device-skip\">{{ t('skip') }}</a>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed } from 'vue'\nimport { authResult, PassageDevice } from '@passageidentity/passage-js'\nimport type { PropType } from 'vue'\nimport { useCallbacks } from '@/composables/useCallbacks'\nimport useAddDevice from '../../../../composables/useAddDevice'\nimport { useAppId } from '@/composables/useAppId'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport PlatformIcon from '@/components/PlatformIcon/PlatformIcon.vue'\nimport { useLocale } from '@/composables/useLocale'\nimport { useAutofocusButton } from '@/composables/useAutofocusButton'\n\nexport default defineComponent({\n  name: 'AddDevice',\n  components: {\n    InlineSvg,\n    PlatformIcon,\n  },\n  props: {\n    authResult: {\n      type: Object as PropType<authResult>,\n      required: false,\n    },\n  },\n  setup(props) {\n    const { t } = useLocale()\n    const { appId } = useAppId()\n    const showFailure = ref<boolean>(false)\n    const showSuccess = ref<boolean>(false)\n    const newDevice = ref<PassageDevice>()\n    const { addDevice, addPending, errorMessage } = useAddDevice(appId.value)\n    const { autofocusButton } = useAutofocusButton()\n\n    const title = computed<string>(() => {\n      if (showFailure.value) {\n        return t('something-went-wrong')\n      } else {\n        return t('success')\n      }\n    })\n\n    async function onButtonClick() {\n      newDevice.value = await addDevice()\n      if (newDevice.value?.id) {\n        showSuccess.value = true\n        showFailure.value = false\n        if (props.authResult?.redirect_url) {\n          useCallbacks().onSuccess.value(props.authResult)\n        }\n      } else {\n        showFailure.value = true\n        showSuccess.value = false\n      }\n    }\n\n    const onSkipButtonClick = () => {\n      if (props.authResult?.redirect_url) {\n        useCallbacks().onSuccess.value(props.authResult)\n      }\n    }\n    return {\n      showSuccess,\n      showFailure,\n      title,\n      addPending,\n      errorMessage,\n      newDevice,\n      onButtonClick,\n      onSkipButtonClick,\n      Icons,\n      t,\n      autofocusButton,\n    }\n  },\n})\n</script>\n","import { Ref, ref } from 'vue'\nimport { Passage } from '@passageidentity/passage-js'\nimport { checkUserGestureRequired } from '@/utils/userGestureRequired'\n\nexport interface IUseWebauthnUtils {\n  deviceRecognized: Ref<boolean>\n  webauthnAllowed: Ref<boolean>\n  userGestureRequired: boolean\n  verifyWebAuthnAllowed: () => Promise<boolean>\n  isDeviceRecognized: (magicLink: string) => boolean\n  checkWebauthnAndDeviceRecognized: (magicLink: string) => Promise<void>\n}\n\nexport default function useWebauthnUtils(passage: Passage): IUseWebauthnUtils {\n  const deviceRecognized = ref<boolean>(false)\n  const webauthnAllowed = ref<boolean>(false)\n\n  const userGestureRequired = checkUserGestureRequired()\n\n  const verifyWebAuthnAllowed = async () => {\n    const appInfo = await passage.appInfo()\n    if (passage.checkWebauthnConfig(appInfo)) {\n      webauthnAllowed.value = await passage.isWebauthnSupported(false)\n    } else {\n      webauthnAllowed.value = false\n    }\n    return webauthnAllowed.value\n  }\n\n  const isDeviceRecognized = (magicLink: string): boolean => {\n    const userID = magicLink.split('.')[2]\n    deviceRecognized.value = webauthnAllowed.value && passage.credIDExists(userID) ? true : false\n    return deviceRecognized.value\n  }\n\n  const checkWebauthnAndDeviceRecognized = async (magicLink: string): Promise<void> => {\n    await verifyWebAuthnAllowed()\n    isDeviceRecognized(magicLink)\n  }\n\n  return {\n    deviceRecognized,\n    webauthnAllowed,\n    userGestureRequired,\n    checkWebauthnAndDeviceRecognized,\n    verifyWebAuthnAllowed,\n    isDeviceRecognized,\n  }\n}\n","export function checkUserGestureRequired(): boolean {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return typeof (window as any).webkitConvertPointFromNodeToPage === 'function'\n}\n","import { Ref, ref } from 'vue'\n\nexport enum MagicLinkActionEnum {\n  LOGIN = 'psg_magic_link',\n  VERIFY = 'psg_verify_link',\n}\n\nexport interface IUseMagicLinkUtils {\n  magicLinkAction: Ref<MagicLinkActionEnum | undefined>\n  invalidMagicLink: Ref<boolean>\n  isMagicLinkValid: () => boolean\n}\n\nexport type IUseMagicLinkUtilsComposable = (magicLink: string) => IUseMagicLinkUtils\n\nexport const useMagicLinkUtils: IUseMagicLinkUtilsComposable = (magicLink) => {\n  const magicLinkAction = ref<MagicLinkActionEnum>()\n  const invalidMagicLink = ref<boolean>(false)\n\n  const isMagicLinkValid = () => {\n    const searchParams = new URLSearchParams(window.location.href.split('?')[1])\n    if (searchParams.has(MagicLinkActionEnum.LOGIN)) {\n      magicLinkAction.value = MagicLinkActionEnum.LOGIN\n    } else if (searchParams.has(MagicLinkActionEnum.VERIFY)) {\n      magicLinkAction.value = MagicLinkActionEnum.VERIFY\n    }\n    if (!magicLinkAction.value || !magicLink) {\n      invalidMagicLink.value = true\n    }\n    return !invalidMagicLink.value\n  }\n\n  return {\n    magicLinkAction,\n    invalidMagicLink,\n    isMagicLinkValid,\n  }\n}\n\nexport default useMagicLinkUtils\n","import { useAppId } from '@/composables/useAppId'\nimport { Passage, PassageUserInfo } from '@passageidentity/passage-js'\n\nconst storageKey = 'psg_last_login'\n\nexport function getLastLogin(): string | null {\n  return localStorage.getItem(storageKey)\n}\n\nexport async function storeLastLogin(identiferOrUserInfo?: string | PassageUserInfo): Promise<void> {\n  if (identiferOrUserInfo && typeof identiferOrUserInfo === 'string') {\n    localStorage.setItem(storageKey, identiferOrUserInfo)\n    return\n  }\n  let currentInfo = identiferOrUserInfo as PassageUserInfo | undefined\n  if (identiferOrUserInfo === undefined) {\n    const { appId } = useAppId()\n    const passage = new Passage(appId.value)\n    currentInfo = await passage.getCurrentUser().userInfo()\n  }\n  if (currentInfo === undefined) {\n    return\n  }\n  localStorage.setItem(storageKey, currentInfo.email ? currentInfo.email : currentInfo.phone)\n}\n","import { IUseUIState } from './useUIState'\nimport { IUseMagicLinkUtils } from './useMagicLinkUtils'\nimport { IUseWebauthnUtils } from './useWebauthnUtils'\nimport { Passage, authResult, PassageError, PassageErrorCode } from '@passageidentity/passage-js'\nimport { ref, Ref } from 'vue'\nimport { useCallbacks } from '@/composables/useCallbacks'\nimport { storeLastLogin } from '@/utils/lastLogin'\n\ninterface IUseMagicLinkActivationReturn {\n  authResult: Ref<authResult>\n  onBeforeActivate: () => void\n  onActivateError: () => void\n  onActivateErrorInvalidMagicLink: () => void\n  onActivateSuccess: (props: { addDevice: boolean; result: authResult }) => Promise<void>\n  activateWithBiometrics: () => Promise<void>\n  activateWithoutBiometrics: () => Promise<void>\n}\n\ninterface IUseMagicLinkActivationProps {\n  uiState: IUseUIState\n  magicLinkUtils: IUseMagicLinkUtils\n  passage: Passage\n  magicLink: string\n  webauthnUtils: IUseWebauthnUtils\n}\ntype IUseMagicLinkActivation = (props: IUseMagicLinkActivationProps) => IUseMagicLinkActivationReturn\n\nconst useMagicLinkActivation: IUseMagicLinkActivation = ({\n  magicLink,\n  uiState,\n  magicLinkUtils,\n  passage,\n  webauthnUtils,\n}) => {\n  const authResult = ref<authResult>(null as unknown as authResult)\n\n  const onBeforeActivate = () => {\n    uiState.uiLoading({ addDevice: false })\n    authResult.value = { auth_token: '', redirect_url: '' }\n  }\n\n  const onActivateError = () => {\n    uiState.uiError()\n  }\n\n  const onActivateErrorInvalidMagicLink = () => {\n    magicLinkUtils.invalidMagicLink.value = true\n    uiState.uiError()\n  }\n\n  const onActivateSuccess = async ({ addDevice = false, result }: { addDevice: boolean; result: authResult }) => {\n    authResult.value = result\n    const userInfo = await passage.getCurrentUser().userInfo()\n    storeLastLogin(userInfo)\n    uiState.uiSuccess({ addDevice: addDevice })\n\n    await new Promise((resolve) => {\n      setTimeout(resolve, 1000)\n    })\n\n    if (authResult.value.redirect_url && !uiState.showAddDevice.value) {\n      useCallbacks().onSuccess.value(authResult.value)\n    }\n  }\n\n  const activateWithoutBiometrics = async () => {\n    onBeforeActivate()\n    try {\n      const result = await passage.magicLinkActivate(magicLink)\n      onActivateSuccess({ addDevice: webauthnUtils.webauthnAllowed.value, result })\n      //eslint-disable-next-line  @typescript-eslint/no-explicit-any\n    } catch (err: any) {\n      if (err.statusCode === PassageErrorCode.NotFound) {\n        onActivateErrorInvalidMagicLink()\n      } else {\n        onActivateError()\n      }\n    }\n  }\n  const activateWithBiometrics = async () => {\n    onBeforeActivate()\n    try {\n      const result = await passage.magicLinkActivateWebAuthnLogin(magicLink)\n      onActivateSuccess({ addDevice: false, result })\n      //eslint-disable-next-line  @typescript-eslint/no-explicit-any\n    } catch (err: any) {\n      const error = err as PassageError\n      if (error.statusCode === PassageErrorCode.NotFound) {\n        onActivateErrorInvalidMagicLink()\n      } else if (\n        error.statusCode === PassageErrorCode.PSGCredObjectDoesNotExist ||\n        error.statusCode === PassageErrorCode.Unauthorized\n      ) {\n        activateWithoutBiometrics()\n      } else {\n        onActivateError()\n      }\n    }\n  }\n\n  return {\n    authResult,\n    onBeforeActivate,\n    onActivateError,\n    onActivateErrorInvalidMagicLink,\n    onActivateSuccess,\n    activateWithoutBiometrics,\n    activateWithBiometrics,\n  }\n}\n\nexport default useMagicLinkActivation\n","<template>\n  <div class=\"auth-flex-container\" v-show=\"!pageLoading && !showAddDevice\">\n    <div class=\"title has-text-centered\" :class=\"[showSuccess ? 'main-title' : 'secondary-title']\">\n      {{ showFailure ? (invalidMagicLink ? t('invalid-link') : t('device-login-failed-title')) : title }}\n    </div>\n\n    <figure class=\"image has-text-centered\">\n      <inline-svg v-if=\"showSuccess && webauthnAllowed\" :src=\"Icons.fingerprintSuccess\" alt=\"Device success\" />\n      <inline-svg v-else-if=\"showSuccess && !webauthnAllowed\" :src=\"Icons.emailSuccess\" alt=\"Magic link success\" />\n      <inline-svg\n        v-else-if=\"showFailure && magicLinkAction === MagicLinkActionEnum.VERIFY\"\n        :src=\"Icons.emailFailed\"\n        alt=\"Magic link failure\"\n      />\n      <inline-svg v-else-if=\"showFailure && invalidMagicLink\" :src=\"Icons.emailFailed\" alt=\"Magic link failure\" />\n      <inline-svg v-else-if=\"showFailure && webauthnAllowed\" :src=\"Icons.fingerprintFailed\" alt=\"Device failure\" />\n      <platform-icon v-else-if=\"webauthnAllowed\" />\n    </figure>\n\n    <div class=\"content has-text-centered\" data-test=\"activate-magic-link-message\">\n      <!-- Successful Magic Link Activation or Verification -->\n      <div v-if=\"showSuccess && magicLinkAction === MagicLinkActionEnum.LOGIN\">\n        {{ t('successfully-logged-in-redirect') }}\n      </div>\n\n      <div v-else-if=\"showSuccess && magicLinkAction === MagicLinkActionEnum.VERIFY\">\n        {{ t('successfully-changed-email') }}\n      </div>\n\n      <!-- Magic Link Login or Magic Link Verify link is invalid -->\n      <div v-else-if=\"showFailure && invalidMagicLink && magicLinkAction === MagicLinkActionEnum.VERIFY\">\n        {{ t('link-invalid') }}\n      </div>\n      <div v-else-if=\"showFailure && invalidMagicLink\">{{ t('login-link-invalid') }}</div>\n\n      <!-- Magic Link Activation Failed -->\n      <div v-else-if=\"showFailure && magicLinkAction === MagicLinkActionEnum.VERIFY\">\n        {{ t('verification-failed-please-try-again') }}\n      </div>\n      <div v-else-if=\"showFailure\">{{ t('device-login-failed') }}</div>\n\n      <!-- Prompt User To Login Or Verify Via Webauthn -->\n      <div v-else-if=\"webauthnAllowed && magicLinkAction === MagicLinkActionEnum.LOGIN\">\n        {{ t('log-in-to-proceed') }}\n      </div>\n      <div v-else-if=\"webauthnAllowed && magicLinkAction === MagicLinkActionEnum.VERIFY\">\n        {{ t('verify-your-identity-with-device') }}\n      </div>\n\n      <div v-else-if=\"webauthnAllowed\">\n        {{ t('log-into-your-account-extended') }}\n      </div>\n    </div>\n\n    <!-- On Safari, we may need text here so the user knows they need to click because of their browser -->\n    <!-- If this is true, show the button -->\n    <div\n      class=\"flex-row flex-center\"\n      v-if=\"userGestureRequired || showFailure || showSuccess\"\n      style=\"padding: 20px 0px\"\n    >\n      <button\n        @click.prevent=\"onButtonClick\"\n        type=\"button\"\n        class=\"button is-primary\"\n        part=\"button\"\n        :class=\"{ 'is-loading': loading, 'small': showFailure && invalidMagicLink }\"\n        :disabled=\"loading\"\n        data-test=\"activate-magic-link-button\"\n      >\n        <span v-if=\"showFailure && invalidMagicLink\">{{ t('request-new-link') }}</span>\n        <span v-else-if=\"showFailure\">{{ t('try-again') }}</span>\n        <span v-else-if=\"showSuccess\">{{ t('redirect-now') }}</span>\n        <span v-else>{{ t('login-with-device') }}</span>\n      </button>\n    </div>\n  </div>\n  <div\n    class=\"auth-flex-container\"\n    v-if=\"!pageLoading && showAddDevice\"\n    :style=\"showFailure ? 'justify-content: space-between' : ''\"\n  >\n    <AddDevice :auth-result=\"activation.authResult.value\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, onMounted } from 'vue'\nimport { Passage } from '@passageidentity/passage-js'\nimport { useAppId } from '@/composables/useAppId'\nimport { useCallbacks, OnEventType } from '@/composables/useCallbacks'\nimport AddDevice from './components/AddDevice.vue'\nimport useUIState from './composables/useUIState'\nimport useWebauthnUtils from './composables/useWebauthnUtils'\nimport useMagicLinkUtils, { MagicLinkActionEnum } from './composables/useMagicLinkUtils'\nimport useMagicLinkActivation from './composables/useMagicLinkActivation'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport PlatformIcon from '@/components/PlatformIcon/PlatformIcon.vue'\nimport { useLocale } from '@/composables/useLocale'\n\nexport default defineComponent({\n  name: 'ActivateMagicLink',\n  props: {\n    magicLink: {\n      type: String,\n      required: true,\n    },\n  },\n  components: {\n    AddDevice,\n    InlineSvg,\n    PlatformIcon,\n  },\n  setup(props) {\n    const { t } = useLocale()\n    const { appId } = useAppId()\n    const passage = new Passage(appId.value)\n    const uiState = useUIState()\n    const webauthnUtils = useWebauthnUtils(passage)\n    const magicLinkUtils = useMagicLinkUtils(props.magicLink)\n    const activation = useMagicLinkActivation({\n      uiState,\n      webauthnUtils,\n      magicLinkUtils,\n      passage,\n      magicLink: props.magicLink,\n    })\n\n    function onButtonClick() {\n      if (magicLinkUtils.invalidMagicLink.value) {\n        // need to eliminate the `psg_magic_link` url param before redirecting to EmailInputView\n        window.location.href = window.location.href.split('?')[0]\n      } else {\n        if (webauthnUtils.deviceRecognized.value) {\n          activation.activateWithBiometrics()\n        } else {\n          activation.activateWithoutBiometrics()\n        }\n      }\n    }\n\n    function redirectNow() {\n      if (activation.authResult.value?.redirect_url) {\n        useCallbacks().onSuccess.value(activation.authResult.value)\n      }\n    }\n\n    onMounted(async () => {\n      if (magicLinkUtils.isMagicLinkValid()) {\n        await webauthnUtils.checkWebauthnAndDeviceRecognized(props.magicLink)\n\n        const shouldAutoActivate =\n          !webauthnUtils.deviceRecognized.value ||\n          !webauthnUtils.webauthnAllowed.value ||\n          (!webauthnUtils.userGestureRequired && webauthnUtils.deviceRecognized.value)\n\n        const shouldAutoActivateWithBio = !webauthnUtils.userGestureRequired && webauthnUtils.deviceRecognized.value\n\n        if (shouldAutoActivate) {\n          shouldAutoActivateWithBio ? activation.activateWithBiometrics() : activation.activateWithoutBiometrics()\n        }\n\n        useCallbacks().onEvent.value(OnEventType.onMagicLinkActivateSuccess)\n      } else {\n        uiState.uiError()\n      }\n      uiState.pageLoading.value = false\n    })\n\n    return {\n      ...uiState,\n      ...webauthnUtils,\n      ...magicLinkUtils,\n      activation,\n      MagicLinkActionEnum,\n      onButtonClick,\n      redirectNow,\n      Icons,\n      t,\n    }\n  },\n})\n</script>\n","import { useLocale } from '@/composables/useLocale'\nimport { ref, Ref, computed, ComputedRef } from 'vue'\n\nexport interface IUseUIState {\n  showFailure: Ref<boolean>\n  showSuccess: Ref<boolean>\n  loading: Ref<boolean>\n  pageLoading: Ref<boolean>\n  showAddDevice: Ref<boolean>\n  title: ComputedRef<string>\n  uiSuccess: (props: { addDevice: boolean }) => void\n  uiLoading: (props: { addDevice: boolean }) => void\n  uiError: () => void\n}\n\nexport default function useUIState(): IUseUIState {\n  const showFailure = ref<boolean>(false)\n  const showSuccess = ref<boolean>(false)\n  const loading = ref<boolean>(false)\n  const pageLoading = ref<boolean>(true)\n  const showAddDevice = ref<boolean>(false)\n  const { t } = useLocale()\n\n  const title = computed<string>(() => {\n    if (showSuccess.value) {\n      return t('success')\n    }\n    if (showFailure.value) {\n      return t('something-went-wrong')\n    }\n    return t('verify-your-identity')\n  })\n\n  const uiSuccess = ({ addDevice = false }) => {\n    showSuccess.value = true\n    showFailure.value = false\n    showAddDevice.value = addDevice\n    loading.value = false\n  }\n\n  const uiError = () => {\n    showSuccess.value = false\n    showFailure.value = true\n    showAddDevice.value = false\n    loading.value = false\n  }\n\n  const uiLoading = ({ addDevice = false }) => {\n    showSuccess.value = false\n    showFailure.value = false\n    showAddDevice.value = addDevice\n    loading.value = true\n  }\n\n  return {\n    showFailure,\n    showSuccess,\n    loading,\n    pageLoading,\n    showAddDevice,\n    title,\n    uiSuccess,\n    uiError,\n    uiLoading,\n  }\n}\n","<template>\n  <div class=\"view-verify-token\">\n    <activate-magic-link :magicLink=\"magicLink\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport ActivateMagicLink from '../components/ActivateMagicLink/ActivateMagicLink.vue'\n\nexport default defineComponent({\n  name: 'ActivateMagicLinkView',\n  props: {\n    magicLink: {\n      type: String,\n      required: true,\n    },\n  },\n  components: {\n    ActivateMagicLink,\n  },\n})\n</script>\n","import { ActivateMagicLinkRoute } from '@/PassageAuth/router/routes'\nimport { onMounted } from 'vue'\nimport { useRouter } from './useRouter'\n\nexport function useMagicLink(): void {\n  const { router } = useRouter()\n  onMounted(() => {\n    const queryString = window.location.search\n    const urlParams = new URLSearchParams(queryString)\n\n    // check to see if URL is psg_magic_link or psg_verify_link\n    let magicLink = null\n    if (urlParams.has('psg_magic_link')) {\n      magicLink = urlParams.get('psg_magic_link')\n    } else if (urlParams.has('psg_verify_link')) {\n      magicLink = urlParams.get('psg_verify_link')\n    }\n\n    if (magicLink !== null) {\n      router.push(ActivateMagicLinkRoute, { magicLink: magicLink })\n    }\n  })\n}\n","import { PassageUserStatus } from '@passageidentity/passage-js'\nexport { Identifier as IdentifierMode } from '@passageidentity/passage-js'\nexport interface IValidatedEmailEvent {\n  identifier: string\n  identifierExists: boolean\n  identifierType: IdentifierType\n  userHasWebauthn: boolean\n  userStatus: PassageUserStatus\n  userID: string\n  emailVerified: boolean\n  phoneVerified: boolean\n  userHasPasskey: boolean\n}\n\nexport enum IdentifierType {\n  phone = 'PHONE',\n  email = 'EMAIL',\n}\n","<template>\n  <form @submit.prevent=\"checkIdentifier\">\n    <div class=\"has-text-centered\" v-show=\"showWelcomeBack\">\n      {{ t('welcome-back-sign-in-as') }}<br /><strong>{{ identifierText }}</strong>\n    </div>\n    <div v-show=\"!showWelcomeBack\">\n      <div class=\"label\" ref=\"labelRef\">{{ label }}</div>\n      <input\n        v-model=\"identifierText\"\n        type=\"text\"\n        class=\"input\"\n        part=\"input\"\n        :class=\"{ 'is-danger': error }\"\n        :autocomplete=\"inputMode\"\n        :inputmode=\"inputMode\"\n        id=\"identifier\"\n        :placeholder=\"placeholder\"\n        @input.prevent=\"clearErrors\"\n        ref=\"identifierInput\"\n        data-test=\"identifier-input\"\n      />\n    </div>\n    <div ref=\"controlContainer\" style=\"width: 100%\"></div>\n    <div\n      :style=\"`text-align: ${showWelcomeUI ? 'center' : 'left'};`\"\n      class=\"help is-danger error-message\"\n      data-test=\"validation-error\"\n    >\n      {{ error }}\n    </div>\n    <slot></slot>\n    <div class=\"flex-row flex-center\">\n      <button type=\"submit\" class=\"button is-primary\" part=\"button\" data-test=\"continue-button\" ref=\"autofocusButton\">\n        {{ t('continue') }}\n      </button>\n    </div>\n    <div v-if=\"showWelcomeUI\" style=\"margin-top: 30px\" class=\"link has-text-centered\">\n      <a @click.prevent=\"switchAccount\" role=\"button\" data-test=\"register-link\">{{ t('switch-account') }}</a>\n    </div>\n  </form>\n</template>\n\n<script lang=\"ts\">\nimport { Passage, PassageUserStatus, WebAuthnType } from '@passageidentity/passage-js'\nimport { computed, defineComponent, HTMLAttributes, onMounted, ref, watch } from 'vue'\nimport { isStringNullish } from '@/utils/stringUtils'\nimport { IdentifierMode, IdentifierType } from './IntentifierTypes'\nimport intlTelInput from 'intl-tel-input'\nimport { useLocale } from '@/composables/useLocale'\nimport { useAutofocusButton } from '@/composables/useAutofocusButton'\n\nexport default defineComponent({\n  name: 'ValidatedIdentiferForm',\n  emits: ['onSubmit', 'update:validationError', 'update:identifier', 'update:countryCode', 'update:showWelcomeBack'],\n  props: {\n    appId: {\n      type: String,\n      required: true,\n    },\n    validationError: {\n      type: String,\n      default: '',\n    },\n    identifier: {\n      type: String,\n      required: true,\n    },\n    countryCode: {\n      type: String,\n      required: true,\n    },\n    identifierMode: {\n      type: String as () => IdentifierMode,\n      required: true,\n    },\n    showWelcomeBack: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  setup(props, context) {\n    const { t } = useLocale()\n    const identifierParseError = ref<string>('')\n    const identifierInput = ref()\n    const controlContainer = ref()\n    const { autofocusButton } = useAutofocusButton()\n\n    const showWelcomeUI = computed<boolean>(() => {\n      return props.showWelcomeBack\n    })\n\n    const label = computed<string>(() => {\n      let identifierType\n      switch (props.identifierMode) {\n        case IdentifierMode.phone:\n          identifierType = t('phone-number')\n          break\n        case IdentifierMode.email:\n          identifierType = t('email-address')\n          break\n        case IdentifierMode.both:\n          identifierType = t('email-or-phone-number')\n          break\n      }\n      return identifierType.charAt(0).toUpperCase() + identifierType.slice(1)\n    })\n\n    const placeholder = computed<string>(() => {\n      return 'example@email.com'\n    })\n\n    const inputMode = computed<HTMLAttributes['inputmode']>(() => {\n      if (props.identifierMode === IdentifierMode.phone) {\n        return 'tel'\n      }\n      return 'email'\n    })\n\n    const identifierText = computed<string>({\n      get(): string {\n        return props.identifier\n      },\n      set(newIdentifier): void {\n        context.emit('update:identifier', newIdentifier)\n      },\n    })\n\n    function formattedIdentifier(): string {\n      if (!identifierText.value) {\n        return ''\n      }\n      // the null assertion is safe because isPhoneNumber already checks if phoneInput is undefined\n      let identifier = identifierText.value\n      // if the welcome UI is shown we just want the value of identifierText since intl-tel-input will be null\n      if (!showWelcomeUI.value) {\n        identifier = isPhoneNumber() ? phoneInput?.getNumber() ?? '' : identifierText.value\n      }\n      return identifier.trim().toLowerCase()\n    }\n\n    const error = computed<string>(() => {\n      if (!isStringNullish(props.validationError)) {\n        return props.validationError\n      }\n      if (!isStringNullish(identifierParseError.value)) {\n        return identifierParseError.value\n      }\n      return ''\n    })\n\n    function clearErrors() {\n      identifierParseError.value = ''\n      context.emit('update:validationError', '')\n    }\n\n    async function checkIdentifier() {\n      if (!validateInput()) {\n        return\n      }\n\n      const passage = new Passage(props.appId)\n      let identifierExists,\n        userHasWebauthn,\n        userHasPasskey,\n        emailVerified,\n        phoneVerified = false\n      let userStatus\n      let userID = ''\n      try {\n        const userInfo = await passage.identifierExists(formattedIdentifier())\n        if (userInfo !== null) {\n          identifierExists = true\n          userHasWebauthn = userInfo.webauthn\n          userStatus = userInfo.status\n          userID = userInfo.id\n          emailVerified = userInfo.email_verified\n          phoneVerified = userInfo.phone_verified\n          userHasPasskey = userInfo.webauthn_types.includes(WebAuthnType.Passkey)\n        } else {\n          identifierExists = false\n          userHasWebauthn = false\n          userStatus = PassageUserStatus.INACTIVE\n        }\n      } catch (e) {\n        let errorMessage\n        switch (props.identifierMode) {\n          case IdentifierMode.email:\n            errorMessage = t('enter-a-valid-email-address')\n            break\n          case IdentifierMode.phone:\n            errorMessage = t('enter-a-valid-phone-number')\n            break\n          case IdentifierMode.both:\n            errorMessage = t('enter-a-valid-email-or-phone-number')\n            break\n        }\n        identifierParseError.value = errorMessage\n        return\n      }\n      context.emit('onSubmit', {\n        identifier: formattedIdentifier(),\n        identifierExists: identifierExists,\n        identifierType: isPhoneNumber() ? IdentifierType.phone : IdentifierType.email,\n        userHasWebauthn: userHasWebauthn,\n        userStatus: userStatus,\n        userID: userID,\n        emailVerified: emailVerified,\n        phoneVerified: phoneVerified,\n        userHasPasskey,\n      })\n    }\n\n    function isEmail(): boolean {\n      // There are a ton of Regular expressions for email validation. I picked this one, but this should be thoroughly tested.\n      const emailRegEx =\n        /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\n      return emailRegEx.test(formattedIdentifier())\n    }\n\n    function isPhoneNumber(): boolean {\n      if (showWelcomeUI.value) {\n        return isPhoneNumberRegex()\n      }\n      if (phoneInput === undefined) {\n        return false\n      }\n      return phoneInput.isValidNumber()\n    }\n\n    function validateInput(): boolean {\n      if (formattedIdentifier() === '') {\n        let message = ''\n        switch (props.identifierMode) {\n          case IdentifierMode.phone:\n            message = t('enter-a-phone-number')\n            break\n          case IdentifierMode.email:\n            message = t('enter-an-email-address')\n            break\n          case IdentifierMode.both:\n            message = t('enter-an-email-or-phone-number')\n            break\n        }\n        identifierParseError.value = message\n        return false\n      } else if (props.identifierMode === IdentifierMode.email && !isEmail()) {\n        identifierParseError.value = t('enter-a-valid-email-address')\n        return false\n      } else if (props.identifierMode === IdentifierMode.phone && !isPhoneNumber()) {\n        identifierParseError.value = t('enter-a-valid-phone-number')\n        return false\n      } else if (props.identifierMode === IdentifierMode.both && !isPhoneNumber() && !isEmail()) {\n        identifierParseError.value = t('enter-a-valid-email-or-phone-number')\n        return false\n      }\n      return true\n    }\n\n    let phoneInput: intlTelInput.Plugin | undefined\n    function showCountryCode() {\n      if (phoneInput !== undefined) {\n        return\n      }\n      // we need the country code shared between login and register boxes so we emit it back up to the prop\n      // this also has the effect of storing the country code when the box is destroyed\n      ;(identifierInput.value as HTMLElement).addEventListener('countrychange', () => {\n        context.emit('update:countryCode', phoneInput?.getSelectedCountryData().iso2 ?? '')\n      })\n      phoneInput = intlTelInput(identifierInput.value, {\n        initialCountry: props.countryCode,\n        utilsScript: 'https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js',\n        dropdownContainer: controlContainer.value,\n        autoPlaceholder: 'aggressive',\n      })\n      identifierInput.value.focus()\n    }\n\n    function hideCountryCode() {\n      if (phoneInput === undefined) {\n        return\n      }\n      phoneInput.destroy()\n      phoneInput = undefined\n      if (identifierInput.value) {\n        identifierInput.value.focus()\n      }\n    }\n\n    function moveInput() {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const parent = ((identifierInput.value as HTMLElement).getRootNode() as any).host as HTMLElement\n      parent.appendChild(identifierInput.value)\n    }\n\n    const labelRef = ref<HTMLElement>()\n\n    function moveBack() {\n      labelRef.value?.append(identifierInput.value)\n    }\n\n    onMounted(() => {\n      if (props.identifierMode === IdentifierMode.phone) {\n        showCountryCode()\n      }\n    })\n\n    // a simpler phone number check that supports partially correct phone numbers\n    // only used to handle the toggling of showing & hiding the country code selector\n    function isPhoneNumberRegex(): boolean {\n      const phoneNumberRegex = /^\\+$|^\\+?[0-9,(,),\\-, ]+$/\n      return phoneNumberRegex.test(identifierText.value.trim())\n    }\n\n    // we only need to switch showing country code if we're in both mode\n    if (props.identifierMode === IdentifierMode.both) {\n      watch(identifierText, () => {\n        if (isPhoneNumberRegex()) {\n          showCountryCode()\n        } else {\n          hideCountryCode()\n        }\n      })\n    }\n\n    // if we recieve a new value for the prop it needs to be manually applied to the\n    // country code selector\n    const countryCodeText = computed<string>(() => {\n      return props.countryCode\n    })\n    watch(countryCodeText, (newValue) => {\n      phoneInput?.setCountry(newValue)\n    })\n\n    function switchAccount() {\n      context.emit('update:showWelcomeBack', false)\n      identifierText.value = ''\n    }\n\n    return {\n      error,\n      identifierText,\n      checkIdentifier,\n      clearErrors,\n      identifierInput,\n      controlContainer,\n      placeholder,\n      label,\n      inputMode,\n      moveInput,\n      labelRef,\n      moveBack,\n      showWelcomeUI,\n      switchAccount,\n      t,\n      autofocusButton,\n    }\n  },\n})\n</script>\n","<template>\n  <validated-identifier-form\n    :appId=\"appId\"\n    :identifierMode=\"identifierMode\"\n    v-model:showWelcomeBack=\"showWelcomeBack\"\n    v-model:identifier=\"identifierText\"\n    v-model:validationError=\"error\"\n    v-model:countryCode=\"countryCodeText\"\n    @onSubmit=\"onSubmit($event)\"\n    ref=\"inputForm\"\n  >\n  </validated-identifier-form>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, ref, PropType, watch, onMounted } from 'vue'\nimport { useMagicLink } from '@/PassageAuth/composables/useMagicLink'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport ValidatedIdentifierForm from '../ValidatedIdentifierForm/ValidatedIdentifierForm.vue'\nimport { IdentifierType, IValidatedEmailEvent } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport { useAppId } from '@/composables/useAppId'\nimport { WebauthnSignInRoute, MagicLinkRoute } from '@/PassageAuth/router/routes'\nimport { useCallbacks, OnEventType } from '@/composables/useCallbacks'\nimport { Identifier, Passage, PassageAppInfo, PassageUserStatus } from '@passageidentity/passage-js'\nimport { getLastLogin } from '@/utils/lastLogin'\nimport { useLocale } from '@/composables/useLocale'\n\nexport default defineComponent({\n  name: 'Login',\n  components: {\n    ValidatedIdentifierForm,\n  },\n  props: {\n    canToggleLoginRegister: Boolean,\n    identifier: {\n      type: String,\n      required: true,\n    },\n    countryCode: {\n      type: String,\n      required: true,\n    },\n    appInfo: {\n      type: Object as PropType<PassageAppInfo>,\n      required: true,\n    },\n    webauthnAllowed: {\n      type: Boolean,\n      required: true,\n    },\n    visible: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  emits: ['update:identifier', 'update:countryCode'],\n  setup(props, context) {\n    const { router } = useRouter()\n    const { appId } = useAppId()\n    const { t } = useLocale()\n    const error = ref<string>('')\n\n    const identifierText = computed<string>({\n      get(): string {\n        return props.identifier\n      },\n      set(newIdentifier): void {\n        context.emit('update:identifier', newIdentifier)\n      },\n    })\n\n    const countryCodeText = computed<string>({\n      get(): string {\n        return props.countryCode\n      },\n      set(newCountryCode): void {\n        context.emit('update:countryCode', newCountryCode)\n      },\n    })\n    const passage = new Passage(appId.value)\n\n    const inputForm = ref<Record<string, unknown>>()\n\n    watch(inputForm, async () => {\n      useCallbacks().onEvent.value(OnEventType.onLoaded)\n    })\n\n    const identifierMode = computed<Identifier>(() => {\n      return props.appInfo.allowed_identifier ?? Identifier.email\n    })\n    useMagicLink()\n\n    async function onSubmit(event: IValidatedEmailEvent) {\n      const {\n        identifier,\n        identifierExists,\n        userHasWebauthn,\n        userHasPasskey,\n        userStatus,\n        userID,\n        identifierType,\n        emailVerified,\n        phoneVerified,\n      } = event\n\n      // if a beforeAuth() callback was defined, call it now\n      const beforeAuthResult = useCallbacks().beforeAuth.value(identifier)\n      if (!beforeAuthResult) {\n        return\n      }\n\n      const errorString = checkIdentifierExistsAndStatus(identifierExists, identifierType, userStatus)\n      if (errorString !== '') {\n        error.value = errorString\n        return\n      }\n\n      if (userNeedsToVerify(emailVerified, phoneVerified, identifierType)) {\n        router.push(MagicLinkRoute, { identifier, identifierType, identifierVerifying: true })\n      } else {\n        const browserInfo = await passage.browserInfo()\n        const tryPasskey = userHasPasskey && window.PublicKeyCredential && browserInfo.getPassKeySupported\n        if (tryPasskey) {\n          useCallbacks().onEvent.value(OnEventType.onVerifyIdentity)\n          router.push(WebauthnSignInRoute, { identifier, identifierType })\n          return\n        }\n        if (props.webauthnAllowed) {\n          if (userHasWebauthn && passage.credIDExists(userID)) {\n            useCallbacks().onEvent.value(OnEventType.onVerifyIdentity)\n            router.push(WebauthnSignInRoute, { identifier, identifierType })\n          } else {\n            // Setup new device\n            useCallbacks().onEvent.value(OnEventType.onMagicLinkLogin)\n            router.push(MagicLinkRoute, { identifier, identifierType, setupNewDevice: true })\n          }\n        } else {\n          useCallbacks().onEvent.value(OnEventType.onMagicLinkLogin)\n          router.push(MagicLinkRoute, { identifier, identifierType })\n        }\n      }\n    }\n\n    function checkIdentifierExistsAndStatus(\n      identifierExists: boolean,\n      identifierType: IdentifierType,\n      userStatus: PassageUserStatus,\n    ): string {\n      if (!identifierExists) {\n        let identiferString = identifierType === IdentifierType.email ? t('email') : t('phone')\n        identiferString = identiferString.charAt(0).toUpperCase() + identiferString.slice(1)\n        let message = t('not-recognized', [identiferString])\n        if (props.canToggleLoginRegister) {\n          message = message + '. ' + t('toggle-register')\n        }\n        return message\n      }\n      if (identifierExists && userStatus === PassageUserStatus.INACTIVE) {\n        return t('account-no-longer-active')\n      }\n      return ''\n    }\n\n    function userNeedsToVerify(\n      emailVerified: boolean,\n      phoneVerified: boolean,\n      identifierType: IdentifierType,\n    ): boolean {\n      if (props.appInfo.require_identifier_verification) {\n        if (\n          (identifierType === IdentifierType.email && !emailVerified) ||\n          (identifierType === IdentifierType.phone && !phoneVerified)\n        ) {\n          return true\n        }\n      }\n      return false\n    }\n\n    const showWelcomeBack = ref<boolean>(false)\n    onMounted(() => {\n      const lastLogin = getLastLogin()\n      if (lastLogin) {\n        identifierText.value = lastLogin\n        showWelcomeBack.value = true\n      }\n    })\n    // clear welcome back autofill when switching to register\n    watch(\n      () => props.visible,\n      () => {\n        if (showWelcomeBack.value === true) {\n          identifierText.value = ''\n        }\n        showWelcomeBack.value = false\n      },\n    )\n\n    return {\n      appId,\n      error,\n      identifierText,\n      countryCodeText,\n      onSubmit,\n      identifierMode,\n      inputForm,\n      showWelcomeBack,\n    }\n  },\n})\n</script>\n","<template>\n  <div>\n    <validated-identifier-form\n      :appId=\"appId\"\n      :identifierMode=\"identifierMode\"\n      v-model:identifier=\"identifierText\"\n      v-model:validationError=\"error\"\n      v-model:countryCode=\"countryCodeText\"\n      @onSubmit=\"onSubmit($event)\"\n    >\n      <user-metadata\n        v-if=\"appInfo && appInfo.layouts.registration.length > 0\"\n        :isEditing=\"true\"\n        :appInfo=\"appInfo\"\n        :layoutType=\"LayoutType.Registration\"\n        :userMetadata=\"metadata\"\n        ref=\"metadataComponent\"\n      />\n    </validated-identifier-form>\n    <div v-if=\"!publicSignup\" class=\"notification is-danger has-text-centered\" data-test=\"invalid-app-id\">\n      {{ t('public-registration-not-allowed') }}\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, ref, PropType } from 'vue'\nimport { useMagicLink } from '@/PassageAuth/composables/useMagicLink'\nimport { useAppId } from '@/composables/useAppId'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport ValidatedIdentifierForm from '../ValidatedIdentifierForm/ValidatedIdentifierForm.vue'\nimport { IdentifierType, IValidatedEmailEvent } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport { MagicLinkRoute, RegisterDeviceRoute } from '@/PassageAuth/router/routes'\nimport { useCallbacks, OnEventType } from '@/composables/useCallbacks'\nimport {\n  Identifier,\n  Metadata,\n  Passage,\n  PassageAppInfo,\n  PassageError,\n  PassageUserStatus,\n} from '@passageidentity/passage-js'\nimport UserMetadata, { LayoutType } from '@/components/UserMetadata/UserMetadata.vue'\nimport { transformMetadata } from '@/PassageProfile/composables/useUpdateUser'\nimport { useLocale } from '@/composables/useLocale'\n\nexport default defineComponent({\n  name: 'Register',\n  props: {\n    canToggleLoginRegister: Boolean,\n    identifier: {\n      type: String,\n      required: true,\n    },\n    countryCode: {\n      type: String,\n      required: true,\n    },\n    appInfo: {\n      type: Object as PropType<PassageAppInfo>,\n      required: true,\n    },\n    webauthnAllowed: {\n      type: Boolean,\n      required: true,\n    },\n  },\n  emits: ['update:identifier', 'update:countryCode'],\n  components: {\n    ValidatedIdentifierForm,\n    UserMetadata,\n  },\n  setup(props, context) {\n    const { t } = useLocale()\n    const { router } = useRouter()\n    const { appId } = useAppId()\n    const error = ref<string>('')\n\n    const identifierText = computed<string>({\n      get(): string {\n        return props.identifier\n      },\n      set(newIdentifier): void {\n        context.emit('update:identifier', newIdentifier)\n      },\n    })\n\n    const countryCodeText = computed<string>({\n      get(): string {\n        return props.countryCode\n      },\n      set(newCountryCode): void {\n        context.emit('update:countryCode', newCountryCode)\n      },\n    })\n\n    const publicSignup = computed<boolean>(() => {\n      return props.appInfo.public_signup\n    })\n\n    const identifierMode = computed<Identifier>(() => {\n      return props.appInfo.allowed_identifier\n    })\n    useMagicLink()\n\n    async function onSubmit(event: IValidatedEmailEvent) {\n      const { identifier, identifierExists, userStatus, identifierType } = event\n\n      // if a beforeAuth() callback was defined, call it now\n      const beforeAuthResult = useCallbacks().beforeAuth.value(identifier)\n      if (!beforeAuthResult) {\n        return\n      }\n      let validMetadata = true\n      if (metadataComponent.value) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        validMetadata = (metadataComponent.value as any).validate()\n      }\n\n      if (identifierExists) {\n        if (userStatus === PassageUserStatus.ACTIVE) {\n          let message = t('account-already-exists', [\n            identifierType === IdentifierType.email ? t('email') : t('phone-number'),\n          ])\n          if (props.canToggleLoginRegister) {\n            message = message + t('toggle-login')\n          }\n          error.value = message\n          return\n        } else if (userStatus === PassageUserStatus.INACTIVE) {\n          error.value = t('account-no-longer-active')\n          return\n        }\n      }\n\n      const passage = new Passage(appId.value)\n      if (!validMetadata) {\n        return\n      }\n      try {\n        await passage.createUser({\n          identifier,\n          user_metadata: transformMetadata(metadata.value, props.appInfo.user_metadata_schema, true),\n        })\n      } catch (err) {\n        if (err instanceof PassageError && err.message.startsWith('Public signup')) {\n          error.value = err.message\n        } else {\n          error.value = t('unexpected-error')\n        }\n\n        return\n      }\n\n      if (props.appInfo.require_identifier_verification) {\n        router.push(MagicLinkRoute, { identifier, identifierType, userIsRegistering: true, identifierVerifying: true })\n      } else {\n        if (props.webauthnAllowed) {\n          useCallbacks().onEvent.value(OnEventType.onRegisterDevice, { identifier })\n          router.push(RegisterDeviceRoute, { identifier, identifierType })\n        } else {\n          useCallbacks().onEvent.value(OnEventType.onMagicLinkRegister, { identifier })\n          router.push(MagicLinkRoute, { identifier, identifierType, userIsRegistering: true })\n        }\n      }\n    }\n\n    const metadata = ref<Metadata>({})\n    const metadataComponent = ref()\n\n    return {\n      appId,\n      error,\n      identifierText,\n      countryCodeText,\n      onSubmit,\n      identifierMode,\n      metadata,\n      metadataComponent,\n      LayoutType,\n      publicSignup,\n      t,\n    }\n  },\n})\n</script>\n","export const ephemeralAppIdKey = 'psg_ephemeral_app_id'\nexport const ephemeralAppNameKey = 'psg_ephemeral_app_name'\n\nexport class EphemeralAppService {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  async newEphemeralApp(): Promise<any> {\n    const ephemeralAppUrl: string = process.env.VUE_APP_ROOT_API + '/v1/apps/'\n    const response = await fetch(ephemeralAppUrl, {\n      method: 'POST',\n      body: JSON.stringify({\n        auth_origin: window.location.origin,\n        name: 'Ephemeral Random ' + (Math.random() * 1000000).toString(),\n      }),\n    })\n    const responseBody = await response.json()\n    if (response.status !== 200) {\n      throw responseBody.message\n    }\n\n    localStorage.setItem(ephemeralAppIdKey, responseBody.app.id)\n    localStorage.setItem(ephemeralAppNameKey, responseBody.app.name)\n\n    return responseBody\n  }\n}\n","<template>\n  <div v-if=\"isEphemeral\">\n    <div v-if=\"error\" class=\"notification is-danger\">\n      {{ t('unable-to-create-test-app') }}\n    </div>\n    <div v-else class=\"notification ephemeral-box\" data-test=\"ephemeral-app-message\">\n      <div v-if=\"!claimed\">\n        {{ t('currently-using-test-app') }}\n        <a :href=\"ephemeralClaimUrl\" target=\"_blank\">{{ t('click-here') }}</a\n        >.<!-- eslint-disable-line @intlify/vue-i18n/no-raw-text-->\n      </div>\n      <div v-else>{{ t('add-your-claimed-app-like-this') }} <br />{{ exampleTag }}</div>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, ref, onBeforeMount } from 'vue'\nimport { Passage } from '@passageidentity/passage-js'\nimport { EphemeralAppService, ephemeralAppIdKey, ephemeralAppNameKey } from '@/services/EphemeralAppService'\nimport { useAppId } from '@/composables/useAppId'\nimport { useLocale } from '@/composables/useLocale'\nexport default defineComponent({\n  name: 'EphemeralAppInfo',\n  setup() {\n    const consoleUrl = process.env.VUE_APP_CONSOLE_URL || ''\n\n    const { t } = useLocale()\n\n    const error = ref<boolean>(false)\n    const isEphemeral = ref<boolean>(false)\n    const claimed = ref<boolean>(false)\n    const ephemeralClaimUrl = ref<string>('')\n    const exampleTag = ref<string>('')\n\n    const passageWebSetup = async (): Promise<void> => {\n      const { appIdUnassigned, updateAppId } = useAppId()\n      if (appIdUnassigned.value) {\n        isEphemeral.value = true\n        const ephemeralAppId: string | null = localStorage.getItem(ephemeralAppIdKey)\n        const ephemeralAppName: string | null = localStorage.getItem(ephemeralAppNameKey)\n        // If ephemeral app exists in localStorage\n        if (ephemeralAppId) {\n          const nameParam = ephemeralAppName ? `?name=${encodeURIComponent(ephemeralAppName)}` : ''\n          ephemeralClaimUrl.value = `${consoleUrl}/claim/${ephemeralAppId}${nameParam}`\n          updateAppId(ephemeralAppId)\n          logToConsole()\n        }\n        // Create new ephemeral app\n        else {\n          try {\n            const ephemeralService = new EphemeralAppService()\n            const res = await ephemeralService.newEphemeralApp()\n            updateAppId(res.app.id)\n            const nameParam = res.app.name ? `?name=${encodeURIComponent(res.app.name)}` : ''\n            ephemeralClaimUrl.value = `${consoleUrl}/claim/${res.app.id}${nameParam}`\n            logToConsole()\n          } catch (err) {\n            error.value = true\n            updateAppId('')\n          }\n        }\n      }\n    }\n\n    const checkIfClaimed = async (): Promise<void> => {\n      const { appId } = useAppId()\n      if (!isEphemeral.value) {\n        return\n      }\n      const passage = new Passage(appId.value)\n      try {\n        const res = await passage.appInfo()\n        if (!res.ephemeral) {\n          claimed.value = true\n          exampleTag.value = `<passage-auth app-id=\"${appId.value}\"/>`\n        }\n      } catch {\n        error.value = true\n      }\n    }\n\n    function logToConsole() {\n      const { appId } = useAppId()\n      console.info(`Passage Test App ID: ${appId.value}`)\n      console.info(`Claim your app: ${ephemeralClaimUrl.value}`)\n    }\n\n    onBeforeMount(async () => {\n      await passageWebSetup()\n      await checkIfClaimed()\n    })\n\n    return {\n      error,\n      isEphemeral,\n      claimed,\n      ephemeralClaimUrl,\n      exampleTag,\n      t,\n    }\n  },\n})\n</script>\n","<template>\n  <div class=\"passage-tooltip\" :class=\"`${position} ${cssVisible ? 'show-tooltip' : ''}`\" ref=\"parentItem\">\n    <div\n      v-if=\"active\"\n      v-show=\"domVisible\"\n      class=\"passage-tooltip-body\"\n      :class=\"position\"\n      :style=\"`max-width: ${width}px; ${maxHeight} ${absoluteHeight}`\"\n      @mouseenter.stop=\"clickMode ? () => {} : cancelHide()\"\n      @mouseleave.stop=\"clickMode ? () => {} : hide()\"\n      ref=\"tooltipBody\"\n    >\n      <div v-if=\"title || clickMode\" class=\"tooltip-header\">\n        <div>{{ title }}</div>\n        <inline-svg v-if=\"clickMode\" :src=\"Icons.close\" style=\"cursor: pointer\" @click.stop=\"hide\" />\n      </div>\n      <div class=\"tooltip-content\">\n        <slot name=\"tooltipBody\">{{ label }}</slot>\n      </div>\n    </div>\n    <div\n      style=\"cursor: pointer; user-select: none\"\n      @mouseenter.prevent=\"clickMode ? () => {} : show()\"\n      @mouseleave.prevent=\"clickMode ? () => {} : hide()\"\n      @click.stop=\"handleClick\"\n    >\n      <slot></slot>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, onMounted, PropType, ref } from 'vue'\nimport InlineSvg from 'vue-inline-svg'\nimport { Icons } from '@/utils/Icons'\n\nexport enum TooltipPosition {\n  isTop = 'is-top',\n  isBottom = 'is-bottom',\n  isLeft = 'is-left',\n  isRight = 'is-right',\n}\n\nexport default defineComponent({\n  name: 'Tooltip',\n  components: {\n    InlineSvg,\n  },\n  props: {\n    label: String,\n    active: {\n      type: Boolean,\n      default: true,\n    },\n    sticky: {\n      type: Boolean,\n      default: false,\n    },\n    position: {\n      type: String as PropType<TooltipPosition>,\n      default: TooltipPosition.isTop,\n    },\n    clickMode: {\n      type: Boolean,\n      default: false,\n    },\n    title: {\n      type: String,\n      default: '',\n    },\n  },\n  setup(props) {\n    const parentItem = ref()\n    const tooltipBody = ref<HTMLElement>()\n    const width = ref<number>(0)\n    const maxHeight = ref<string>('')\n    const absoluteHeight = ref<string>('')\n    const cssVisible = ref<boolean>(props.sticky)\n    const domVisible = ref<boolean>(props.sticky)\n\n    function calculateTooltipSize(): void {\n      const absoluteMaxWidth = 500\n      if (parentItem.value === undefined || parentItem.value === null) {\n        return\n      }\n      const parentItemDiv = parentItem.value as HTMLElement\n      const viewport = (parentItemDiv.getRootNode() as ShadowRoot).getElementById('passage-auth-container')\n      if (viewport === null) {\n        return\n      }\n      const { left: viewLeft, right: viewRight } = viewport.getBoundingClientRect()\n      const { left: itemLeft, right: itemRight, top: itemTop } = parentItemDiv.getBoundingClientRect()\n      const itemMidpoint = (itemRight - itemLeft) / 2 + itemLeft\n      const spaceLeft = itemMidpoint - viewLeft - 20\n      const spaceRight = viewRight - itemMidpoint - 20\n      let viewportSafeWidth\n      const viewportSafeHeight = itemTop - 20\n      switch (props.position) {\n        case TooltipPosition.isTop:\n        case TooltipPosition.isBottom:\n          viewportSafeWidth = viewRight - viewLeft - 20\n          break\n        case TooltipPosition.isLeft:\n          viewportSafeWidth = spaceLeft\n          break\n        case TooltipPosition.isRight:\n          viewportSafeWidth = spaceRight\n          break\n      }\n      maxHeight.value = `max-height: ${viewportSafeHeight}px;`\n      width.value = Math.min(viewportSafeWidth, absoluteMaxWidth)\n    }\n\n    function calculateScrollHeight() {\n      const parentItemDiv = parentItem.value as HTMLElement\n      const { top: itemTop } = parentItemDiv.getBoundingClientRect()\n      const contentHeight = tooltipBody.value?.scrollHeight || 0\n      const viewportSafeHeight = itemTop - 20\n      if (contentHeight > viewportSafeHeight) {\n        absoluteHeight.value = `height: ${viewportSafeHeight}px;`\n      }\n    }\n\n    function show(): void {\n      if (props.sticky) {\n        return\n      }\n      clearTimeout(hideTimeout)\n      clearTimeout(innerTimeout)\n      domVisible.value = true\n      calculateTooltipSize()\n      setTimeout(() => {\n        cssVisible.value = true\n        calculateScrollHeight()\n      }, 100)\n    }\n\n    let hideTimeout: NodeJS.Timeout\n    let innerTimeout: NodeJS.Timeout\n    function hide(): void {\n      if (props.sticky) {\n        return\n      }\n      hideTimeout = setTimeout(() => {\n        cssVisible.value = false\n        innerTimeout = setTimeout(() => {\n          domVisible.value = false\n        }, 150)\n      }, 100)\n    }\n\n    function cancelHide(): void {\n      clearTimeout(hideTimeout)\n      clearTimeout(innerTimeout)\n    }\n\n    function handleClick(): void {\n      if (domVisible.value) {\n        hide()\n      } else {\n        show()\n      }\n    }\n\n    onMounted(() => {\n      calculateTooltipSize()\n    })\n\n    return {\n      parentItem,\n      width,\n      maxHeight,\n      absoluteHeight,\n      cssVisible,\n      domVisible,\n      show,\n      hide,\n      cancelHide,\n      handleClick,\n      Icons,\n      tooltipBody,\n    }\n  },\n})\n</script>\n","<template>\n  <div style=\"border-top: 1px solid #dddddd; margin-top: 20px; padding-top: 15px\">\n    <tooltip :title=\"t('where-is-the-password-field')\" :position=\"TooltipPosition.isTop\" clickMode>\n      <template #tooltipBody>\n        <div style=\"text-align: left\">\n          {{ t('helper-footer-line-1', [appInfo?.name ?? '']) }}\n          <ul>\n            <li>\n              {{ t('helper-footer-bullet-0') }}\n            </li>\n            <li>{{ t('helper-footer-bullet-1') }}</li>\n            <li>\n              {{ t('helper-footer-bullet-2', [allowedIdentifier]) }}\n            </li>\n          </ul>\n          <div style=\"margin-top: 10px\">{{ t('helper-footer-line-2', [allowedIdentifier]) }}</div>\n        </div>\n      </template>\n      <div class=\"flex-row flex-center\">\n        <span style=\"opacity: 0.5\" class=\"link\">{{ t('where-is-the-password-field') }}</span\n        ><inline-svg style=\"margin-left: 10px\" :src=\"Icons.help\" />\n      </div>\n    </tooltip>\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport Tooltip, { TooltipPosition } from '@/ui-components/Tooltip.vue'\nimport { PassageAppInfo, Identifier } from '@passageidentity/passage-js'\nimport { computed } from '@vue/reactivity'\nimport InlineSvg from 'vue-inline-svg'\nimport { Icons } from '@/utils/Icons'\nimport { useLocale } from '@/composables/useLocale'\n\nconst props = defineProps<{\n  appInfo?: PassageAppInfo\n}>()\n\nconst { t } = useLocale()\n\nconst allowedIdentifier = computed<string>(() => {\n  switch (props.appInfo?.allowed_identifier) {\n    case Identifier.phone:\n      return t('phone-number')\n    case Identifier.both:\n      return t('email-or-phone-number')\n    default:\n      return t('email-address')\n  }\n})\n</script>\n","<template>\n  <div class=\"view-email-input\">\n    <div class=\"auth-flex-container\">\n      <div v-if=\"!loading\" class=\"title main-title has-text-centered\">\n        {{ showLogin ? t('login-title') : t('register-title') }}\n      </div>\n      <div style=\"height: 20px\"></div>\n      <login\n        v-if=\"!loading\"\n        v-show=\"showLogin\"\n        v-model:identifier=\"identifier\"\n        :canToggleLoginRegister=\"true\"\n        v-model:countryCode=\"countryCode\"\n        :appInfo=\"appInfo!\"\n        :webauthnAllowed=\"webauthnAllowed\"\n        :visible=\"showLogin\"\n      ></login>\n      <register\n        v-if=\"!loading\"\n        v-show=\"!showLogin\"\n        v-model:identifier=\"identifier\"\n        :canToggleLoginRegister=\"true\"\n        v-model:countryCode=\"countryCode\"\n        :appInfo=\"appInfo!\"\n        :webauthnAllowed=\"webauthnAllowed\"\n      />\n      <div v-if=\"invalidAppId\" class=\"notification is-danger has-text-centered\" data-test=\"invalid-app-id\">\n        {{ t('invalid-app-id') }}\n      </div>\n      <div class=\"spacer\">\n        <ephemeral-app-info />\n      </div>\n      <div v-if=\"!loading\" class=\"link has-text-centered\">\n        <div v-if=\"showLogin && publicSignup\">\n          {{ t('dont-have-an-account') }}\n          <a @click.prevent=\"changeInputPage\" role=\"button\" data-test=\"register-link\">{{ t('register-here') }}</a>\n        </div>\n        <div v-else-if=\"!showLogin\">\n          {{ t('already-have-an-account') }}\n          <a @click.prevent=\"changeInputPage\" role=\"button\" data-test=\"login-link\">{{ t('login-here') }}</a>\n        </div>\n      </div>\n      <help-footer v-if=\"!loading\" :appInfo=\"appInfo\" />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref } from 'vue'\nimport { useAppInfo } from '@/composables/useAppInfo'\nimport Login from '../components/Login/Login.vue'\nimport Register from '../components/Register/Register.vue'\nimport EphemeralAppInfo from '../components/EphemeralAppInfo/EphemeralAppInfo.vue'\nimport HelpFooter from '../components/HelpFooter/HelpFooter.vue'\nimport { useLocale } from '@/composables/useLocale'\nimport { useDefaultCountryCode } from '@/composables/useDefaultCountryCode'\n\nconst { t } = useLocale()\n\nconst props = defineProps<{\n  register?: boolean\n}>()\n\nconst showLogin = ref<boolean>(!props.register)\n\nconst { appInfo, loading, webauthnAllowed, invalidAppId } = useAppInfo()\n\nconst identifier = ref<string>('')\n\nconst { defaultCountryCode } = useDefaultCountryCode()\nconst countryCode = defaultCountryCode\n\nconst publicSignup = computed<boolean>(() => {\n  return appInfo.value ? appInfo.value?.public_signup : false\n})\n\nfunction changeInputPage() {\n  showLogin.value = !showLogin.value\n}\n</script>\n","<template>\n  <div class=\"view-email-input\">\n    <login\n      v-if=\"!loading\"\n      v-model:identifier=\"identifier\"\n      v-model:countryCode=\"countryCode\"\n      :canToggleLoginRegister=\"false\"\n      :appInfo=\"appInfo!\"\n      :webauthnAllowed=\"webauthnAllowed\"\n    ></login>\n    <div v-if=\"invalidAppId\" class=\"notification is-danger has-text-centered\" data-test=\"invalid-app-id\">\n      {{ t('invalid-app-id') }}\n    </div>\n    <help-footer v-if=\"!loading\" :appInfo=\"appInfo\" />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { useAppInfo } from '@/composables/useAppInfo'\nimport { ref } from 'vue'\nimport Login from '../components/Login/Login.vue'\nimport HelpFooter from '../components/HelpFooter/HelpFooter.vue'\nimport { useLocale } from '@/composables/useLocale'\nimport { useDefaultCountryCode } from '@/composables/useDefaultCountryCode'\n\nconst { t } = useLocale()\n\nconst identifier = ref<string>('')\nconst { defaultCountryCode } = useDefaultCountryCode()\nconst countryCode = defaultCountryCode\n\nconst { appInfo, loading, webauthnAllowed, invalidAppId } = useAppInfo()\n</script>\n","<template>\n  <div class=\"view-email-input\">\n    <register\n      v-if=\"!loading\"\n      v-model:identifier=\"identifier\"\n      v-model:countryCode=\"countryCode\"\n      :canToggleLoginRegister=\"false\"\n      :appInfo=\"appInfo!\"\n      :webauthnAllowed=\"webauthnAllowed\"\n    />\n    <div v-if=\"invalidAppId\" class=\"notification is-danger has-text-centered\" data-test=\"invalid-app-id\">\n      {{ t('invalid-app-id') }}\n    </div>\n    <help-footer v-if=\"!loading\" :appInfo=\"appInfo\" />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { useAppInfo } from '@/composables/useAppInfo'\nimport { ref } from 'vue'\nimport Register from '../components/Register/Register.vue'\nimport HelpFooter from '../components/HelpFooter/HelpFooter.vue'\nimport { useLocale } from '@/composables/useLocale'\nimport { useDefaultCountryCode } from '@/composables/useDefaultCountryCode'\n\nconst { t } = useLocale()\n\nconst identifier = ref<string>('')\nconst { defaultCountryCode } = useDefaultCountryCode()\nconst countryCode = defaultCountryCode\n\nconst { appInfo, loading, webauthnAllowed, invalidAppId } = useAppInfo()\n</script>\n","<template>\n  <div class=\"spinner-box\">\n    <div class=\"spinner-content\">\n      <slot></slot>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\n\nexport default defineComponent({\n  name: 'Spinner',\n})\n</script>\n","<template>\n  <div class=\"auth-flex-container\">\n    <div class=\"title has-text-centered\">\n      <span>{{ title }}</span>\n    </div>\n\n    <spinner>\n      <inline-svg v-if=\"isEmail\" :src=\"Icons.email\" alt=\"Email envelope\" />\n      <inline-svg v-else :src=\"Icons.phone\" alt=\"Message bubbles\" />\n    </spinner>\n\n    <div v-if=\"message\" class=\"content has-text-centered\" style=\"margin-bottom: 15px !important\">\n      <span v-html=\"message\"></span>\n    </div>\n\n    <div class=\"flex-row flex-center\">\n      <button\n        @click.prevent=\"resendMagicLink\"\n        type=\"button\"\n        class=\"button is-primary\"\n        part=\"button\"\n        :disabled=\"loading\"\n      >\n        {{ t('resend-isemail-email-message', [isEmail ? t('email') : t('message')]) }}\n      </button>\n    </div>\n\n    <div class=\"spacer\"></div>\n\n    <div class=\"link has-text-centered\">\n      <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n        t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n      }}</a>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref } from 'vue'\nimport { Passage, authResult as AuthResult } from '@passageidentity/passage-js'\nimport { useAppId } from '@/composables/useAppId'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport { useCallbacks, OnEventType } from '@/composables/useCallbacks'\nimport { IdentifierType } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport Spinner from '../../../ui-components/Spinner.vue'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport { storeLastLogin } from '@/utils/lastLogin'\nimport { useLocale } from '@/composables/useLocale'\n\nconst props = defineProps<{\n  identifier: string\n  userIsRegistering: boolean\n  identifierVerifying: boolean\n  setupNewDevice: boolean\n  identifierType: IdentifierType\n}>()\nconst { t, locale } = useLocale()\nconst { appId } = useAppId()\nconst passage = new Passage(appId.value)\nconst { router } = useRouter()\nconst isEmail = computed<boolean>(() => {\n  return props.identifierType === IdentifierType.email\n})\n\nconst title = computed<string>(() => {\n  if (props.identifierVerifying) {\n    if (isEmail.value) {\n      if (props.userIsRegistering) {\n        return t('verify-email-to-register')\n      } else {\n        return t('verify-email-to-login')\n      }\n    } else {\n      if (props.userIsRegistering) {\n        return t('verify-phone-to-register')\n      } else {\n        return t('verify-phone-to-login')\n      }\n    }\n  } else {\n    if (isEmail.value) {\n      if (props.userIsRegistering) {\n        return t('check-email-to-register')\n      } else {\n        return t('check-email-to-login')\n      }\n    } else {\n      if (props.userIsRegistering) {\n        return t('check-phone-to-register')\n      } else {\n        return t('check-phone-to-login')\n      }\n    }\n  }\n})\n\nconst message = computed<string>(() => {\n  let messageValue = ''\n  const messageType = props.identifierType === IdentifierType.email ? t('messagetype-email') : t('messagetype-sms')\n  const messageMedium = props.identifierType === IdentifierType.email ? t('email') : t('phone-number')\n  const registrationType = props.userIsRegistering ? t('registration') : t('login')\n  const loginMessage = props.identifierVerifying\n    ? t('please-verify-identifier', [messageMedium, registrationType])\n    : t('you-will-be-automatically-signed-in')\n  messageValue = t('weve-sent-messagetype', [messageType, props.identifier, loginMessage])\n  if (props.setupNewDevice && !props.userIsRegistering) {\n    messageValue = t('we-dont-recognize-this-device') + ' ' + messageValue\n  }\n  return messageValue\n})\n\nonMounted(() => {\n  if (props.userIsRegistering) {\n    magicLinkSendRegister()\n  } else {\n    magicLinkSendLogin()\n  }\n})\n\nfunction changeEmail() {\n  localStorage.removeItem('email')\n  localStorage.removeItem('magic_link_id')\n  localStorage.removeItem('wait_count')\n  waitForActivatedMagicLink(721) // past the 1 hour polling limit\n  router.push(router.homeRoute)\n}\n\nasync function resendMagicLink(): Promise<void> {\n  await magicLinkSendLogin()\n}\n\nconst showWaiting = ref<boolean>(false)\nconst loading = ref<boolean>(true)\nasync function magicLinkSendRegister() {\n  showWaiting.value = false\n  loading.value = true\n\n  // Wait n seconds so user knows something happened\n  await new Promise((resolve) => {\n    setTimeout(resolve, 2000)\n  })\n\n  try {\n    const res = await passage.newRegisterMagicLink(props.identifier, locale.value.split('-')[0])\n\n    if (res.id != '') {\n      localStorage.setItem('magic_link_id', res.id)\n      waitForActivatedMagicLink(0)\n    }\n  } catch (err) {\n    console.log('magicLinkSend error', err)\n  } finally {\n    loading.value = false\n  }\n}\n\nasync function magicLinkSendLogin() {\n  showWaiting.value = false\n  loading.value = true\n\n  try {\n    const res = await passage.newLoginMagicLink(props.identifier, locale.value.split('-')[0])\n\n    if (res.id != '') {\n      localStorage.setItem('magic_link_id', res.id)\n      waitForActivatedMagicLink(0)\n    }\n  } catch (err) {\n    console.log('magicLinkSend error', err)\n  } finally {\n    // Disable the resend email button for 3 seconds\n    await new Promise((resolve) => {\n      setTimeout(resolve, 3000)\n    })\n    loading.value = false\n  }\n}\n\nlet authResult: AuthResult | undefined = undefined\nasync function lookupMagicLink() {\n  const id = localStorage.getItem('magic_link_id')\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  await lookupMagicLinkActivated(id!).then(async () => {\n    if (authResult && authResult.redirect_url != '') {\n      localStorage.removeItem('magic_link_id')\n      localStorage.removeItem('wait_count')\n      await storeLastLogin()\n      useCallbacks().onEvent.value(OnEventType.onMagicLinkActivated)\n      useCallbacks().onSuccess.value(authResult)\n    }\n  })\n}\nasync function lookupMagicLinkActivated(id: string) {\n  await passage\n    .getMagicLinkStatus(id)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    .then((res: AuthResult) => {\n      waitForActivatedMagicLink(721) //past the 1 hour polling limit -- stops lookup\n      authResult = res\n    })\n    .catch(() => {\n      // this is a totally normal error to get to, so don't do anything\n      // waiting for the user to click the magic link\n      //console.error('lookup error', e)\n    })\n  return\n}\n\nlet timer: NodeJS.Timeout\nfunction waitForActivatedMagicLink(count: number) {\n  let i = count\n  if (i < 720) {\n    showWaiting.value = true\n    timer = setTimeout(async () => {\n      delay(i)\n      i++\n      waitForActivatedMagicLink(i)\n    }, 5000)\n  } else {\n    clearTimeout(timer)\n    showWaiting.value = false\n    return\n  }\n}\n\nfunction delay(i: number) {\n  lookupMagicLink()\n  localStorage.setItem('wait_count', i.toString())\n}\n</script>\n","<template>\n  <div class=\"view-access-token\">\n    <magic-link\n      :identifier=\"identifier\"\n      :userIsRegistering=\"userIsRegistering\"\n      :identifierVerifying=\"identifierVerifying\"\n      :setupNewDevice=\"setupNewDevice\"\n      :identifierType=\"identifierType\"\n    />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport MagicLink from '../components/MagicLink/MagicLink.vue'\nimport { IdentifierType } from '../components/ValidatedIdentifierForm/IntentifierTypes'\n\nexport default defineComponent({\n  name: 'MagicLinkView',\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    userIsRegistering: {\n      type: Boolean,\n      default: false,\n    },\n    identifierVerifying: {\n      type: Boolean,\n      default: false,\n    },\n    setupNewDevice: {\n      type: Boolean,\n      default: false,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  components: {\n    MagicLink,\n  },\n})\n</script>\n","<template>\n  <div class=\"auth-flex-container\">\n    <div class=\"title secondary-title has-text-centered\">\n      {{ title }}\n    </div>\n\n    <figure class=\"image has-text-centered\">\n      <inline-svg\n        v-if=\"showFailure && isEmail\"\n        :src=\"Icons.loginWithEmail\"\n        alt=\"Biometrics scan failed\"\n        style=\"margin: 5px\"\n      />\n      <inline-svg\n        v-else-if=\"showFailure && !isEmail\"\n        :src=\"Icons.loginWithText\"\n        alt=\"Biometrics scan failed\"\n        style=\"margin: 5px\"\n      />\n      <platform-icon v-else />\n    </figure>\n\n    <div\n      class=\"content wrap-text has-text-centered\"\n      style=\"margin-bottom: 10px !important\"\n      data-tag=\"register-device-message\"\n    >\n      <div v-if=\"identifier\" style=\"margin-bottom: 5px\">\n        <strong>{{ identifier }}</strong>\n      </div>\n      <div v-if=\"showFailure\">\n        <p>\n          {{\n            isEmail ? t('registration-with-link-error-message-email') : t('registration-with-link-error-message-phone')\n          }}\n        </p>\n      </div>\n      <div v-else>\n        <div style=\"margin-bottom: 10px\">\n          {{ t('register-your-account') }}\n        </div>\n        <div>\n          {{ t('does-not-give-app-personal-info') }}\n        </div>\n      </div>\n    </div>\n\n    <div class=\"flex-row flex-center\" v-if=\"showFailure\">\n      <button\n        @click.prevent=\"registerWithEmail\"\n        type=\"button\"\n        part=\"button\"\n        class=\"button is-primary small\"\n        :disabled=\"loading\"\n        style=\"margin-right: 5px\"\n        data-test=\"login-with-email-button\"\n        ref=\"autofocusButton\"\n      >\n        {{ t('send-email-or-text-link', [isEmail ? t('email') : t('sms-text')]) }}\n      </button>\n      <button\n        @click.prevent=\"onButtonClick\"\n        type=\"button\"\n        part=\"button\"\n        class=\"button is-secondary small\"\n        :disabled=\"loading\"\n        style=\"margin-left: 5px\"\n      >\n        {{ t('try-again') }}\n      </button>\n    </div>\n\n    <div class=\"flex-row flex-center\" v-else>\n      <button\n        @click.prevent=\"onButtonClick\"\n        type=\"button\"\n        class=\"button\"\n        part=\"button\"\n        :class=\"[{ 'is-loading': loading }]\"\n        :disabled=\"loading\"\n        data-test=\"register-main-button\"\n        tabindex=\"0\"\n        ref=\"autofocusButton\"\n      >\n        <span>{{ t('register-with-device') }}</span>\n      </button>\n    </div>\n\n    <div class=\"content has-text-centered\" style=\"margin-top: 20px !important\" v-if=\"showFailure\">\n      <div class=\"link\">\n        <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n          t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n        }}</a>\n      </div>\n    </div>\n\n    <div class=\"spacer\" v-if=\"!showFailure\"></div>\n\n    <div class=\"flex-row flex-wrap flex-between\" v-if=\"!showFailure\">\n      <div class=\"link\">\n        <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n          t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n        }}</a>\n      </div>\n      <div class=\"link\">\n        <a @click.prevent=\"registerWithEmail\" role=\"button\" data-test=\"register-email-button\">{{\n          t('register-with-link', [isEmail ? t('email') : t('sms-text')])\n        }}</a>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, ref } from 'vue'\nimport { Passage, authResult } from '@passageidentity/passage-js'\nimport { useAppId } from '@/composables/useAppId'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport { MagicLinkRoute } from '@/PassageAuth/router/routes'\nimport { useCallbacks } from '@/composables/useCallbacks'\nimport { IdentifierType } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport PlatformIcon from '@/components/PlatformIcon/PlatformIcon.vue'\nimport { storeLastLogin } from '@/utils/lastLogin'\nimport { useLocale } from '@/composables/useLocale'\nimport { useAutofocusButton } from '@/composables/useAutofocusButton'\n\nexport default defineComponent({\n  name: 'RegisterDevice',\n  components: {\n    InlineSvg,\n    PlatformIcon,\n  },\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  setup(props) {\n    const { t } = useLocale()\n    const { appId } = useAppId()\n    const { router } = useRouter()\n    const { onSuccess } = useCallbacks()\n    const showFailure = ref<boolean>(false)\n\n    const { autofocusButton } = useAutofocusButton()\n\n    const isEmail = computed<boolean>(() => {\n      return props.identifierType === IdentifierType.email\n    })\n\n    const title = computed<string>(() => {\n      if (showFailure.value) {\n        return t('register-with-link', [isEmail.value ? t('email') : t('sms-text')])\n      }\n      return t('register-without-a-password')\n    })\n\n    return {\n      appId,\n      router,\n      onSuccess,\n      isEmail,\n      showFailure,\n      title,\n      Icons,\n      t,\n      autofocusButton,\n    }\n  },\n  data: () => {\n    return {\n      loading: false,\n      authResult: null as unknown as authResult,\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      passage: null as any,\n    }\n  },\n  created: function () {\n    this.passage = new Passage(this.appId)\n  },\n  methods: {\n    async signUpWebAuthn(identifier: string): Promise<void> {\n      this.loading = true\n      this.showFailure = false\n      this.authResult = { auth_token: '', redirect_url: '' }\n      try {\n        const res = await this.passage.register(identifier)\n        this.authResult = res\n\n        // Update state\n        this.loading = false\n\n        if (this.authResult.redirect_url) {\n          // alert(\"User with email: \" + this.email + \"--- NOT SIGNED UP\")\n          storeLastLogin(identifier)\n          this.onSuccess(this.authResult)\n        }\n      } catch (err) {\n        this.showFailure = true\n        this.loading = false\n      }\n    },\n    registerWithEmail() {\n      if (this.showFailure) {\n        this.router.push(MagicLinkRoute, {\n          identifier: this.identifier,\n          identifierType: this.identifierType,\n          userIsRegistering: false,\n        })\n      } else {\n        this.router.push(MagicLinkRoute, {\n          identifier: this.identifier,\n          identifierType: this.identifierType,\n          userIsRegistering: true,\n        })\n      }\n    },\n    changeEmail() {\n      localStorage.removeItem('email')\n      this.router.push(this.router.homeRoute, { register: true })\n    },\n    redirectNow() {\n      if (this.authResult.redirect_url) {\n        storeLastLogin(this.identifier)\n        this.onSuccess(this.authResult)\n      }\n    },\n    onButtonClick() {\n      this.signUpWebAuthn(this.identifier)\n    },\n  },\n})\n</script>\n","<template>\n  <register-device :identifier=\"identifier\" :identifierType=\"identifierType\" />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport RegisterDevice from '../components/RegisterDevice/RegisterDevice.vue'\nimport { IdentifierType } from '../components/ValidatedIdentifierForm/IntentifierTypes'\n\nexport default defineComponent({\n  name: 'RegisterDeviceView',\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  components: {\n    RegisterDevice,\n  },\n})\n</script>\n","<template>\n  <div class=\"auth-flex-container\">\n    <div class=\"title has-text-centered\">\n      {{ showFailure ? t('login-with-link', [isEmail ? t('email') : t('sms-text')]) : t('verify-your-identity') }}\n    </div>\n    <figure class=\"image has-text-centered\" style=\"margin: 5px auto\">\n      <inline-svg\n        v-if=\"showFailure && isEmail\"\n        :src=\"Icons.loginWithEmail\"\n        alt=\"Biometrics scan failed\"\n        style=\"margin: 5px\"\n      />\n      <inline-svg\n        v-else-if=\"showFailure && !isEmail\"\n        :src=\"Icons.loginWithText\"\n        alt=\"Biometrics scan failed\"\n        style=\"margin: 5px\"\n      />\n      <platform-icon v-else />\n    </figure>\n    <div class=\"content wrap-text has-text-centered\" style=\"margin-bottom: 25px !important\" v-if=\"!showFailure\">\n      <div v-if=\"identifier\" style=\"margin-bottom: 5px\">\n        <strong>{{ identifier }}</strong>\n      </div>\n      <div>{{ t('log-into-your-account') }}</div>\n    </div>\n\n    <div class=\"content wrap-text has-text-centered\" style=\"margin-bottom: 5px !important\" v-else-if=\"showFailure\">\n      <div v-if=\"identifier\" style=\"margin-bottom: 5px\">\n        <strong>{{ identifier }}</strong>\n      </div>\n      <div data-test=\"failure-message\">\n        <p>{{ isEmail ? t('login-with-link-error-message-email') : t('login-with-link-error-message-phone') }}</p>\n      </div>\n    </div>\n\n    <div class=\"flex-row flex-center\" v-if=\"showFailure\">\n      <button\n        @click.prevent=\"loginWithEmail\"\n        type=\"button\"\n        part=\"button\"\n        class=\"button is-primary small\"\n        :disabled=\"loading\"\n        style=\"margin-right: 5px\"\n        data-test=\"login-with-email-button\"\n        ref=\"autofocusButton\"\n      >\n        {{ t('send-email-or-text-link', [isEmail ? t('email') : t('sms-text')]) }}\n      </button>\n      <button\n        @click.prevent=\"signInWebAuthn\"\n        type=\"button\"\n        part=\"button\"\n        class=\"button is-secondary small\"\n        :disabled=\"loading\"\n        style=\"margin-left: 5px\"\n      >\n        {{ t('try-again') }}\n      </button>\n    </div>\n\n    <div class=\"content has-text-centered\" style=\"margin-top: 20px !important\" v-if=\"showFailure\">\n      <div class=\"link\">\n        <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n          t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n        }}</a>\n      </div>\n    </div>\n\n    <div class=\"spacer\" v-if=\"!showFailure\"></div>\n\n    <div class=\"flex-row flex-wrap flex-between\" v-if=\"!showFailure\">\n      <div class=\"link\">\n        <a @click.prevent=\"changeEmail\" role=\"button\" data-test=\"change-email-button\">{{\n          t('change-isemail-email-phone', [isEmail ? t('email') : t('phone')])\n        }}</a>\n      </div>\n      <div class=\"link\">\n        <a @click.prevent=\"loginWithEmail\" role=\"button\" data-test=\"register-email-button\">{{\n          t('login-with-link', [isEmail ? t('email') : t('sms-text')])\n        }}</a>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent } from 'vue'\nimport { Passage, authResult, PassageError, PassageErrorCode } from '@passageidentity/passage-js'\nimport { useAppId } from '@/composables/useAppId'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport { MagicLinkRoute } from '@/PassageAuth/router/routes'\nimport { useCallbacks } from '@/composables/useCallbacks'\nimport { IdentifierType } from '../ValidatedIdentifierForm/IntentifierTypes'\nimport { Icons } from '@/utils/Icons'\nimport InlineSvg from 'vue-inline-svg'\nimport PlatformIcon from '@/components/PlatformIcon/PlatformIcon.vue'\nimport { storeLastLogin } from '@/utils/lastLogin'\nimport { useLocale } from '@/composables/useLocale'\nimport { useAutofocusButton } from '@/composables/useAutofocusButton'\n\nexport default defineComponent({\n  name: 'WebauthnSignIn',\n  components: {\n    InlineSvg,\n    PlatformIcon,\n  },\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  setup(props) {\n    const { t } = useLocale()\n    const { appId } = useAppId()\n    const { router } = useRouter()\n    const isEmail = computed<boolean>(() => {\n      return props.identifierType === IdentifierType.email\n    })\n\n    const { autofocusButton } = useAutofocusButton()\n\n    return {\n      appId,\n      router,\n      isEmail,\n      Icons,\n      t,\n      autofocusButton,\n    }\n  },\n  data: () => {\n    return {\n      showFailure: false,\n      loading: false,\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      passage: null as any,\n      authResult: null as unknown as authResult,\n    }\n  },\n  created: function () {\n    this.passage = new Passage(this.appId)\n  },\n  mounted() {\n    this.signInWebAuthn()\n  },\n  methods: {\n    async signInWebAuthn() {\n      this.authResult = { auth_token: '', redirect_url: '' }\n      this.showFailure = false\n\n      if (!this.identifier) {\n        return\n      }\n\n      this.loading = true\n\n      try {\n        const res = await this.passage.login(this.identifier)\n        this.authResult = res\n        if (this.authResult.redirect_url) {\n          storeLastLogin(this.identifier)\n          useCallbacks().onSuccess.value(this.authResult)\n        }\n        this.loading = false\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      } catch (err: any) {\n        const error = err as PassageError\n        this.showFailure = true\n        this.loading = false\n        if (error.statusCode === PassageErrorCode.PSGParsePublicKeyForLoginFailed) {\n          // TODO: handle this\n          this.showFailure = true\n        } else {\n          this.router.push(MagicLinkRoute, { identifier: this.identifier, identifierType: this.identifierType })\n        }\n      }\n    },\n    loginWithEmail() {\n      this.router.push(MagicLinkRoute, { identifier: this.identifier, identifierType: this.identifierType })\n    },\n    changeEmail() {\n      localStorage.removeItem('email')\n      this.router.push(this.router.homeRoute)\n    },\n  },\n})\n</script>\n","<template>\n  <div class=\"view-webauthn-sign-in\">\n    <webauthn-sign-in :identifier=\"identifier\" :identifierType=\"identifierType\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport WebauthnSignIn from '../components/WebauthnSignIn/WebauthnSignIn.vue'\nimport { IdentifierType } from '../components/ValidatedIdentifierForm/IntentifierTypes'\n\nexport default defineComponent({\n  name: 'WebauthnSignInView',\n  props: {\n    identifier: {\n      type: String,\n      required: true,\n    },\n    identifierType: {\n      type: String as () => IdentifierType,\n      required: true,\n    },\n  },\n  components: {\n    WebauthnSignIn,\n  },\n})\n</script>\n","<template>\n  <component :is=\"currentComponent\" v-bind=\"currentProps\"><slot></slot></component>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, computed } from 'vue'\nimport { useRouter } from '@/PassageAuth/composables/useRouter'\nimport ActivateMagicLinkView from '../../views/ActivateMagicLinkView.vue'\nimport AuthView from '../../views/AuthView.vue'\nimport LoginView from '../../views/LoginView.vue'\nimport RegisterView from '../../views/RegisterView.vue'\nimport MagicLinkView from '../../views/MagicLinkView.vue'\nimport RegisterDeviceView from '../../views/RegisterDeviceView.vue'\nimport WebauthnSignInView from '../../views/WebauthnSignInView.vue'\n\nexport default defineComponent({\n  name: 'RouterView',\n  components: {\n    ActivateMagicLinkView,\n    AuthView,\n    LoginView,\n    RegisterView,\n    MagicLinkView,\n    RegisterDeviceView,\n    WebauthnSignInView,\n  },\n  setup() {\n    const { currentRoute } = useRouter()\n    const currentComponent = computed<string>(() => currentRoute.value.component)\n    const currentProps = computed(() => {\n      const props = currentRoute.value.props\n      if (props === undefined) {\n        return {}\n      }\n      return props\n    })\n\n    return {\n      currentComponent,\n      currentProps,\n    }\n  },\n})\n</script>\n"],"names":["OnEventType","defaultBeforeAuth","defaultOnSuccess","authResult","window","location","href","redirect_url","defaultOnEvent","beforeAuth","ref","onSuccess","onEvent","setBeforeAuth","newBeforeAuth","value","setOnSuccess","newOnSuccess","setOnEvent","newOnEvent","useCallbacks","readonly","AuthRoute","component","RegisterDeviceRoute","MagicLinkRoute","WebauthnSignInRoute","ActivateMagicLinkRoute","router","reactive","constructor","this","_history","_homeRoute","push","homeRoute","currentRoute","length","route","props","__spreadProps","__spreadValues","resetRouter","computed","useRouter","useAutofocusButton","autofocusButton","customElements","watch","focus","_sfc_main","defineComponent","name","components","InlineSvg","PlatformIcon","type","Object","required","setup","t","useLocale","appId","useAppId","showFailure","showSuccess","newDevice","addDevice","addPending","errorMessage","useAddDevice","title","onButtonClick","__async","_a","id","_b","onSkipButtonClick","Icons","_hoisted_2","class","_hoisted_4","key","style","_hoisted_8","padding","_openBlock","_createElementBlock","_Fragment","_createElementVNode","_normalizeClass","_ctx","createBaseVNode","_hoisted_1","_createBlock","_component_inline_svg","src","fingerprintFailed","alt","_component_platform_icon","createElementBlock","_hoisted_5","_toDisplayString","toDisplayString","_hoisted_6","_hoisted_7","onClick","_cache","_withModifiers","withModifiers","args","normalizeClass","part","disabled","_hoisted_11","_hoisted_12","role","useWebauthnUtils","passage","deviceRecognized","webauthnAllowed","userGestureRequired","webkitConvertPointFromNodeToPage","verifyWebAuthnAllowed","appInfo","checkWebauthnConfig","isWebauthnSupported","isDeviceRecognized","magicLink","userID","split","credIDExists","checkWebauthnAndDeviceRecognized","MagicLinkActionEnum","storeLastLogin","identiferOrUserInfo","localStorage","setItem","currentInfo","Passage","getCurrentUser","userInfo","email","phone","useMagicLinkActivation","uiState","magicLinkUtils","webauthnUtils","onBeforeActivate","uiLoading","auth_token","onActivateError","uiError","onActivateErrorInvalidMagicLink","invalidMagicLink","onActivateSuccess","_0","result","uiSuccess","Promise","resolve","setTimeout","showAddDevice","activateWithoutBiometrics","magicLinkActivate","err","statusCode","PassageErrorCode","M","NotFound","activateWithBiometrics","magicLinkActivateWebAuthnLogin","error","PSGCredObjectDoesNotExist","Unauthorized","String","AddDevice","loading","pageLoading","useUIState","magicLinkAction","isMagicLinkValid","searchParams","URLSearchParams","has","useMagicLinkUtils","activation","onMounted","shouldAutoActivate","shouldAutoActivateWithBio","onMagicLinkActivateSuccess","redirectNow","_hoisted_3","_withDirectives","createBlock","fingerprintSuccess","openBlock","emailSuccess","VERIFY","emailFailed","_createCommentVNode","createCommentVNode","_hoisted_9","LOGIN","_hoisted_10","_hoisted_13","small","_hoisted_15","_hoisted_16","_hoisted_18","_normalizeStyle","_createVNode","_component_AddDevice","ActivateMagicLink","_component_activate_magic_link","useMagicLink","queryString","search","urlParams","get","IdentifierType","emits","validationError","default","identifier","countryCode","identifierMode","showWelcomeBack","Boolean","context","identifierParseError","identifierInput","controlContainer","showWelcomeUI","label","identifierType","IdentifierMode","bt","both","charAt","toUpperCase","slice","placeholder","inputMode","identifierText","set","newIdentifier","emit","formattedIdentifier","isPhoneNumber","phoneInput","getNumber","trim","toLowerCase","isStringNullish","isEmail","test","isPhoneNumberRegex","isValidNumber","showCountryCode","addEventListener","getSelectedCountryData","iso2","intlTelInput","initialCountry","utilsScript","dropdownContainer","autoPlaceholder","labelRef","destroy","countryCodeText","newValue","setCountry","checkIdentifier","message","validateInput","identifierExists","userHasWebauthn","userHasPasskey","emailVerified","userStatus","phoneVerified","webauthn","status","email_verified","phone_verified","webauthn_types","includes","WebAuthnType","vt","Passkey","PassageUserStatus","St","INACTIVE","e","clearErrors","moveInput","getRootNode","host","appendChild","moveBack","append","switchAccount","width","$props","$setup","$data","$options","onSubmit","_createTextVNode","createTextVNode","withDirectives","$event","autocomplete","inputmode","onInput","_vModelText","vModelText","_renderSlot","ValidatedIdentifierForm","canToggleLoginRegister","visible","newCountryCode","inputForm","onLoaded","allowed_identifier","Identifier","lastLogin","getItem","event","errorString","identiferString","checkIdentifierExistsAndStatus","require_identifier_verification","userNeedsToVerify","identifierVerifying","browserInfo","PublicKeyCredential","getPassKeySupported","onVerifyIdentity","onMagicLinkLogin","setupNewDevice","_component_validated_identifier_form","onOnSubmit","UserMetadata","publicSignup","public_signup","metadata","metadataComponent","validMetadata","validate","ACTIVE","createUser","user_metadata","transformMetadata","user_metadata_schema","PassageError","startsWith","userIsRegistering","onRegisterDevice","onMagicLinkRegister","LayoutType","_withCtx","withCtx","layouts","registration","_component_user_metadata","isEditing","layoutType","Registration","userMetadata","EphemeralAppService","newEphemeralApp","response","fetch","method","body","JSON","stringify","auth_origin","origin","Math","random","toString","responseBody","json","app","consoleUrl","isEphemeral","claimed","ephemeralClaimUrl","exampleTag","passageWebSetup","appIdUnassigned","updateAppId","ephemeralAppId","ephemeralAppName","nameParam","encodeURIComponent","ephemeralService","res","checkIfClaimed","ephemeral","logToConsole","console","info","onBeforeMount","target","TooltipPosition","TooltipPosition2","active","sticky","position","clickMode","parentItem","tooltipBody","maxHeight","absoluteHeight","cssVisible","domVisible","calculateTooltipSize","parentItemDiv","viewport","getElementById","left","viewLeft","right","viewRight","getBoundingClientRect","itemLeft","itemRight","top","itemTop","itemMidpoint","spaceLeft","spaceRight","viewportSafeWidth","viewportSafeHeight","min","show","clearTimeout","hideTimeout","innerTimeout","scrollHeight","hide","cancelHide","handleClick","onMouseenter","onMouseleave","close","cursor","$slots","allowedIdentifier","showLogin","register","invalidAppId","useAppInfo","defaultCountryCode","useDefaultCountryCode","changeInputPage","locale","messageValue","messageType","messageMedium","registrationType","loginMessage","changeEmail","removeItem","waitForActivatedMagicLink","resendMagicLink","magicLinkSendLogin","showWaiting","newRegisterMagicLink","log","newLoginMagicLink","timer","lookupMagicLink","getMagicLinkStatus","then","catch","lookupMagicLinkActivated","onMagicLinkActivated","count","i","delay","MagicLink","_component_magic_link","data","created","Qe","methods","signUpWebAuthn","registerWithEmail","loginWithEmail","margin","loginWithText","tabindex","_hoisted_14","_hoisted_17","_hoisted_19","RegisterDevice","_component_register_device","mounted","signInWebAuthn","login","PSGParsePublicKeyForLoginFailed","WebauthnSignIn","_component_webauthn_sign_in","ActivateMagicLinkView","AuthView","LoginView","RegisterView","MagicLinkView","RegisterDeviceView","WebauthnSignInView","currentComponent","currentProps","_resolveDynamicComponent","_normalizeProps","_guardReactiveProps","guardReactiveProps"],"mappings":"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"}