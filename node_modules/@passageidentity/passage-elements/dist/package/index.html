<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <link rel="icon" href="<%= BASE_URL %>favicon.ico" />
    <title>Passage Local</title>
  </head>
  <style>
    body {
      background: #e5e5e5;
    }

    .container {
      background: white;
      box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
      border-radius: 20px;
      width: 360px;
      margin: 30px auto;
    }

    .profile-container {
      width: 100%;
    }

    .darkmode.container {
      background: black;
      border-radius: 20px;
    }

    .darkmode passage-auth,
    .darkmode passage-login,
    .darkmode passage-register,
    .darkmode passage-profile {
      --passage-primary-color: #e40914;
      --passage-body-text-color: white;
      --passage-header-text-color: white;
      --passage-onprimary-color: white;
      --passage-header-font-size: 28px;
      --passage-body-font-size: 15px;
      --passage-body-font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      --passage-header-font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      --passage-button-width: 100%;
      --passage-button-font-size: 18px;
      --passage-button-border-radius: 4px;
      --passage-table-header-background: #e40914;
      --passage-table-background-hover: #333333;
      --passage-container-background: black;
    }

    .darkmode passage-auth::part(input),
    .darkmode passage-login::part(input),
    .darkmode passage-register::part(input),
    .darkmode passage-profile::part(input) {
      background-color: #333333;
      border-color: transparent;
    }
  </style>
  <body>
    <noscript>
      <strong
        >We're sorry but Passage Local doesn't work properly without JavaScript enabled. Please enable it to
        continue.</strong
      >
    </noscript>
    <button id="theme-toggle" onclick="toggleTheme()">Dark Mode</button>
    <select id="language-toggle" onchange="changeLocale(this)">
      <option value="auto">Auto</option>
      <option value="en">English</option>
      <option value="de">German</option>
      <option value="it">Italian</option>
    </select>
    <div class="container">
      <passage-auth app-id="preflight" default-country-code="us"></passage-auth>
    </div>
    <div class="container profile-container">
      <passage-profile app-id="preflight" default-country-code="us"></passage-profile>
    </div>
    <script src="index.umd.js"></script>
    <script>
      const onSuccess = (data) => {
        console.log('WE ARE PRINTING FROM onSuccess() in index.html')
        console.log(data)
      }
      const beforeAuth = (data) => {
        console.log('beforeAuth is hit')
        console.log(data)
        return true
      }

      const onEvent = (type, data) => {
        console.log('hit onEvent --->', type)
      }

      var passageAuth = document.querySelector('passage-auth')

      // Enable this to see an example when onSuccess is set
      // passageAuth.onSuccess = onSuccess
      passageAuth.beforeAuth = beforeAuth
      passageAuth.onEvent = onEvent

      const PassageUser = window.Passage.PassageUser
      new PassageUser().userInfo().then((value) => console.log(value))

      const theme = localStorage.getItem('theme')
      let isDark = false
      if (theme === 'dark') {
        document.querySelectorAll('.container').forEach((element) => {
          element.classList.add('darkmode')
        })
        isDark = true
        document.getElementById('theme-toggle').textContent = 'Light Mode'
      }
      function toggleTheme() {
        document.querySelectorAll('.container').forEach((element) => {
          if (isDark) {
            element.classList.remove('darkmode')
          } else {
            element.classList.add('darkmode')
          }
        })
        isDark = !isDark
        localStorage.setItem('theme', isDark ? 'dark' : 'light')
        document.getElementById('theme-toggle').textContent = `${isDark ? 'Light Mode' : 'Dark Mode'}`
      }

      function changeLocale(language) {
        if (language.value === 'auto') {
          passageAuth.lang = undefined
          return
        }
        passageAuth.lang = language.value
      }
    </script>
    <!-- built files will be auto injected -->
  </body>
</html>
