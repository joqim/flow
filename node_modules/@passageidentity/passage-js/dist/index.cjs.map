{"version":3,"sources":["../../../node_modules/tsup/assets/cjs_shims.js","../../../node_modules/ua-parser-js/src/ua-parser.js","../src/index.ts","../src/Passage.ts","../src/Register.ts","../src/BytesHelper.ts","../src/AuthTokenHelper.ts","../src/PassageError.ts","../src/BrowserHelper.ts","../src/utils/HandleResponse.ts","../src/utils/FirefoxHandlers.ts","../src/utils/GetHeaders.ts","../src/config/Environment.ts","../src/config/env_config.ts","../src/utils/StoreResponseTokens.ts","../src/TokenStore.ts","../src/Login.ts","../src/UnauthInfo.ts","../src/MagicLink.ts","../src/User.ts","../src/Session.ts","../src/utils/getBaseURL.ts","../src/utils/asyncCallWithTimout.ts","../src/CaptureEvent.ts","../src/types/PassageApp.ts","../src/types/PassageMagicLinkRequest.ts","../src/types/PassageUser.ts","../src/types/PassageUserInfo.ts","../src/types/PassageDevice.ts","../src/types/PassageEditDeviceRequest.ts"],"sourcesContent":["// Shim globals in cjs bundle\n// There's a weird bug that esbuild will always inject importMetaUrl\n// if we export it as `const importMetaUrl = ... __filename ...`\n// But using a function will not cause this issue\n\nconst getImportMetaUrl = () =>\n  typeof document === 'undefined'\n    ? new URL('file:' + __filename).href\n    : (document.currentScript && document.currentScript.src) ||\n      new URL('main.js', document.baseURI).href\n\nexport const importMetaUrl = /* @__PURE__ */ getImportMetaUrl()\n","/////////////////////////////////////////////////////////////////////////////////\n/* UAParser.js v1.0.33\n   Copyright Â© 2012-2021 Faisal Salman <f@faisalman.com>\n   MIT License *//*\n   Detect Browser, Engine, OS, CPU, and Device type/model from User-Agent data.\n   Supports browser & node.js environment. \n   Demo   : https://faisalman.github.io/ua-parser-js\n   Source : https://github.com/faisalman/ua-parser-js */\n/////////////////////////////////////////////////////////////////////////////////\n\n(function (window, undefined) {\n\n    'use strict';\n\n    //////////////\n    // Constants\n    /////////////\n\n\n    var LIBVERSION  = '1.0.33',\n        EMPTY       = '',\n        UNKNOWN     = '?',\n        FUNC_TYPE   = 'function',\n        UNDEF_TYPE  = 'undefined',\n        OBJ_TYPE    = 'object',\n        STR_TYPE    = 'string',\n        MAJOR       = 'major',\n        MODEL       = 'model',\n        NAME        = 'name',\n        TYPE        = 'type',\n        VENDOR      = 'vendor',\n        VERSION     = 'version',\n        ARCHITECTURE= 'architecture',\n        CONSOLE     = 'console',\n        MOBILE      = 'mobile',\n        TABLET      = 'tablet',\n        SMARTTV     = 'smarttv',\n        WEARABLE    = 'wearable',\n        EMBEDDED    = 'embedded',\n        UA_MAX_LENGTH = 350;\n\n    var AMAZON  = 'Amazon',\n        APPLE   = 'Apple',\n        ASUS    = 'ASUS',\n        BLACKBERRY = 'BlackBerry',\n        BROWSER = 'Browser',\n        CHROME  = 'Chrome',\n        EDGE    = 'Edge',\n        FIREFOX = 'Firefox',\n        GOOGLE  = 'Google',\n        HUAWEI  = 'Huawei',\n        LG      = 'LG',\n        MICROSOFT = 'Microsoft',\n        MOTOROLA  = 'Motorola',\n        OPERA   = 'Opera',\n        SAMSUNG = 'Samsung',\n        SHARP   = 'Sharp',\n        SONY    = 'Sony',\n        XIAOMI  = 'Xiaomi',\n        ZEBRA   = 'Zebra',\n        FACEBOOK   = 'Facebook';\n\n    ///////////\n    // Helper\n    //////////\n\n    var extend = function (regexes, extensions) {\n            var mergedRegexes = {};\n            for (var i in regexes) {\n                if (extensions[i] && extensions[i].length % 2 === 0) {\n                    mergedRegexes[i] = extensions[i].concat(regexes[i]);\n                } else {\n                    mergedRegexes[i] = regexes[i];\n                }\n            }\n            return mergedRegexes;\n        },\n        enumerize = function (arr) {\n            var enums = {};\n            for (var i=0; i<arr.length; i++) {\n                enums[arr[i].toUpperCase()] = arr[i];\n            }\n            return enums;\n        },\n        has = function (str1, str2) {\n            return typeof str1 === STR_TYPE ? lowerize(str2).indexOf(lowerize(str1)) !== -1 : false;\n        },\n        lowerize = function (str) {\n            return str.toLowerCase();\n        },\n        majorize = function (version) {\n            return typeof(version) === STR_TYPE ? version.replace(/[^\\d\\.]/g, EMPTY).split('.')[0] : undefined;\n        },\n        trim = function (str, len) {\n            if (typeof(str) === STR_TYPE) {\n                str = str.replace(/^\\s\\s*/, EMPTY);\n                return typeof(len) === UNDEF_TYPE ? str : str.substring(0, UA_MAX_LENGTH);\n            }\n    };\n\n    ///////////////\n    // Map helper\n    //////////////\n\n    var rgxMapper = function (ua, arrays) {\n\n            var i = 0, j, k, p, q, matches, match;\n\n            // loop through all regexes maps\n            while (i < arrays.length && !matches) {\n\n                var regex = arrays[i],       // even sequence (0,2,4,..)\n                    props = arrays[i + 1];   // odd sequence (1,3,5,..)\n                j = k = 0;\n\n                // try matching uastring with regexes\n                while (j < regex.length && !matches) {\n\n                    matches = regex[j++].exec(ua);\n\n                    if (!!matches) {\n                        for (p = 0; p < props.length; p++) {\n                            match = matches[++k];\n                            q = props[p];\n                            // check if given property is actually array\n                            if (typeof q === OBJ_TYPE && q.length > 0) {\n                                if (q.length === 2) {\n                                    if (typeof q[1] == FUNC_TYPE) {\n                                        // assign modified match\n                                        this[q[0]] = q[1].call(this, match);\n                                    } else {\n                                        // assign given value, ignore regex match\n                                        this[q[0]] = q[1];\n                                    }\n                                } else if (q.length === 3) {\n                                    // check whether function or regex\n                                    if (typeof q[1] === FUNC_TYPE && !(q[1].exec && q[1].test)) {\n                                        // call function (usually string mapper)\n                                        this[q[0]] = match ? q[1].call(this, match, q[2]) : undefined;\n                                    } else {\n                                        // sanitize match using given regex\n                                        this[q[0]] = match ? match.replace(q[1], q[2]) : undefined;\n                                    }\n                                } else if (q.length === 4) {\n                                        this[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined;\n                                }\n                            } else {\n                                this[q] = match ? match : undefined;\n                            }\n                        }\n                    }\n                }\n                i += 2;\n            }\n        },\n\n        strMapper = function (str, map) {\n\n            for (var i in map) {\n                // check if current value is array\n                if (typeof map[i] === OBJ_TYPE && map[i].length > 0) {\n                    for (var j = 0; j < map[i].length; j++) {\n                        if (has(map[i][j], str)) {\n                            return (i === UNKNOWN) ? undefined : i;\n                        }\n                    }\n                } else if (has(map[i], str)) {\n                    return (i === UNKNOWN) ? undefined : i;\n                }\n            }\n            return str;\n    };\n\n    ///////////////\n    // String map\n    //////////////\n\n    // Safari < 3.0\n    var oldSafariMap = {\n            '1.0'   : '/8',\n            '1.2'   : '/1',\n            '1.3'   : '/3',\n            '2.0'   : '/412',\n            '2.0.2' : '/416',\n            '2.0.3' : '/417',\n            '2.0.4' : '/419',\n            '?'     : '/'\n        },\n        windowsVersionMap = {\n            'ME'        : '4.90',\n            'NT 3.11'   : 'NT3.51',\n            'NT 4.0'    : 'NT4.0',\n            '2000'      : 'NT 5.0',\n            'XP'        : ['NT 5.1', 'NT 5.2'],\n            'Vista'     : 'NT 6.0',\n            '7'         : 'NT 6.1',\n            '8'         : 'NT 6.2',\n            '8.1'       : 'NT 6.3',\n            '10'        : ['NT 6.4', 'NT 10.0'],\n            'RT'        : 'ARM'\n    };\n\n    //////////////\n    // Regex map\n    /////////////\n\n    var regexes = {\n\n        browser : [[\n\n            /\\b(?:crmo|crios)\\/([\\w\\.]+)/i                                      // Chrome for Android/iOS\n            ], [VERSION, [NAME, 'Chrome']], [\n            /edg(?:e|ios|a)?\\/([\\w\\.]+)/i                                       // Microsoft Edge\n            ], [VERSION, [NAME, 'Edge']], [\n\n            // Presto based\n            /(opera mini)\\/([-\\w\\.]+)/i,                                        // Opera Mini\n            /(opera [mobiletab]{3,6})\\b.+version\\/([-\\w\\.]+)/i,                 // Opera Mobi/Tablet\n            /(opera)(?:.+version\\/|[\\/ ]+)([\\w\\.]+)/i                           // Opera\n            ], [NAME, VERSION], [\n            /opios[\\/ ]+([\\w\\.]+)/i                                             // Opera mini on iphone >= 8.0\n            ], [VERSION, [NAME, OPERA+' Mini']], [\n            /\\bopr\\/([\\w\\.]+)/i                                                 // Opera Webkit\n            ], [VERSION, [NAME, OPERA]], [\n\n            // Mixed\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(lunascape|maxthon|netfront|jasmine|blazer)[\\/ ]?([\\w\\.]*)/i,      // Lunascape/Maxthon/Netfront/Jasmine/Blazer\n            // Trident based\n            /(avant |iemobile|slim)(?:browser)?[\\/ ]?([\\w\\.]*)/i,               // Avant/IEMobile/SlimBrowser\n            /(ba?idubrowser)[\\/ ]?([\\w\\.]+)/i,                                  // Baidu Browser\n            /(?:ms|\\()(ie) ([\\w\\.]+)/i,                                         // Internet Explorer\n\n            // Webkit/KHTML based                                               // Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron/Iridium/PhantomJS/Bowser/QupZilla/Falkon\n            /(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\\/([-\\w\\.]+)/i,\n                                                                                // Rekonq/Puffin/Brave/Whale/QQBrowserLite/QQ, aka ShouQ\n            /(weibo)__([\\d\\.]+)/i                                               // Weibo\n            ], [NAME, VERSION], [\n            /(?:\\buc? ?browser|(?:juc.+)ucweb)[\\/ ]?([\\w\\.]+)/i                 // UCBrowser\n            ], [VERSION, [NAME, 'UC'+BROWSER]], [\n            /microm.+\\bqbcore\\/([\\w\\.]+)/i,                                     // WeChat Desktop for Windows Built-in Browser\n            /\\bqbcore\\/([\\w\\.]+).+microm/i\n            ], [VERSION, [NAME, 'WeChat(Win) Desktop']], [\n            /micromessenger\\/([\\w\\.]+)/i                                        // WeChat\n            ], [VERSION, [NAME, 'WeChat']], [\n            /konqueror\\/([\\w\\.]+)/i                                             // Konqueror\n            ], [VERSION, [NAME, 'Konqueror']], [\n            /trident.+rv[: ]([\\w\\.]{1,9})\\b.+like gecko/i                       // IE11\n            ], [VERSION, [NAME, 'IE']], [\n            /yabrowser\\/([\\w\\.]+)/i                                             // Yandex\n            ], [VERSION, [NAME, 'Yandex']], [\n            /(avast|avg)\\/([\\w\\.]+)/i                                           // Avast/AVG Secure Browser\n            ], [[NAME, /(.+)/, '$1 Secure '+BROWSER], VERSION], [\n            /\\bfocus\\/([\\w\\.]+)/i                                               // Firefox Focus\n            ], [VERSION, [NAME, FIREFOX+' Focus']], [\n            /\\bopt\\/([\\w\\.]+)/i                                                 // Opera Touch\n            ], [VERSION, [NAME, OPERA+' Touch']], [\n            /coc_coc\\w+\\/([\\w\\.]+)/i                                            // Coc Coc Browser\n            ], [VERSION, [NAME, 'Coc Coc']], [\n            /dolfin\\/([\\w\\.]+)/i                                                // Dolphin\n            ], [VERSION, [NAME, 'Dolphin']], [\n            /coast\\/([\\w\\.]+)/i                                                 // Opera Coast\n            ], [VERSION, [NAME, OPERA+' Coast']], [\n            /miuibrowser\\/([\\w\\.]+)/i                                           // MIUI Browser\n            ], [VERSION, [NAME, 'MIUI '+BROWSER]], [\n            /fxios\\/([-\\w\\.]+)/i                                                // Firefox for iOS\n            ], [VERSION, [NAME, FIREFOX]], [\n            /\\bqihu|(qi?ho?o?|360)browser/i                                     // 360\n            ], [[NAME, '360 '+BROWSER]], [\n            /(oculus|samsung|sailfish|huawei)browser\\/([\\w\\.]+)/i\n            ], [[NAME, /(.+)/, '$1 '+BROWSER], VERSION], [                      // Oculus/Samsung/Sailfish/Huawei Browser\n            /(comodo_dragon)\\/([\\w\\.]+)/i                                       // Comodo Dragon\n            ], [[NAME, /_/g, ' '], VERSION], [\n            /(electron)\\/([\\w\\.]+) safari/i,                                    // Electron-based App\n            /(tesla)(?: qtcarbrowser|\\/(20\\d\\d\\.[-\\w\\.]+))/i,                   // Tesla\n            /m?(qqbrowser|baiduboxapp|2345Explorer)[\\/ ]?([\\w\\.]+)/i            // QQBrowser/Baidu App/2345 Browser\n            ], [NAME, VERSION], [\n            /(metasr)[\\/ ]?([\\w\\.]+)/i,                                         // SouGouBrowser\n            /(lbbrowser)/i,                                                     // LieBao Browser\n            /\\[(linkedin)app\\]/i                                                // LinkedIn App for iOS & Android\n            ], [NAME], [\n\n            // WebView\n            /((?:fban\\/fbios|fb_iab\\/fb4a)(?!.+fbav)|;fbav\\/([\\w\\.]+);)/i       // Facebook App for iOS & Android\n            ], [[NAME, FACEBOOK], VERSION], [\n            /safari (line)\\/([\\w\\.]+)/i,                                        // Line App for iOS\n            /\\b(line)\\/([\\w\\.]+)\\/iab/i,                                        // Line App for Android\n            /(chromium|instagram)[\\/ ]([-\\w\\.]+)/i                              // Chromium/Instagram\n            ], [NAME, VERSION], [\n            /\\bgsa\\/([\\w\\.]+) .*safari\\//i                                      // Google Search Appliance on iOS\n            ], [VERSION, [NAME, 'GSA']], [\n\n            /headlesschrome(?:\\/([\\w\\.]+)| )/i                                  // Chrome Headless\n            ], [VERSION, [NAME, CHROME+' Headless']], [\n\n            / wv\\).+(chrome)\\/([\\w\\.]+)/i                                       // Chrome WebView\n            ], [[NAME, CHROME+' WebView'], VERSION], [\n\n            /droid.+ version\\/([\\w\\.]+)\\b.+(?:mobile safari|safari)/i           // Android Browser\n            ], [VERSION, [NAME, 'Android '+BROWSER]], [\n\n            /(chrome|omniweb|arora|[tizenoka]{5} ?browser)\\/v?([\\w\\.]+)/i       // Chrome/OmniWeb/Arora/Tizen/Nokia\n            ], [NAME, VERSION], [\n\n            /version\\/([\\w\\.\\,]+) .*mobile\\/\\w+ (safari)/i                      // Mobile Safari\n            ], [VERSION, [NAME, 'Mobile Safari']], [\n            /version\\/([\\w(\\.|\\,)]+) .*(mobile ?safari|safari)/i                // Safari & Safari Mobile\n            ], [VERSION, NAME], [\n            /webkit.+?(mobile ?safari|safari)(\\/[\\w\\.]+)/i                      // Safari < 3.0\n            ], [NAME, [VERSION, strMapper, oldSafariMap]], [\n\n            /(webkit|khtml)\\/([\\w\\.]+)/i\n            ], [NAME, VERSION], [\n\n            // Gecko based\n            /(navigator|netscape\\d?)\\/([-\\w\\.]+)/i                              // Netscape\n            ], [[NAME, 'Netscape'], VERSION], [\n            /mobile vr; rv:([\\w\\.]+)\\).+firefox/i                               // Firefox Reality\n            ], [VERSION, [NAME, FIREFOX+' Reality']], [\n            /ekiohf.+(flow)\\/([\\w\\.]+)/i,                                       // Flow\n            /(swiftfox)/i,                                                      // Swiftfox\n            /(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\\/ ]?([\\w\\.\\+]+)/i,\n                                                                                // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror/Klar\n            /(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\\/([-\\w\\.]+)$/i,\n                                                                                // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix\n            /(firefox)\\/([\\w\\.]+)/i,                                            // Other Firefox-based\n            /(mozilla)\\/([\\w\\.]+) .+rv\\:.+gecko\\/\\d+/i,                         // Mozilla\n\n            // Other\n            /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\\. ]?browser)[-\\/ ]?v?([\\w\\.]+)/i,\n                                                                                // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf/Sleipnir/Obigo/Mosaic/Go/ICE/UP.Browser\n            /(links) \\(([\\w\\.]+)/i                                              // Links\n            ], [NAME, VERSION], [\n            \n            /(cobalt)\\/([\\w\\.]+)/i                                              // Cobalt\n            ], [NAME, [VERSION, /master.|lts./, \"\"]]\n        ],\n\n        cpu : [[\n\n            /(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\\)]/i                     // AMD64 (x64)\n            ], [[ARCHITECTURE, 'amd64']], [\n\n            /(ia32(?=;))/i                                                      // IA32 (quicktime)\n            ], [[ARCHITECTURE, lowerize]], [\n\n            /((?:i[346]|x)86)[;\\)]/i                                            // IA32 (x86)\n            ], [[ARCHITECTURE, 'ia32']], [\n\n            /\\b(aarch64|arm(v?8e?l?|_?64))\\b/i                                 // ARM64\n            ], [[ARCHITECTURE, 'arm64']], [\n\n            /\\b(arm(?:v[67])?ht?n?[fl]p?)\\b/i                                   // ARMHF\n            ], [[ARCHITECTURE, 'armhf']], [\n\n            // PocketPC mistakenly identified as PowerPC\n            /windows (ce|mobile); ppc;/i\n            ], [[ARCHITECTURE, 'arm']], [\n\n            /((?:ppc|powerpc)(?:64)?)(?: mac|;|\\))/i                            // PowerPC\n            ], [[ARCHITECTURE, /ower/, EMPTY, lowerize]], [\n\n            /(sun4\\w)[;\\)]/i                                                    // SPARC\n            ], [[ARCHITECTURE, 'sparc']], [\n\n            /((?:avr32|ia64(?=;))|68k(?=\\))|\\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\\b|pa-risc)/i\n                                                                                // IA64, 68K, ARM/64, AVR/32, IRIX/64, MIPS/64, SPARC/64, PA-RISC\n            ], [[ARCHITECTURE, lowerize]]\n        ],\n\n        device : [[\n\n            //////////////////////////\n            // MOBILES & TABLETS\n            // Ordered by popularity\n            /////////////////////////\n\n            // Samsung\n            /\\b(sch-i[89]0\\d|shw-m380s|sm-[ptx]\\w{2,4}|gt-[pn]\\d{2,4}|sgh-t8[56]9|nexus 10)/i\n            ], [MODEL, [VENDOR, SAMSUNG], [TYPE, TABLET]], [\n            /\\b((?:s[cgp]h|gt|sm)-\\w+|galaxy nexus)/i,\n            /samsung[- ]([-\\w]+)/i,\n            /sec-(sgh\\w+)/i\n            ], [MODEL, [VENDOR, SAMSUNG], [TYPE, MOBILE]], [\n\n            // Apple\n            /\\((ip(?:hone|od)[\\w ]*);/i                                         // iPod/iPhone\n            ], [MODEL, [VENDOR, APPLE], [TYPE, MOBILE]], [\n            /\\((ipad);[-\\w\\),; ]+apple/i,                                       // iPad\n            /applecoremedia\\/[\\w\\.]+ \\((ipad)/i,\n            /\\b(ipad)\\d\\d?,\\d\\d?[;\\]].+ios/i\n            ], [MODEL, [VENDOR, APPLE], [TYPE, TABLET]], [\n            /(macintosh);/i\n            ], [MODEL, [VENDOR, APPLE]], [\n\n            // Huawei\n            /\\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\\d{2})\\b(?!.+d\\/s)/i\n            ], [MODEL, [VENDOR, HUAWEI], [TYPE, TABLET]], [\n            /(?:huawei|honor)([-\\w ]+)[;\\)]/i,\n            /\\b(nexus 6p|\\w{2,4}e?-[atu]?[ln][\\dx][012359c][adn]?)\\b(?!.+d\\/s)/i\n            ], [MODEL, [VENDOR, HUAWEI], [TYPE, MOBILE]], [\n\n            // Xiaomi\n            /\\b(poco[\\w ]+)(?: bui|\\))/i,                                       // Xiaomi POCO\n            /\\b; (\\w+) build\\/hm\\1/i,                                           // Xiaomi Hongmi 'numeric' models\n            /\\b(hm[-_ ]?note?[_ ]?(?:\\d\\w)?) bui/i,                             // Xiaomi Hongmi\n            /\\b(redmi[\\-_ ]?(?:note|k)?[\\w_ ]+)(?: bui|\\))/i,                   // Xiaomi Redmi\n            /\\b(mi[-_ ]?(?:a\\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\\d?\\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\\))/i // Xiaomi Mi\n            ], [[MODEL, /_/g, ' '], [VENDOR, XIAOMI], [TYPE, MOBILE]], [\n            /\\b(mi[-_ ]?(?:pad)(?:[\\w_ ]+))(?: bui|\\))/i                        // Mi Pad tablets\n            ],[[MODEL, /_/g, ' '], [VENDOR, XIAOMI], [TYPE, TABLET]], [\n\n            // OPPO\n            /; (\\w+) bui.+ oppo/i,\n            /\\b(cph[12]\\d{3}|p(?:af|c[al]|d\\w|e[ar])[mt]\\d0|x9007|a101op)\\b/i\n            ], [MODEL, [VENDOR, 'OPPO'], [TYPE, MOBILE]], [\n\n            // Vivo\n            /vivo (\\w+)(?: bui|\\))/i,\n            /\\b(v[12]\\d{3}\\w?[at])(?: bui|;)/i\n            ], [MODEL, [VENDOR, 'Vivo'], [TYPE, MOBILE]], [\n\n            // Realme\n            /\\b(rmx[12]\\d{3})(?: bui|;|\\))/i\n            ], [MODEL, [VENDOR, 'Realme'], [TYPE, MOBILE]], [\n\n            // Motorola\n            /\\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\\b[\\w ]+build\\//i,\n            /\\bmot(?:orola)?[- ](\\w*)/i,\n            /((?:moto[\\w\\(\\) ]+|xt\\d{3,4}|nexus 6)(?= bui|\\)))/i\n            ], [MODEL, [VENDOR, MOTOROLA], [TYPE, MOBILE]], [\n            /\\b(mz60\\d|xoom[2 ]{0,2}) build\\//i\n            ], [MODEL, [VENDOR, MOTOROLA], [TYPE, TABLET]], [\n\n            // LG\n            /((?=lg)?[vl]k\\-?\\d{3}) bui| 3\\.[-\\w; ]{10}lg?-([06cv9]{3,4})/i\n            ], [MODEL, [VENDOR, LG], [TYPE, TABLET]], [\n            /(lm(?:-?f100[nv]?|-[\\w\\.]+)(?= bui|\\))|nexus [45])/i,\n            /\\blg[-e;\\/ ]+((?!browser|netcast|android tv)\\w+)/i,\n            /\\blg-?([\\d\\w]+) bui/i\n            ], [MODEL, [VENDOR, LG], [TYPE, MOBILE]], [\n\n            // Lenovo\n            /(ideatab[-\\w ]+)/i,\n            /lenovo ?(s[56]000[-\\w]+|tab(?:[\\w ]+)|yt[-\\d\\w]{6}|tb[-\\d\\w]{6})/i\n            ], [MODEL, [VENDOR, 'Lenovo'], [TYPE, TABLET]], [\n\n            // Nokia\n            /(?:maemo|nokia).*(n900|lumia \\d+)/i,\n            /nokia[-_ ]?([-\\w\\.]*)/i\n            ], [[MODEL, /_/g, ' '], [VENDOR, 'Nokia'], [TYPE, MOBILE]], [\n\n            // Google\n            /(pixel c)\\b/i                                                      // Google Pixel C\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, TABLET]], [\n            /droid.+; (pixel[\\daxl ]{0,6})(?: bui|\\))/i                         // Google Pixel\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, MOBILE]], [\n\n            // Sony\n            /droid.+ (a?\\d[0-2]{2}so|[c-g]\\d{4}|so[-gl]\\w+|xq-a\\w[4-7][12])(?= bui|\\).+chrome\\/(?![1-6]{0,1}\\d\\.))/i\n            ], [MODEL, [VENDOR, SONY], [TYPE, MOBILE]], [\n            /sony tablet [ps]/i,\n            /\\b(?:sony)?sgp\\w+(?: bui|\\))/i\n            ], [[MODEL, 'Xperia Tablet'], [VENDOR, SONY], [TYPE, TABLET]], [\n\n            // OnePlus\n            / (kb2005|in20[12]5|be20[12][59])\\b/i,\n            /(?:one)?(?:plus)? (a\\d0\\d\\d)(?: b|\\))/i\n            ], [MODEL, [VENDOR, 'OnePlus'], [TYPE, MOBILE]], [\n\n            // Amazon\n            /(alexa)webm/i,\n            /(kf[a-z]{2}wi)( bui|\\))/i,                                         // Kindle Fire without Silk\n            /(kf[a-z]+)( bui|\\)).+silk\\//i                                      // Kindle Fire HD\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, TABLET]], [\n            /((?:sd|kf)[0349hijorstuw]+)( bui|\\)).+silk\\//i                     // Fire Phone\n            ], [[MODEL, /(.+)/g, 'Fire Phone $1'], [VENDOR, AMAZON], [TYPE, MOBILE]], [\n\n            // BlackBerry\n            /(playbook);[-\\w\\),; ]+(rim)/i                                      // BlackBerry PlayBook\n            ], [MODEL, VENDOR, [TYPE, TABLET]], [\n            /\\b((?:bb[a-f]|st[hv])100-\\d)/i,\n            /\\(bb10; (\\w+)/i                                                    // BlackBerry 10\n            ], [MODEL, [VENDOR, BLACKBERRY], [TYPE, MOBILE]], [\n\n            // Asus\n            /(?:\\b|asus_)(transfo[prime ]{4,10} \\w+|eeepc|slider \\w+|nexus 7|padfone|p00[cj])/i\n            ], [MODEL, [VENDOR, ASUS], [TYPE, TABLET]], [\n            / (z[bes]6[027][012][km][ls]|zenfone \\d\\w?)\\b/i\n            ], [MODEL, [VENDOR, ASUS], [TYPE, MOBILE]], [\n\n            // HTC\n            /(nexus 9)/i                                                        // HTC Nexus 9\n            ], [MODEL, [VENDOR, 'HTC'], [TYPE, TABLET]], [\n            /(htc)[-;_ ]{1,2}([\\w ]+(?=\\)| bui)|\\w+)/i,                         // HTC\n\n            // ZTE\n            /(zte)[- ]([\\w ]+?)(?: bui|\\/|\\))/i,\n            /(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\\w]*)/i         // Alcatel/GeeksPhone/Nexian/Panasonic/Sony\n            ], [VENDOR, [MODEL, /_/g, ' '], [TYPE, MOBILE]], [\n\n            // Acer\n            /droid.+; ([ab][1-7]-?[0178a]\\d\\d?)/i\n            ], [MODEL, [VENDOR, 'Acer'], [TYPE, TABLET]], [\n\n            // Meizu\n            /droid.+; (m[1-5] note) bui/i,\n            /\\bmz-([-\\w]{2,})/i\n            ], [MODEL, [VENDOR, 'Meizu'], [TYPE, MOBILE]], [\n\n            // Sharp\n            /\\b(sh-?[altvz]?\\d\\d[a-ekm]?)/i\n            ], [MODEL, [VENDOR, SHARP], [TYPE, MOBILE]], [\n\n            // MIXED\n            /(blackberry|benq|palm(?=\\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\\w]*)/i,\n                                                                                // BlackBerry/BenQ/Palm/Sony-Ericsson/Acer/Asus/Dell/Meizu/Motorola/Polytron\n            /(hp) ([\\w ]+\\w)/i,                                                 // HP iPAQ\n            /(asus)-?(\\w+)/i,                                                   // Asus\n            /(microsoft); (lumia[\\w ]+)/i,                                      // Microsoft Lumia\n            /(lenovo)[-_ ]?([-\\w]+)/i,                                          // Lenovo\n            /(jolla)/i,                                                         // Jolla\n            /(oppo) ?([\\w ]+) bui/i                                             // OPPO\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n\n            /(archos) (gamepad2?)/i,                                            // Archos\n            /(hp).+(touchpad(?!.+tablet)|tablet)/i,                             // HP TouchPad\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(nook)[\\w ]+build\\/(\\w+)/i,                                        // Nook\n            /(dell) (strea[kpr\\d ]*[\\dko])/i,                                   // Dell Streak\n            /(le[- ]+pan)[- ]+(\\w{1,9}) bui/i,                                  // Le Pan Tablets\n            /(trinity)[- ]*(t\\d{3}) bui/i,                                      // Trinity Tablets\n            /(gigaset)[- ]+(q\\w{1,9}) bui/i,                                    // Gigaset Tablets\n            /(vodafone) ([\\w ]+)(?:\\)| bui)/i                                   // Vodafone\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /(surface duo)/i                                                    // Surface Duo\n            ], [MODEL, [VENDOR, MICROSOFT], [TYPE, TABLET]], [\n            /droid [\\d\\.]+; (fp\\du?)(?: b|\\))/i                                 // Fairphone\n            ], [MODEL, [VENDOR, 'Fairphone'], [TYPE, MOBILE]], [\n            /(u304aa)/i                                                         // AT&T\n            ], [MODEL, [VENDOR, 'AT&T'], [TYPE, MOBILE]], [\n            /\\bsie-(\\w*)/i                                                      // Siemens\n            ], [MODEL, [VENDOR, 'Siemens'], [TYPE, MOBILE]], [\n            /\\b(rct\\w+) b/i                                                     // RCA Tablets\n            ], [MODEL, [VENDOR, 'RCA'], [TYPE, TABLET]], [\n            /\\b(venue[\\d ]{2,7}) b/i                                            // Dell Venue Tablets\n            ], [MODEL, [VENDOR, 'Dell'], [TYPE, TABLET]], [\n            /\\b(q(?:mv|ta)\\w+) b/i                                              // Verizon Tablet\n            ], [MODEL, [VENDOR, 'Verizon'], [TYPE, TABLET]], [\n            /\\b(?:barnes[& ]+noble |bn[rt])([\\w\\+ ]*) b/i                       // Barnes & Noble Tablet\n            ], [MODEL, [VENDOR, 'Barnes & Noble'], [TYPE, TABLET]], [\n            /\\b(tm\\d{3}\\w+) b/i\n            ], [MODEL, [VENDOR, 'NuVision'], [TYPE, TABLET]], [\n            /\\b(k88) b/i                                                        // ZTE K Series Tablet\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, TABLET]], [\n            /\\b(nx\\d{3}j) b/i                                                   // ZTE Nubia\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, MOBILE]], [\n            /\\b(gen\\d{3}) b.+49h/i                                              // Swiss GEN Mobile\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, MOBILE]], [\n            /\\b(zur\\d{3}) b/i                                                   // Swiss ZUR Tablet\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, TABLET]], [\n            /\\b((zeki)?tb.*\\b) b/i                                              // Zeki Tablets\n            ], [MODEL, [VENDOR, 'Zeki'], [TYPE, TABLET]], [\n            /\\b([yr]\\d{2}) b/i,\n            /\\b(dragon[- ]+touch |dt)(\\w{5}) b/i                                // Dragon Touch Tablet\n            ], [[VENDOR, 'Dragon Touch'], MODEL, [TYPE, TABLET]], [\n            /\\b(ns-?\\w{0,9}) b/i                                                // Insignia Tablets\n            ], [MODEL, [VENDOR, 'Insignia'], [TYPE, TABLET]], [\n            /\\b((nxa|next)-?\\w{0,9}) b/i                                        // NextBook Tablets\n            ], [MODEL, [VENDOR, 'NextBook'], [TYPE, TABLET]], [\n            /\\b(xtreme\\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i                  // Voice Xtreme Phones\n            ], [[VENDOR, 'Voice'], MODEL, [TYPE, MOBILE]], [\n            /\\b(lvtel\\-)?(v1[12]) b/i                                           // LvTel Phones\n            ], [[VENDOR, 'LvTel'], MODEL, [TYPE, MOBILE]], [\n            /\\b(ph-1) /i                                                        // Essential PH-1\n            ], [MODEL, [VENDOR, 'Essential'], [TYPE, MOBILE]], [\n            /\\b(v(100md|700na|7011|917g).*\\b) b/i                               // Envizen Tablets\n            ], [MODEL, [VENDOR, 'Envizen'], [TYPE, TABLET]], [\n            /\\b(trio[-\\w\\. ]+) b/i                                              // MachSpeed Tablets\n            ], [MODEL, [VENDOR, 'MachSpeed'], [TYPE, TABLET]], [\n            /\\btu_(1491) b/i                                                    // Rotor Tablets\n            ], [MODEL, [VENDOR, 'Rotor'], [TYPE, TABLET]], [\n            /(shield[\\w ]+) b/i                                                 // Nvidia Shield Tablets\n            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, TABLET]], [\n            /(sprint) (\\w+)/i                                                   // Sprint Phones\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n            /(kin\\.[onetw]{3})/i                                                // Microsoft Kin\n            ], [[MODEL, /\\./g, ' '], [VENDOR, MICROSOFT], [TYPE, MOBILE]], [\n            /droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\\)/i             // Zebra\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, TABLET]], [\n            /droid.+; (ec30|ps20|tc[2-8]\\d[kx])\\)/i\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, MOBILE]], [\n\n            ///////////////////\n            // CONSOLES\n            ///////////////////\n\n            /(ouya)/i,                                                          // Ouya\n            /(nintendo) ([wids3utch]+)/i                                        // Nintendo\n            ], [VENDOR, MODEL, [TYPE, CONSOLE]], [\n            /droid.+; (shield) bui/i                                            // Nvidia\n            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, CONSOLE]], [\n            /(playstation [345portablevi]+)/i                                   // Playstation\n            ], [MODEL, [VENDOR, SONY], [TYPE, CONSOLE]], [\n            /\\b(xbox(?: one)?(?!; xbox))[\\); ]/i                                // Microsoft Xbox\n            ], [MODEL, [VENDOR, MICROSOFT], [TYPE, CONSOLE]], [\n\n            ///////////////////\n            // SMARTTVS\n            ///////////////////\n\n            /smart-tv.+(samsung)/i                                              // Samsung\n            ], [VENDOR, [TYPE, SMARTTV]], [\n            /hbbtv.+maple;(\\d+)/i\n            ], [[MODEL, /^/, 'SmartTV'], [VENDOR, SAMSUNG], [TYPE, SMARTTV]], [\n            /(nux; netcast.+smarttv|lg (netcast\\.tv-201\\d|android tv))/i        // LG SmartTV\n            ], [[VENDOR, LG], [TYPE, SMARTTV]], [\n            /(apple) ?tv/i                                                      // Apple TV\n            ], [VENDOR, [MODEL, APPLE+' TV'], [TYPE, SMARTTV]], [\n            /crkey/i                                                            // Google Chromecast\n            ], [[MODEL, CHROME+'cast'], [VENDOR, GOOGLE], [TYPE, SMARTTV]], [\n            /droid.+aft(\\w)( bui|\\))/i                                          // Fire TV\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, SMARTTV]], [\n            /\\(dtv[\\);].+(aquos)/i,\n            /(aquos-tv[\\w ]+)\\)/i                                               // Sharp\n            ], [MODEL, [VENDOR, SHARP], [TYPE, SMARTTV]],[\n            /(bravia[\\w ]+)( bui|\\))/i                                              // Sony\n            ], [MODEL, [VENDOR, SONY], [TYPE, SMARTTV]], [\n            /(mitv-\\w{5}) bui/i                                                 // Xiaomi\n            ], [MODEL, [VENDOR, XIAOMI], [TYPE, SMARTTV]], [\n            /\\b(roku)[\\dx]*[\\)\\/]((?:dvp-)?[\\d\\.]*)/i,                          // Roku\n            /hbbtv\\/\\d+\\.\\d+\\.\\d+ +\\([\\w ]*; *(\\w[^;]*);([^;]*)/i               // HbbTV devices\n            ], [[VENDOR, trim], [MODEL, trim], [TYPE, SMARTTV]], [\n            /\\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\\b/i                   // SmartTV from Unidentified Vendors\n            ], [[TYPE, SMARTTV]], [\n\n            ///////////////////\n            // WEARABLES\n            ///////////////////\n\n            /((pebble))app/i                                                    // Pebble\n            ], [VENDOR, MODEL, [TYPE, WEARABLE]], [\n            /droid.+; (glass) \\d/i                                              // Google Glass\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, WEARABLE]], [\n            /droid.+; (wt63?0{2,3})\\)/i\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, WEARABLE]], [\n            /(quest( 2)?)/i                                                     // Oculus Quest\n            ], [MODEL, [VENDOR, FACEBOOK], [TYPE, WEARABLE]], [\n\n            ///////////////////\n            // EMBEDDED\n            ///////////////////\n\n            /(tesla)(?: qtcarbrowser|\\/[-\\w\\.]+)/i                              // Tesla\n            ], [VENDOR, [TYPE, EMBEDDED]], [\n\n            ////////////////////\n            // MIXED (GENERIC)\n            ///////////////////\n\n            /droid .+?; ([^;]+?)(?: bui|\\) applew).+? mobile safari/i           // Android Phones from Unidentified Vendors\n            ], [MODEL, [TYPE, MOBILE]], [\n            /droid .+?; ([^;]+?)(?: bui|\\) applew).+?(?! mobile) safari/i       // Android Tablets from Unidentified Vendors\n            ], [MODEL, [TYPE, TABLET]], [\n            /\\b((tablet|tab)[;\\/]|focus\\/\\d(?!.+mobile))/i                      // Unidentifiable Tablet\n            ], [[TYPE, TABLET]], [\n            /(phone|mobile(?:[;\\/]| [ \\w\\/\\.]*safari)|pda(?=.+windows ce))/i    // Unidentifiable Mobile\n            ], [[TYPE, MOBILE]], [\n            /(android[-\\w\\. ]{0,9});.+buil/i                                    // Generic Android Device\n            ], [MODEL, [VENDOR, 'Generic']]\n        ],\n\n        engine : [[\n\n            /windows.+ edge\\/([\\w\\.]+)/i                                       // EdgeHTML\n            ], [VERSION, [NAME, EDGE+'HTML']], [\n\n            /webkit\\/537\\.36.+chrome\\/(?!27)([\\w\\.]+)/i                         // Blink\n            ], [VERSION, [NAME, 'Blink']], [\n\n            /(presto)\\/([\\w\\.]+)/i,                                             // Presto\n            /(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\\/([\\w\\.]+)/i, // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m/Goanna\n            /ekioh(flow)\\/([\\w\\.]+)/i,                                          // Flow\n            /(khtml|tasman|links)[\\/ ]\\(?([\\w\\.]+)/i,                           // KHTML/Tasman/Links\n            /(icab)[\\/ ]([23]\\.[\\d\\.]+)/i                                       // iCab\n            ], [NAME, VERSION], [\n\n            /rv\\:([\\w\\.]{1,9})\\b.+(gecko)/i                                     // Gecko\n            ], [VERSION, NAME]\n        ],\n\n        os : [[\n\n            // Windows\n            /microsoft (windows) (vista|xp)/i                                   // Windows (iTunes)\n            ], [NAME, VERSION], [\n            /(windows) nt 6\\.2; (arm)/i,                                        // Windows RT\n            /(windows (?:phone(?: os)?|mobile))[\\/ ]?([\\d\\.\\w ]*)/i,            // Windows Phone\n            /(windows)[\\/ ]?([ntce\\d\\. ]+\\w)(?!.+xbox)/i\n            ], [NAME, [VERSION, strMapper, windowsVersionMap]], [\n            /(win(?=3|9|n)|win 9x )([nt\\d\\.]+)/i\n            ], [[NAME, 'Windows'], [VERSION, strMapper, windowsVersionMap]], [\n\n            // iOS/macOS\n            /ip[honead]{2,4}\\b(?:.*os ([\\w]+) like mac|; opera)/i,              // iOS\n            /cfnetwork\\/.+darwin/i\n            ], [[VERSION, /_/g, '.'], [NAME, 'iOS']], [\n            /(mac os x) ?([\\w\\. ]*)/i,\n            /(macintosh|mac_powerpc\\b)(?!.+haiku)/i                             // Mac OS\n            ], [[NAME, 'Mac OS'], [VERSION, /_/g, '.']], [\n\n            // Mobile OSes\n            /droid ([\\w\\.]+)\\b.+(android[- ]x86|harmonyos)/i                    // Android-x86/HarmonyOS\n            ], [VERSION, NAME], [                                               // Android/WebOS/QNX/Bada/RIM/Maemo/MeeGo/Sailfish OS\n            /(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\\/ ]?([\\w\\.]*)/i,\n            /(blackberry)\\w*\\/([\\w\\.]*)/i,                                      // Blackberry\n            /(tizen|kaios)[\\/ ]([\\w\\.]+)/i,                                     // Tizen/KaiOS\n            /\\((series40);/i                                                    // Series 40\n            ], [NAME, VERSION], [\n            /\\(bb(10);/i                                                        // BlackBerry 10\n            ], [VERSION, [NAME, BLACKBERRY]], [\n            /(?:symbian ?os|symbos|s60(?=;)|series60)[-\\/ ]?([\\w\\.]*)/i         // Symbian\n            ], [VERSION, [NAME, 'Symbian']], [\n            /mozilla\\/[\\d\\.]+ \\((?:mobile|tablet|tv|mobile; [\\w ]+); rv:.+ gecko\\/([\\w\\.]+)/i // Firefox OS\n            ], [VERSION, [NAME, FIREFOX+' OS']], [\n            /web0s;.+rt(tv)/i,\n            /\\b(?:hp)?wos(?:browser)?\\/([\\w\\.]+)/i                              // WebOS\n            ], [VERSION, [NAME, 'webOS']], [\n\n            // Google Chromecast\n            /crkey\\/([\\d\\.]+)/i                                                 // Google Chromecast\n            ], [VERSION, [NAME, CHROME+'cast']], [\n            /(cros) [\\w]+ ([\\w\\.]+\\w)/i                                         // Chromium OS\n            ], [[NAME, 'Chromium OS'], VERSION],[\n\n            // Console\n            /(nintendo|playstation) ([wids345portablevuch]+)/i,                 // Nintendo/Playstation\n            /(xbox); +xbox ([^\\);]+)/i,                                         // Microsoft Xbox (360, One, X, S, Series X, Series S)\n\n            // Other\n            /\\b(joli|palm)\\b ?(?:os)?\\/?([\\w\\.]*)/i,                            // Joli/Palm\n            /(mint)[\\/\\(\\) ]?(\\w*)/i,                                           // Mint\n            /(mageia|vectorlinux)[; ]/i,                                        // Mageia/VectorLinux\n            /([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\\/ ]?(?!chrom|package)([-\\w\\.]*)/i,\n                                                                                // Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware/Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus/Raspbian/Plan9/Minix/RISCOS/Contiki/Deepin/Manjaro/elementary/Sabayon/Linspire\n            /(hurd|linux) ?([\\w\\.]*)/i,                                         // Hurd/Linux\n            /(gnu) ?([\\w\\.]*)/i,                                                // GNU\n            /\\b([-frentopcghs]{0,5}bsd|dragonfly)[\\/ ]?(?!amd|[ix346]{1,2}86)([\\w\\.]*)/i, // FreeBSD/NetBSD/OpenBSD/PC-BSD/GhostBSD/DragonFly\n            /(haiku) (\\w+)/i                                                    // Haiku\n            ], [NAME, VERSION], [\n            /(sunos) ?([\\w\\.\\d]*)/i                                             // Solaris\n            ], [[NAME, 'Solaris'], VERSION], [\n            /((?:open)?solaris)[-\\/ ]?([\\w\\.]*)/i,                              // Solaris\n            /(aix) ((\\d)(?=\\.|\\)| )[\\w\\.])*/i,                                  // AIX\n            /\\b(beos|os\\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,            // BeOS/OS2/AmigaOS/MorphOS/OpenVMS/Fuchsia/HP-UX\n            /(unix) ?([\\w\\.]*)/i                                                // UNIX\n            ], [NAME, VERSION]\n        ]\n    };\n\n    /////////////////\n    // Constructor\n    ////////////////\n\n    var UAParser = function (ua, extensions) {\n\n        if (typeof ua === OBJ_TYPE) {\n            extensions = ua;\n            ua = undefined;\n        }\n\n        if (!(this instanceof UAParser)) {\n            return new UAParser(ua, extensions).getResult();\n        }\n\n        var _ua = ua || ((typeof window !== UNDEF_TYPE && window.navigator && window.navigator.userAgent) ? window.navigator.userAgent : EMPTY);\n        var _rgxmap = extensions ? extend(regexes, extensions) : regexes;\n\n        this.getBrowser = function () {\n            var _browser = {};\n            _browser[NAME] = undefined;\n            _browser[VERSION] = undefined;\n            rgxMapper.call(_browser, _ua, _rgxmap.browser);\n            _browser.major = majorize(_browser.version);\n            return _browser;\n        };\n        this.getCPU = function () {\n            var _cpu = {};\n            _cpu[ARCHITECTURE] = undefined;\n            rgxMapper.call(_cpu, _ua, _rgxmap.cpu);\n            return _cpu;\n        };\n        this.getDevice = function () {\n            var _device = {};\n            _device[VENDOR] = undefined;\n            _device[MODEL] = undefined;\n            _device[TYPE] = undefined;\n            rgxMapper.call(_device, _ua, _rgxmap.device);\n            return _device;\n        };\n        this.getEngine = function () {\n            var _engine = {};\n            _engine[NAME] = undefined;\n            _engine[VERSION] = undefined;\n            rgxMapper.call(_engine, _ua, _rgxmap.engine);\n            return _engine;\n        };\n        this.getOS = function () {\n            var _os = {};\n            _os[NAME] = undefined;\n            _os[VERSION] = undefined;\n            rgxMapper.call(_os, _ua, _rgxmap.os);\n            return _os;\n        };\n        this.getResult = function () {\n            return {\n                ua      : this.getUA(),\n                browser : this.getBrowser(),\n                engine  : this.getEngine(),\n                os      : this.getOS(),\n                device  : this.getDevice(),\n                cpu     : this.getCPU()\n            };\n        };\n        this.getUA = function () {\n            return _ua;\n        };\n        this.setUA = function (ua) {\n            _ua = (typeof ua === STR_TYPE && ua.length > UA_MAX_LENGTH) ? trim(ua, UA_MAX_LENGTH) : ua;\n            return this;\n        };\n        this.setUA(_ua);\n        return this;\n    };\n\n    UAParser.VERSION = LIBVERSION;\n    UAParser.BROWSER =  enumerize([NAME, VERSION, MAJOR]);\n    UAParser.CPU = enumerize([ARCHITECTURE]);\n    UAParser.DEVICE = enumerize([MODEL, VENDOR, TYPE, CONSOLE, MOBILE, SMARTTV, TABLET, WEARABLE, EMBEDDED]);\n    UAParser.ENGINE = UAParser.OS = enumerize([NAME, VERSION]);\n\n    ///////////\n    // Export\n    //////////\n\n    // check js environment\n    if (typeof(exports) !== UNDEF_TYPE) {\n        // nodejs env\n        if (typeof module !== UNDEF_TYPE && module.exports) {\n            exports = module.exports = UAParser;\n        }\n        exports.UAParser = UAParser;\n    } else {\n        // requirejs env (optional)\n        if (typeof(define) === FUNC_TYPE && define.amd) {\n            define(function () {\n                return UAParser;\n            });\n        } else if (typeof window !== UNDEF_TYPE) {\n            // browser env\n            window.UAParser = UAParser;\n        }\n    }\n\n    // jQuery/Zepto specific (optional)\n    // Note:\n    //   In AMD env the global scope should be kept clean, but jQuery is an exception.\n    //   jQuery always exports to global scope, unless jQuery.noConflict(true) is used,\n    //   and we should catch that.\n    var $ = typeof window !== UNDEF_TYPE && (window.jQuery || window.Zepto);\n    if ($ && !$.ua) {\n        var parser = new UAParser();\n        $.ua = parser.getResult();\n        $.ua.get = function () {\n            return parser.getUA();\n        };\n        $.ua.set = function (ua) {\n            parser.setUA(ua);\n            var result = parser.getResult();\n            for (var prop in result) {\n                $.ua[prop] = result[prop];\n            }\n        };\n    }\n\n})(typeof window === 'object' ? window : this);\n","export * from './Passage';\nexport * from './PassageError';\nexport * from './CaptureEvent';\nexport * from './User';\nexport * from './Session';\nexport * from './TokenStore';\nexport * from './types/PassageApp';\nexport * from './types/PassageMagicLinkRequest';\nexport * from './types/PassageUser';\nexport * from './types/PassageUserInfo';\nexport * from './types/PassageDevice';\nexport * from './types/PassageEditDeviceRequest';\nexport * from './types/PassageUser';\n\nexport { BrowserInfo } from './BrowserHelper';\n","import Register from './Register';\nimport Login from './Login';\nimport UnAuth from './UnauthInfo';\nimport MagicLink from './MagicLink';\nimport { PassageAppInfo } from './types/PassageApp';\nimport { CreateUserPayload, PassageUser } from './types/PassageUser';\nimport { PassageMagicLinkRequest } from './types/PassageMagicLinkRequest';\nimport { User } from './User';\nimport { handleResponse } from './utils/HandleResponse';\nimport { asyncCallWithTimeout } from './utils/asyncCallWithTimout';\nimport BrowserHelper, { BrowserInfo } from './BrowserHelper';\nimport { getHeaders } from './utils/GetHeaders';\nimport { Session } from './Session';\nimport { PassageTokenStore, ReadOnlyTokenStore, TokenStore } from './TokenStore';\nimport { PassageConfig } from './types/PassageConfig';\nimport { getBaseURL } from './utils/getBaseURL';\nimport AuthTokenHelper from './AuthTokenHelper';\n\nexport interface authResult {\n    redirect_url: string;\n    auth_token: string;\n    refresh_token?: string;\n}\n\n/**\n * The Passage class used to perform register and login operations.\n * The only parameter is the app handle for the application.\n *\n * @example\n * ```\n * import Passage from '@passageidentity/passage-js';\n * const passage = new Passage(app_id);\n * ```\n */\nexport class Passage {\n    fullUrl: string;\n    private tokenStore: TokenStore | ReadOnlyTokenStore;\n\n    /**\n     * Constructor configuring the Passage class' attributes\n     * @param {string} appID the App's corresponding AppID\n     * @param {PassageConfig | undefined} config An optional parameter to pass in a configurable properties.\n     * The tokenStore property is an object that implementes ReadOnlyTokenStore or TokenStore to manage retrieval and storage of tokens.\n     * If no tokenStore is provided by default Passage will store tokens in a combination of localstorage and cookies.\n     */\n    constructor(private appID: string, config?: PassageConfig) {\n        this.fullUrl = getBaseURL(this.appID);\n        if (config?.tokenStore === undefined) {\n            this.tokenStore = new PassageTokenStore();\n        } else {\n            this.tokenStore = config.tokenStore;\n        }\n    }\n\n    /**\n     * Check to see if the credentialID exists in localStorage via\n     * the key psg_cred_obj.\n     * @param {string} userID the Passage User's userID\n     * @return {boolean} returns true if psg_cred_obj exists in localstorage, false if not\n     */\n    credIDExists(userID: string): boolean {\n        const psgCredObj = new AuthTokenHelper().getPsgCredObj();\n\n        if (!psgCredObj) return false;\n        const psgCredID = JSON.parse(psgCredObj)[userID];\n        if (psgCredID) return true;\n        return false;\n    }\n\n    /**\n     * Passage will attempt a webauthn register for the new user, which will return a webauthn challenge.\n     * Webauthn register is a two step process to create a credential. Successful response is a JSON object with the redirect URL.\n     *\n     * @param {string} identifier email address / phone for user\n     * @return {Promise<authResult>} a data object that includes a redirect URL and sets the `psg_auth_token` in local storage.\n     *\n     * @example\n     * ```javascript\n     * import Passage from '@passageidentity/passage-js';\n     *\n     * const passage = new Passage(app_id);\n     * const identifier = document.getElementById(<\"email\" | \"phone\">).value;\n     *\n     * await passage.register(identifier)\n     *   .then(res => {\n     *       // on succes, redirect. auth token set in local storage\n     *       location.href(res.redirectURL);\n     *   })\n     *   .catch(e => console.log(e));\n     * ```\n     */\n    async register(identifier: string): Promise<authResult> {\n        const signUp = new Register(this.fullUrl, this.tokenStore, identifier);\n        return await signUp.withWebAuthn();\n    }\n\n    /**\n     * Passage will attempt a webauthn login for an existing user, which will return a webauthn challenge.\n     * Webauthn login is a two step process to retrieve and verify the credential.\n     *\n     * @param {string} identifier email address / phone for user\n     * @return {Promise<authResult>} a data object that includes a redirect URL and sets the `psg_auth_token` in local storage.\n     *\n     * @example\n     * ```javascript\n     * import Passage from '@passageidentity/passage-js';\n     *\n     * const passage = new Passage(app_id);\n     * const identifier = document.getElementById(<\"email\" | \"phone\">).value;\n     *\n     * await passage.login(identifier)\n     *   .then(res => {\n     *       // on succes, redirect. auth token set in local storage\n     *       location.href(res.redirectURL);\n     *   })\n     *   .catch(e => console.log(e));\n     * ```\n     */\n    async login(identifier: string): Promise<authResult> {\n        const login = new Login(this.fullUrl, this.tokenStore, identifier);\n        return await login.withWebAuthn();\n    }\n\n    /**\n     * Get information about an app.\n     *\n     * @return {Promise<PassageAppInfo>} a data object containing app information and the authentication policy\n     *\n     * @example\n     * ```javascript\n     * import Passage from '@passageidentity/passage-js';\n     *\n     * const passage = new Passage(app_id);\n     *\n     * await passage.appInfo\n     *  .then(data => {\n     *      // look at information regarding a particular app\n     *  }).catch(e => console.log(e));\n     * ```\n     */\n    async appInfo(): Promise<PassageAppInfo> {\n        const unAuth = new UnAuth(this.fullUrl);\n        return await unAuth.appInfo();\n    }\n\n    /** Get webauthn-related information about the current browser.\n     * @return {Promise<BrowserInfo>} a data object containing information about what webauthn operations are supported on the browser.\n     */\n    async browserInfo(): Promise<BrowserInfo> {\n        return await new BrowserHelper().getBrowserInfo();\n    }\n\n    /**\n     * Checks if an application's auth origin matches the current origin on an end user's browser.\n     * If this function returns false, webauthn will not work properly on this domain.\n     *\n     * @param {PassageAppInfo} appInfo JSON body containing app information that is returned from the {appInfo} function\n     * @return {boolean} true if webauthn is configured properly, false if not\n     *\n     * @example\n     * ```javascript\n     * import Passage from '@passageidentity/passage-js'\n     *\n     * const passage = new Passage(app_id);\n     * const webauthn_support = true;\n     * const identifier = document.getElementById(<\"email\" | \"phone\">).value;\n     *\n     * await passage.appInfo\n     *   .then(res => {\n     *       webauthn_supported = passage.checkWebauthnConfig(res)\n     *   }).catch(e => console.log(e));\n     *\n     * if (webauthn_supported) {\n     *   await passage.login(identifier)\n     *       .then(data => {\n     *           ...\n     *   }).catch(e => console.log(e));\n     * }\n     * ```\n     */\n    checkWebauthnConfig(appInfo: PassageAppInfo): boolean {\n        let webauthnAllowed: boolean = true;\n        // compare auth origins to ensure webauthn will work\n        // remove trailing slashes before comparison (it will still work regardless)\n        if (\n            // @ts-ignore\n            appInfo.auth_origin.replace(/\\/$/, '') != window.location.origin.replace(/\\/$/, '')\n        ) {\n            console.error(\n                'The auth_origin configured for webauthn in your app settings does not match the \"origin\" of your current URL.  Please reconfigure this in the admin console. (Your current \"origin\" is `' +\n                    window.location.origin +\n                    '`) Passage will continue to work with other authentication methods.'\n            );\n            webauthnAllowed = false;\n        }\n        return webauthnAllowed;\n    }\n\n    /**\n     * Detects if an end user's browser and device support webauthn.\n     *\n     * @param {boolean} roaming if we should allow roaming authenticators (Passage does not support roaming authenticators and must be false)\n     * @return {boolean} true if webauthn is supported on this device, false if not\n     *\n     * @example\n     * ```javascript\n     * import Passage from '@passageidentity/passage-js';\n     *\n     * const passage = new Passage(app_id);\n     * const identifier = document.getElementById(<\"email\" | \"phone\">).value;\n     * const webauthn_supported = await passage.isWebauthnSupported();\n     *\n     * if (webauthn_supported) {\n     *      await (passage.login(identifier)\n     *          .then(data => {\n     *              ...\n     *      }).catch((e) => {\n     *          console.log(e);\n     *      });\n     * }\n     * ```\n     */\n    async isWebauthnSupported(roaming: boolean): Promise<boolean> {\n        // Assume no webauthn is supported\n        let webauthn = false;\n        if (window.PublicKeyCredential) {\n            // if roaming is allowed, this is the only check needed\n            if (roaming) {\n                webauthn = true;\n            } else {\n                // NOTE: This timeout is in place to address an issue in the iOS WKWebView embedded context where the promise returned by isUserVerifyingPlatformAuthenticatorAvailable() is never resolved\n                await asyncCallWithTimeout(\n                    window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable()\n                        .then((available) => {\n                            // If false, webauthn supported, platform auth *not* supported.\n                            // Only get here is platform auth is on, so return false\n                            webauthn = available;\n                        })\n                        .catch(() => console.log('Something went wrong.')),\n                    500\n                );\n            }\n        }\n        return webauthn;\n    }\n\n    /**\n     * Look-up an identifier and return the user if the identifier exists\n     * @param {string} identifier email address / phone for user\n     * @return {Promise<PassageUser>}\n     */\n    async identifierExists(identifier: string): Promise<PassageUser> {\n        const unAuth = new UnAuth(this.fullUrl);\n        return await unAuth.identifierExists(identifier);\n    }\n\n    /**\n     * Create a new Passage magic link for registration\n     * @param {string} identifier The Passage User's identifier\n     * @param {string} language the language string for localizing emails, if no lanuage or an invalid language is provided the application default lanuage will be used\n     * @return {Promise<PassageMagicLinkRequest>} MagicLink JSON payload\n     */\n    async newRegisterMagicLink(\n        identifier: string,\n        language?: string\n    ): Promise<PassageMagicLinkRequest> {\n        const magicLink = new MagicLink(this.fullUrl, this.tokenStore);\n        return await magicLink.newRegister(identifier, language);\n    }\n\n    /**\n     * Initiate new login with Passage Magic Link\n     * @param {string} identifier The Passage User's identifier\n     * @param {string} language the language string for localizing emails, if no lanuage or an invalid language is provided the application default lanuage will be used\n     * @return {Promise<PassageMagicLinkRequest>} MagicLink JSON payload\n     */\n    async newLoginMagicLink(\n        identifier: string,\n        language?: string\n    ): Promise<PassageMagicLinkRequest> {\n        const magicLink = new MagicLink(this.fullUrl, this.tokenStore);\n        return await magicLink.newLogin(identifier, language);\n    }\n\n    /**\n     * Activate a magic link when a user clicks the link. This function handles login and registration magic links.\n     *\n     * @param {string} userMagicLink\n     * @return {Promise<authResult>} equivalent to a login operation and will return a redirect_url and set the `psg_auth_token` in Local Storage\n     *\n     * @example\n     * ```javascript\n     * import Passage from '@passageidentity/passage-js';\n     *\n     * const passage = new Passage(app_id);\n     *\n     * await this.passage.magicLinkActivate(token)\n     *      .then((res: any) => {\n     *          location.href = res.redirectURL;\n     *      })\n     *      .catch(() => console.log(\"access token is invalid or has expired\"));\n     * ```\n     */\n    async magicLinkActivate(userMagicLink: string): Promise<authResult> {\n        const magicLink = new MagicLink(this.fullUrl, this.tokenStore);\n        return await magicLink.activate(userMagicLink);\n    }\n\n    /**\n     * Activate Passage MagicLink via webAuthn login\n     * @param {string} userMagicLink The current magicLink\n     * @return {Promise<authResult>} The authentication result\n     */\n    async magicLinkActivateWebAuthnLogin(userMagicLink: string): Promise<authResult> {\n        const magicLink = new MagicLink(this.fullUrl, this.tokenStore);\n        return await magicLink.activateWebAuthnLogin(userMagicLink);\n    }\n\n    /**\n     * Activate Passage MagicLink via webAuthn for a new device\n     * @param {string} userMagicLink The current magicLink\n     * @return {Promise<authResult>} The authentication result\n     */\n    async magicLinkActivateWebAuthnNewDevice(userMagicLink: string): Promise<authResult> {\n        const magicLink = new MagicLink(this.fullUrl, this.tokenStore);\n        return await magicLink.activateWebAuthnNewDevice(userMagicLink);\n    }\n    /**\n     * Look up a magic link by ID and check if it has been verified. This function is mostly commonly used to\n     * iteratively check if a user has clicked a magic link to login. Once the link has been verified,\n     * Passage will return authentication information via this endpoint. This enables cross-device login.\n     *\n     * @param {string} id unique ID for an magic link which is returned by functions that create a magic link\n     * @return {Promise<authResult>}\n     */\n    async getMagicLinkStatus(id: string): Promise<authResult> {\n        const magicLink = new MagicLink(this.fullUrl, this.tokenStore);\n        return await magicLink.getStatus(id);\n    }\n\n    /**\n     * getCurrentUser returns the current authenticated user.\n     * @return {User} the Passage User\n     */\n    getCurrentUser(): User {\n        return new User(this.appID, this.tokenStore);\n    }\n\n    /**\n     * getCurrentSession returns a Session object to manage the current user's session.\n     * @return {Session} the Passage Session\n     */\n    getCurrentSession(): Session {\n        return new Session(this.appID, this.tokenStore);\n    }\n\n    /**\n     * createUser creates a user in a 'pending' state.\n     * @param {CreateUserPayload} [payload] identifier and any optional user_metadata (where registration is set to true) to create the user in a pending state.\n     * @return {Promise<PassageUser>}\n     */\n    async createUser(payload: CreateUserPayload): Promise<PassageUser> {\n        const user = await fetch(`${this.fullUrl}/users`, {\n            headers: getHeaders(),\n            body: JSON.stringify({\n                ...payload,\n            }),\n            method: 'POST',\n        }).then(handleResponse);\n\n        return user.user;\n    }\n}\n","import BytesHelper from './BytesHelper.js';\nimport { authResult } from './Passage.js';\nimport AuthTokenHelper from './AuthTokenHelper.js';\nimport BrowserHelper from './BrowserHelper';\nimport { handleResponse } from './utils/HandleResponse.js';\nimport { PassageError, PassageErrorCode } from './PassageError.js';\nimport { _isFirefox98Win, _modifyAttestationObject } from './utils/FirefoxHandlers.js';\nimport { getHeaders } from './utils/GetHeaders.js';\nimport { ReadOnlyTokenStore, TokenStore } from './TokenStore.js';\nimport { storeResponseTokens } from './utils/StoreResponseTokens.js';\n\nconst bytesHelper = new BytesHelper();\nconst authTokenHelper = new AuthTokenHelper();\nconst browserHelper = new BrowserHelper();\ndeclare const navigator: Navigator;\n\n/**\n * SignUp assists in creating new users that can be authenticated\n * via Passage\n */\nexport default class SignUp {\n    apiUrl: string;\n    identifier: string;\n\n    /**\n     * SignUp Constructor initializing class vars apiUrl and identifier\n     * @param {string} baseUrl the Passage App's base URL\n     * @param {string} identifier\n     */\n    constructor(\n        baseUrl: string,\n        private tokenStore: TokenStore | ReadOnlyTokenStore,\n        identifier: string\n    ) {\n        this.apiUrl = baseUrl + '/register/';\n        this.identifier = identifier;\n    }\n\n    /**\n     * Initialize webAuthn authentication for SignUp\n     * @return {Promise<authResult>}\n     */\n    async withWebAuthn(): Promise<authResult> {\n        const { createPassKeySupported } = await browserHelper.getBrowserInfo();\n\n        const webAuthnStartResponse = await fetch(this.apiUrl + 'webauthn/start', {\n            headers: getHeaders(),\n            body: JSON.stringify({\n                identifier: this.identifier,\n            }),\n            method: 'POST',\n        }).then(handleResponse);\n\n        const credential: PublicKeyCredential | null = await navigator.credentials\n            .create({\n                publicKey: this._parsePublicKey(\n                    webAuthnStartResponse.handshake.challenge.publicKey\n                ),\n            })\n            .catch((_) => {\n                throw new PassageError('error parsing public key for webAuthn', {\n                    status: PassageErrorCode.PSGParsePublicKeyForLoginFailed,\n                    statusText: 'PSG Parse Public Key For Login Failed',\n                });\n            })\n            .then((credValue) => {\n                return credValue as PublicKeyCredential;\n            });\n        // @ts-ignore\n        let attestationObject = new Uint8Array(credential?.response.attestationObject);\n        if (_isFirefox98Win()) {\n            attestationObject = _modifyAttestationObject(attestationObject);\n        }\n        let transports: string[] = [];\n        // getTransports() is not defined in all browsers (i.e. Firefox)\n        // make sure the function is defined before trying to use it\n        if (\n            // @ts-ignore\n            credential?.response.getTransports &&\n            // @ts-ignore\n            typeof credential?.response.getTransports === 'function'\n        ) {\n            // @ts-ignore\n            transports = credential?.response.getTransports();\n        }\n        // @ts-ignore\n        const userID = webAuthnStartResponse.user.id;\n        const webAuthnFinishResponse = await fetch(this.apiUrl + 'webauthn/finish', {\n            headers: getHeaders(),\n            method: 'POST',\n            body: JSON.stringify({\n                user_id: userID,\n                handshake_id: webAuthnStartResponse.handshake.id,\n                handshake_response: {\n                    rawId: bytesHelper.encodeBytes(credential?.rawId!),\n                    id: credential?.id,\n                    type: credential?.type,\n                    response: {\n                        attestationObject: bytesHelper.encodeBytes(attestationObject),\n\n                        clientDataJSON: bytesHelper.encodeBytes(\n                            credential?.response.clientDataJSON!\n                        ),\n                    },\n                    transports: transports,\n                },\n                cred_type: createPassKeySupported ? 'passkey' : 'platform',\n            }),\n        })\n            .then(handleResponse)\n            .then((response) => storeResponseTokens(response, this.tokenStore));\n\n        authTokenHelper.setPsgCredID(userID, credential);\n        return webAuthnFinishResponse.auth_result;\n    }\n\n    /**\n     * Parse the public key via credential creation options\n     * @param {PublicKeyCredentialCreationOptions} publicKey\n     * @return {PublicKeyCredentialCreationOptions}\n     */\n    private _parsePublicKey(\n        publicKey: PublicKeyCredentialCreationOptions\n    ): PublicKeyCredentialCreationOptions {\n        publicKey.challenge = bytesHelper.decodeBytes(publicKey.challenge.toString());\n        publicKey.user.id = bytesHelper.decodeBytes(publicKey.user.id.toString());\n        // ###In case we want to add excludeList in the future###\n        /* if (publicKey.excludeCredentials) {\n            for (let i = 0; i < publicKey.excludeCredentials.length; i++) {\n                const e = publicKey.excludeCredentials[i]\n                e.id = bytesHelper.DecodeBytes(e.id)\n            }\n        }*/\n        return publicKey;\n    }\n}\n","/**\n * BytesHelper assists in encoding and decoding bytes\n */\nexport default class BytesHelper {\n    /**\n     * Encode bytes using array buffer\n     * @param {ArrayBufferLike} arrayBuffer The array buffer\n     * @return {string} Base64 URL string\n     */\n    encodeBytes(arrayBuffer: ArrayBufferLike): string {\n        const b64Str = btoa(String.fromCharCode(...new Uint8Array(arrayBuffer)));\n        const b64URLStr = b64Str.replace(/\\+/g, '-').replace(/\\//g, '_');\n        return removePadding(b64URLStr);\n    }\n\n    /**\n     * Decode bytes using a Base64 URL string\n     * @param {string} b64URLStr The Base64 URL string\n     * @return {Uint8Array} Array buffer\n     */\n    decodeBytes(b64URLStr: string): Uint8Array {\n        const b64Str = b64URLStr.replace(/-/g, '+').replace(/_/g, '/');\n        const b64StrWithoutPadding = removePadding(b64Str);\n        const arrayBuffer = Uint8Array.from(atob(b64StrWithoutPadding), (c) => c.charCodeAt(0));\n        return arrayBuffer;\n    }\n}\n\nconst removePadding = (s: string): string => {\n    const padIdx = s.indexOf('=');\n    return s.slice(0, padIdx === -1 ? s.length : padIdx);\n};\n","import BytesHelper from './BytesHelper.js';\nimport { PassageError, PassageErrorCode } from './PassageError.js';\nimport PassageWebAuthnResponse from './types/PassageWebAuthnResponse.js';\nimport Cookies from 'js-cookie';\nconst bytesHelper = new BytesHelper();\n\n/**\n * AuthTokenHelper assists in AuthToken management\n */\nexport default class AuthTokenHelper {\n    /**\n     * Check to see if Passage CredID exists in local storage as the key psg_cred_obj\n     * @param {PassageWebAuthnResponse} responseBody1 Passage API response\n     * @return {Promise<boolean>} True if Passage CredID exists, false if it does not\n     */\n    psgCredIDExists(responseBody1: PassageWebAuthnResponse): boolean {\n        // @ts-ignore\n        const userID = responseBody1.user.id;\n        // @ts-ignore\n        const allowCredentials = responseBody1.handshake.challenge.publicKey.allowCredentials;\n        const psgCredObj = this.getPsgCredObj();\n\n        if (!psgCredObj)\n            throw new PassageError('Could not get psg_cred_obj', {\n                status: PassageErrorCode.PSGCredObjectDoesNotExist,\n                statusText: 'PSG Cred Object Does Not Exist',\n            });\n\n        /** {\"userID\": \"credentialID\"} */\n        const psgCredID = JSON.parse(psgCredObj)[userID];\n        if (!psgCredID) {\n            return false;\n        }\n        const psgCredIdExists: boolean = allowCredentials.find((credential: Credential) => {\n            if (\n                bytesHelper.encodeBytes(bytesHelper.decodeBytes(credential.id)) ===\n                bytesHelper.encodeBytes(bytesHelper.decodeBytes(psgCredID))\n            ) {\n                return true;\n            }\n        });\n\n        return psgCredIdExists;\n    }\n\n    /**\n     *\n     * @param {string} userID The Passage userID to be used as the key in psg_cred_obj\n     * @param {Credential | null} credential The credential to be associated with the userID in localstorage\n     * as the value associated with the userID key in psg_cred_obj\n     */\n    setPsgCredID(userID: string, credential: Credential | null): void {\n        if (!credential)\n            throw new PassageError(`Could not get user's credential`, {\n                status: PassageErrorCode.PSGCouldNotGetUserCredential,\n                statusText: 'PSG Could Not Get User Credential',\n            });\n\n        const passageCredentialObject = this.getPsgCredObj();\n\n        if (passageCredentialObject) {\n            const parsedCredentialObject: { [key: string]: string } =\n                JSON.parse(passageCredentialObject);\n            parsedCredentialObject[userID] = credential?.id!;\n            this.setPsgCredObj(JSON.stringify(parsedCredentialObject));\n        } else {\n            this.setPsgCredObj(JSON.stringify({ [userID]: credential?.id }));\n        }\n    }\n    /**\n     * Remove a credntial from the psg_cred_obj, if it exists\n     * @param {string} credID The credential to remove\n     */\n    removeCredential(credID: string): void {\n        const passageCredentialObject = this.getPsgCredObj();\n        if (passageCredentialObject === undefined) {\n            return;\n        }\n        const parsedCredentialObject: { [key: string]: string } =\n            JSON.parse(passageCredentialObject);\n        Object.keys(parsedCredentialObject).forEach((userID) => {\n            if (parsedCredentialObject[userID] === credID) {\n                delete parsedCredentialObject[userID];\n            }\n        });\n        this.setPsgCredObj(JSON.stringify(parsedCredentialObject));\n    }\n    /**\n     * Get psg_cred_obj from cookies or localstorage\n     * if found in localstorage copy to cookies\n     * if found in cookies, extend expiration\n     * @return {string | undefined} the psg_cred_obj string or undefined\n     */\n    getPsgCredObj(): string | undefined {\n        const cookieCredObj = Cookies.get('psg_cred_obj');\n        const localStorageCredObj = localStorage.getItem('psg_cred_obj');\n        if (cookieCredObj !== undefined) {\n            // extend the cookie's expiration\n            Cookies.set('psg_cred_obj', cookieCredObj, { expires: 400, sameSite: 'Strict' });\n            // mirror back to localstorage\n            if (localStorageCredObj === null) {\n                localStorage.setItem('psg_cred_obj', cookieCredObj);\n            }\n            return cookieCredObj;\n        }\n        if (localStorageCredObj !== null) {\n            // mirror to cookies\n            Cookies.set('psg_cred_obj', localStorageCredObj, { expires: 400, sameSite: 'Strict' });\n            return localStorageCredObj;\n        }\n        return undefined;\n    }\n    /**\n     * Sets psg_cred_obj on cookies and localstorage\n     * @param {string} value The string to store in psg_cred_obj\n     */\n    private setPsgCredObj(value: string): void {\n        Cookies.set('psg_cred_obj', value, { expires: 400, sameSite: 'Strict' });\n        localStorage.setItem('psg_cred_obj', value);\n    }\n}\n","/* eslint-disable no-unused-vars */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\ntype AtLeast<T, K extends keyof T> = Partial<T> & Pick<T, K>;\ntype RequiredResponse = Partial<Response> & AtLeast<Response, 'status' | 'statusText'>;\n\n/**\n * PassageError assists with error handling.\n */\nexport class PassageError extends Error {\n    public statusCode: number;\n    public statusText: string;\n    public message: string;\n    public name: string;\n\n    /**\n     * @param {string} psgErrorResponse a custom Passage error message.\n     * @param {RequiredResponse} res response or status and statusText used to generate error.\n     */\n    constructor(psgErrorResponse: string, res: RequiredResponse) {\n        super();\n        this.name = 'PassageError';\n        this.statusCode = res.status;\n        this.statusText = res.statusText;\n        this.message = this._parsePsgErrorResponse(psgErrorResponse);\n    }\n\n    /**\n     * _poarsePsgErrorResponse parses the custom Passage error response message.\n     * @param {any} psgErrorResponse the custom Passage error response.\n     * @return {string} the Passage error response from server or input string.\n     */\n    private _parsePsgErrorResponse(psgErrorResponse: any): string {\n        try {\n            psgErrorResponse = JSON.parse(psgErrorResponse);\n            if (psgErrorResponse.error) {\n                return psgErrorResponse.error;\n            }\n            return '';\n        } catch {\n            return psgErrorResponse;\n        }\n    }\n}\n\nexport enum PassageErrorCode {\n    /** The request has more than one possible response. The user agent or user should choose one of them. */\n    MultipleChoice = 300,\n    /** The URL of the requested resource has been changed permanently. The new URL is given in the response. */\n    MovedPermanantly,\n    /** This response code means that the URI of requested resource has been changed temporarily. Further changes in the URI might be made in the future. Therefore, this same URI should be used by the client in future requests. */\n    Found,\n    /** The server sent this response to direct the client to get the requested resource at another URI with a GET request. */\n    SeeOther,\n    /** This is used for caching purposes. It tells the client that the response has not been modified, so the client can continue to use the same cached version of the response. */\n    NotModified,\n    /** The server sends this response to direct the client to get the requested resource at another URI with same method that was used in the prior request. This has the same semantics as the 302 Found HTTP response code, with the exception that the user agent must not change the HTTP method used: if a POST was used in the first request, a POST must be used in the second request. */\n    TemporaryRedirect = 307,\n    /** This means that the resource is now permanently located at another URI, specified by the Location: HTTP Response header. This has the same semantics as the 301 Moved Permanently HTTP response code, with the exception that the user agent must not change the HTTP method used: if a POST was used in the first request, a POST must be used in the second request. */\n    PermanentRedirect,\n    /** The server could not understand the request due to invalid syntax. */\n    BadRequest = 400,\n    /** Although the HTTP standard specifies \"unauthorized\", semantically this response means \"unauthenticated\". That is, the client must authenticate itself to get the requested response. */\n    Unauthorized,\n    /** This response code is reserved for future use. The initial aim for creating this code was using it for digital payment systems, however this status code is used very rarely and no standard convention exists. */\n    PaymentRequired,\n    /** The client does not have access rights to the content; that is, it is unauthorized, so the server is refusing to give the requested resource. Unlike 401 Unauthorized, the client's identity is known to the server. */\n    Forbidden,\n    /** The server can not find the requested resource. In the browser, this means the URL is not recognized. In an API, this can also mean that the endpoint is valid but the resource itself does not exist. Servers may also send this response instead of 403 Forbidden to hide the existence of a resource from an unauthorized client. */\n    NotFound,\n    /** The request method is known by the server but is not supported by the target resource. For example, an API may not allow calling DELETE to remove a resource. */\n    MethodNotAllowed,\n    /** This response is sent when the web server, after performing server-driven content negotiation, doesn't find any content that conforms to the criteria given by the user agent. */\n    NotAcceptable,\n    /** This is similar to 401 Unauthorized but authentication is needed to be done by a proxy. */\n    ProxyAuthenticationRequired,\n    /** This response is sent on an idle connection by some servers, even without any previous request by the client. It means that the server would like to shut down this unused connection. This response is used much more since some browsers, like Chrome, Firefox 27+, or IE9, use HTTP pre-connection mechanisms to speed up surfing. Also note that some servers merely shut down the connection without sending this message. */\n    RequestTimeout,\n    /** This response is sent when a request conflicts with the current state of the server. */\n    Conflict,\n    /** This response is sent when the requested content has been permanently deleted from server, with no forwarding address. Clients are expected to remove their caches and links to the resource. The HTTP specification intends this status code to be used for \"limited-time, promotional services\". APIs should not feel compelled to indicate resources that have been deleted with this status code. */\n    Gone,\n    /** Server rejected the request because the Content-Length header field is not defined and the server requires it. */\n    LengthRequired,\n    /** The client has indicated preconditions in its headers which the server does not meet. */\n    PreconditionFailed,\n    /** Request entity is larger than limits defined by server. The server might close the connection or return an Retry-After header field. */\n    PayloadTooLarge,\n    /** The URI requested by the client is longer than the server is willing to interpret. */\n    URITooLong,\n    /** The media format of the requested data is not supported by the server, so the server is rejecting the request. */\n    UnsupportedMediaType,\n    /** The range specified by the Range header field in the request cannot be fulfilled. It's possible that the range is outside the size of the target URI's data. */\n    RangeNotSatisfiable,\n    /** This response code means the expectation indicated by the Expect request header field cannot be met by the server. */\n    ExpectationFailed,\n    /** The request was directed at a server that is not able to produce a response. This can be sent by a server that is not configured to produce responses for the combination of scheme and authority that are included in the request URI. */\n    MisdirectedRequest = 421,\n    /** The request was well-formed but was unable to be followed due to semantic errors. */\n    UnprocessableEntity,\n    /** The resource that is being accessed is locked. */\n    Locked,\n    /** The request failed due to failure of a previous request. */\n    FailedDependency,\n    /** Indicates that the server is unwilling to risk processing a request that might be replayed. */\n    TooEarly,\n    /** The server refuses to perform the request using the current protocol but might be willing to do so after the client upgrades to a different protocol. The server sends an Upgrade header in a 426 response to indicate the required protocol(s). */\n    UpgradeRequired,\n    /** The origin server requires the request to be conditional. This response is intended to prevent the 'lost update' problem, where a client GETs a resource's state, modifies it and PUTs it back to the server, when meanwhile a third party has modified the state on the server, leading to a conflict. */\n    PreconditionRequired = 428,\n    /** The user has sent too many requests in a given amount of time (\"rate limiting\"). */\n    TooManyRequests,\n    /** The server is unwilling to process the request because its header fields are too large. The request may be resubmitted after reducing the size of the request header fields. */\n    RequestHeaderFieldsTooLarge = 431,\n    /** The user agent requested a resource that cannot legally be provided, such as a web page censored by a government. */\n    UnavailableForLegalReasons = 451,\n\n    /** The server has encountered a situation it does not know how to handle. */\n    InternalServerError = 500,\n    /** The request method is not supported by the server and cannot be handled. The only methods that servers are required to support (and therefore that must not return this code) are GET and HEAD. */\n    NotImplemented,\n    /** This error response means that the server, while working as a gateway to get a response needed to handle the request, got an invalid response. */\n    BadGateway,\n    /** The server is not ready to handle the request. */\n    ServiceUnavailable,\n    /** This error response is given when the server is acting as a gateway and cannot get a response in time. */\n    GatewayTimeout,\n    /** The HTTP version used in the request is not supported by the server. */\n    HTTPVersionNotSupported,\n    /** The server has an internal configuration error: the chosen variant resource is configured to engage in transparent content negotiation itself, and is therefore not a proper end point in the negotiation process. */\n    VariantAlsoNegotiates,\n    /** The method could not be performed on the resource because the server is unable to store the representation needed to successfully complete the request. */\n    InsufficientStorage,\n    /** The server detected an infinite loop while processing the request. */\n    LoopDetected,\n    /** Further extensions to the request are required for the server to fulfill it. */\n    NotExtended = 510,\n    /** Indicates that the client needs to authenticate to gain network access. */\n    NetworkAuthenticationRequired,\n\n    /** The psg_cred_obj does not exist in the webAuthn allow list */\n    PSGCredObjectDoesNotExist = 700,\n    /** Parsing the public key for new device has failed */\n    PSGParsePublicKeyForNewDeviceFailed,\n    /** Parsing the public key for login has failed */\n    PSGParsePublicKeyForLoginFailed,\n    /** Could not get user's credential */\n    PSGCouldNotGetUserCredential,\n    /** Indicates that the user needs to authenticate */\n    PSGLoginRequired,\n}\n","import UaParser from 'ua-parser-js';\n\nexport interface BrowserInfo {\n    createPassKeySupported: boolean;\n    getPassKeySupported: boolean;\n    conditionalUISupported: boolean;\n}\n\n/**\n * BrowserHelper assists in detecting what features the browser supports\n */\nexport default class BrowserHelper {\n    userAgent: UaParser.UAParserInstance;\n\n    /**\n     * Constructor configuring the CredentialHelper class' attributes\n     */\n    constructor() {\n        this.userAgent = new UaParser();\n    }\n\n    /**\n     * Detect if Browser can create a PassKey\n     * @return {boolean}\n     */\n    async getBrowserInfo(): Promise<BrowserInfo> {\n        return {\n            createPassKeySupported: await this._canBrowserCreatePassKey(),\n            getPassKeySupported: await this._canBrowserGetPasskey(),\n            conditionalUISupported: await this._isConditionalMediationAvailable(),\n        };\n    }\n\n    /**\n     * Detect if Browser can create a PassKey\n     * @return {boolean}\n     */\n    private async _canBrowserCreatePassKey(): Promise<boolean> {\n        // iOS Supported\n        if (this._isiOSPasskeySupported()) {\n            return true;\n        }\n\n        // MacOS Safari Supported\n        if (this._isMacPasskeySupported()) {\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Detect if Browser can use Passkeys\n     * @return {boolean}\n     */\n    private _canBrowserGetPasskey(): Promise<boolean> {\n        // iOS Supported\n        if (this._isiOSPasskeySupported()) {\n            return Promise.resolve(true);\n        }\n\n        // MacOS Safari Supported\n        if (this._isMacPasskeySupported()) {\n            return Promise.resolve(true);\n        }\n\n        if (this._isDesktopChrome108()) {\n            return Promise.resolve(true);\n        }\n\n        return Promise.resolve(false);\n    }\n\n    /**\n     * Detect if Browser has implemented Conditional Mediation\n     * @return {boolean}\n     */\n    private async _isConditionalMediationAvailable(): Promise<boolean> {\n        return false;\n        /*\n        // Running this code on iOS breaks user gestures entirely\n        if (!PublicKeyCredential.isConditionalMediationAvailable) {\n            return false;\n        }\n\n        return await PublicKeyCredential.isConditionalMediationAvailable();\n        */\n    }\n\n    /**\n     * Detect if Browser is running on iOS16 or greater\n     * @return {boolean}\n     */\n    private _isiOSPasskeySupported(): boolean {\n        return (\n            this.userAgent.getOS().name == 'iOS' &&\n            parseFloat(this.userAgent.getOS().version || '') >= 16\n        );\n    }\n\n    /**\n     * Detect if Browser is running MacOS and Safari 16 or greater\n     * @return {boolean}\n     */\n    private _isMacPasskeySupported(): boolean {\n        return (\n            this.userAgent.getBrowser().name == 'Safari' &&\n            parseFloat(this.userAgent.getBrowser().version || '') >= 16 &&\n            this.userAgent.getOS().name == 'Mac OS'\n        );\n    }\n\n    /**\n     * Detect if Browser is running Chrome 108 desktop or greater\n     * @return {boolean}\n     */\n    private _isDesktopChrome108(): boolean {\n        return (\n            this.userAgent.getBrowser().name == 'Chrome' &&\n            parseFloat(this.userAgent.getBrowser().version || '') >= 108\n        );\n    }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { PassageError } from '../PassageError';\n\n/**\n * handeResponse checks the response from the request and initiates a PassageError if needed\n * @param {Response} res The response from the request\n * @return {Promise<PassageError | any>}\n */\nexport async function handleResponse(res: Response): Promise<PassageError | any> {\n    if (!res.ok) {\n        return await res.text().then((psgErrorResponse) => {\n            throw new PassageError(psgErrorResponse, res);\n        });\n    }\n    return res.json();\n}\n","/**\n * Check to see if Firefox98 on Windows\n * @return {boolean}\n */\nexport function _isFirefox98Win(): boolean {\n    const isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n    const match = window.navigator.userAgent.match(/Firefox\\/([0-9]+)\\./);\n    const firefoxVersion = match ? parseInt(match[1]) : 0;\n    const isWindows = navigator.platform.indexOf('Win') !== -1;\n    return isWindows && isFirefox && firefoxVersion === 98;\n}\n\n/**\n * Modify attestation object for firefox98 on windows\n * @param {Uint8Array} object\n * @return {Uint8Array}\n */\nexport function _modifyAttestationObject(object: Uint8Array): Uint8Array {\n    const first = new Uint8Array(68);\n    first.set(object.slice(0, 68));\n    const rest = new Uint8Array(object.byteLength - 68);\n    rest.set(object.slice(68, object.byteLength));\n    const buffer = new Uint8Array(15);\n    const newFirefoxBuffer = new Uint8Array(first.byteLength + buffer.byteLength + rest.byteLength);\n    newFirefoxBuffer.set(first, 0);\n    newFirefoxBuffer.set(buffer, first.byteLength);\n    newFirefoxBuffer.set(rest, first.byteLength + buffer.byteLength);\n    const updateLength = newFirefoxBuffer[30] + 15;\n    newFirefoxBuffer.set([updateLength], 30);\n    return newFirefoxBuffer;\n}\n","import { env } from '../config/Environment';\n/**\n * getHeaders builds Headers with an SDK version, if available\n * @param {HeadersInit} init Initial key-value pairs to include in headers\n * @return {Headers}\n */\nexport function getHeaders(init?: HeadersInit): Headers {\n    const headers = new Headers(init);\n    const version = env.version;\n    if (version) {\n        headers.append('Passage-Version', version);\n    }\n    return headers;\n}\n","import { EnvConfig } from './EnvironmentModel.js';\nimport envConfig from './env_config.js';\n\nexport const env = envConfig as EnvConfig;\n","export default {URL: \"https://auth.passage.id\", version: \"@passageidentity/passage-js 3.1.0\", CAPTURE_EVENT_URL: \"https://us-central1-passage-prod.cloudfunctions.net/capture-event\", SENTRY_RELEASE: \"passage-js@3.1.0-prod\",SENTRY_PROJECT: \"passage-js\",  SENTRY_PROJECT_DSN: \"\", SENTRY_PROJECT_ENV: \"prod\", SENTRY_PROJECT_VERSION: \"3.1.0\"};\n","import { authResult } from '../Passage.js';\nimport { isFullTokenStore, ReadOnlyTokenStore, TokenStore } from '../TokenStore.js';\n\ntype AuthResponse = {\n    auth_result: authResult;\n};\n\nconst isAuthResponse = (res: unknown): res is AuthResponse => {\n    return (\n        typeof res === 'object' &&\n        res !== null &&\n        typeof (res as AuthResponse).auth_result !== 'undefined'\n    );\n};\n\n/**\n * storeRefreshToken stores a refresh token from a response body if possible\n * @param {unknown} res The response from the request\n * @param {TokenStore} tokenStore token Store being used\n * @return {unknown}\n */\nexport function storeResponseTokens<T = unknown>(\n    res: T,\n    tokenStore: TokenStore | ReadOnlyTokenStore\n): T {\n    if (!isAuthResponse(res)) {\n        console.warn('Not a valid auth response');\n        return res;\n    }\n    if (isFullTokenStore(tokenStore)) {\n        tokenStore.setTokens(res.auth_result);\n    }\n    return res;\n}\n","import { authResult, PassageError, PassageErrorCode } from '.';\n/**\n * Base class for implementing read-only token stores. getAuthToken() is the only required function to implement.\n * If a Passage object is built with a read-only token store it will not handle any token storage.\n */\nexport abstract class ReadOnlyTokenStore {\n    /**\n     * This method returns a token to be used for authenticated operations on the User class.\n     * This can return a Passage-issued JWT or a third-party bearer token for use with authorizers.\n     * @returns {Promise<string>} Passage-issued JWT or third-party bearer token\n     */\n    abstract getAuthToken(): Promise<string>;\n\n    /**\n     * This method retrieves a Passage refresh token from storage for use with the Session class for refreshing Passage sessions.\n     * If this method returns undefined then Session will not handle any refresh token logic.\n     * Only return Passage-issued refresh tokens from this method.\n     * @return {Promise<string | undefined>} refresh token, or undefined if not using refresh tokens.\n     */\n    getRefreshToken(): Promise<string | undefined> {\n        return Promise.resolve(undefined);\n    }\n}\n\n/**\n * Base class for implementing full read-write token stores.\n */\nexport abstract class TokenStore extends ReadOnlyTokenStore {\n    /**\n     * This method is responsible for hanlding the storage of Passage-issues JWTs and refresh tokens.\n     * @param {authResult} authResult The authResult object returned from Passage Login, Register, Magic Link, and token refresh operations.\n     */\n    abstract setTokens(authResult: authResult): Promise<void>;\n\n    /**\n     * This method is responsible for clearing tokens from storage when a sign-out operation is executed on the Session class.\n     * @return {Promise<void>}\n     */\n    clearTokens(): Promise<void> {\n        return Promise.resolve();\n    }\n}\n\n/* eslint-disable require-jsdoc */\n/* eslint-disable prefer-promise-reject-errors */\nexport class PassageTokenStore extends TokenStore {\n    private noLocalStorage = typeof window === 'undefined';\n    private noLocalStorageError = (f: string): string =>\n        `Failed to access localStorage or cookies. Must be run client-side.`;\n\n    getAuthToken(): Promise<string> {\n        if (this.noLocalStorage) {\n            return Promise.reject(this.noLocalStorageError('getAuthToken'));\n        }\n        const localToken = localStorage.getItem('psg_auth_token');\n        if (localToken === null) {\n            const err = new PassageError('Login required', {\n                status: PassageErrorCode.PSGLoginRequired,\n                statusText: 'Login required',\n            });\n            return Promise.reject(err);\n        }\n        return Promise.resolve(localToken);\n    }\n\n    private setAuthToken(authToken: string): Promise<void> {\n        if (this.noLocalStorage) {\n            return Promise.reject(this.noLocalStorageError('setAuthToken'));\n        }\n        localStorage.setItem('psg_auth_token', authToken);\n        const leaveUnsecure = !this._isHttps() && this._isLocalHost();\n        document.cookie = `psg_auth_token = ${authToken}; path=/ ${leaveUnsecure ? '' : ';secure'}`;\n        return Promise.resolve();\n    }\n\n    getRefreshToken(): Promise<string | undefined> {\n        if (this.noLocalStorage) {\n            Promise.reject(this.noLocalStorageError('getRefreshToken'));\n        }\n        const localToken = localStorage.getItem('psg_refresh_token');\n        if (localToken === null) {\n            return Promise.resolve(undefined);\n        }\n        return Promise.resolve(localToken);\n    }\n\n    setRefreshToken(refreshToken: string): Promise<void> {\n        if (this.noLocalStorage) {\n            Promise.reject(this.noLocalStorageError('setRefreshToken'));\n        }\n        localStorage.setItem('psg_refresh_token', refreshToken);\n        return Promise.resolve();\n    }\n\n    setTokens(authResult: authResult): Promise<void> {\n        if (this.noLocalStorage) {\n            Promise.reject(this.noLocalStorageError('setTokens'));\n        }\n        this.setAuthToken(authResult.auth_token);\n        if (authResult.refresh_token) {\n            this.setRefreshToken(authResult.refresh_token);\n        }\n        return Promise.resolve();\n    }\n\n    clearTokens(): Promise<void> {\n        if (this.noLocalStorage) {\n            Promise.reject(this.noLocalStorageError('clearTokens'));\n        }\n        localStorage.removeItem('psg_auth_token');\n        document.cookie = 'psg_auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC;';\n        localStorage.removeItem('psg_refresh_token');\n        return Promise.resolve();\n    }\n\n    /**\n     * Determines if localhost\n     * @return {boolean} The sum of the two numbers.\n     */\n    private _isLocalHost(): boolean {\n        return Boolean(\n            window.location.hostname === 'localhost' ||\n                // [::1] is the IPv6 localhost address.\n                window.location.hostname === '[::1]' ||\n                // 127.0.0.1/8 is considered localhost for IPv4.\n                window.location.hostname.match(\n                    /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n                )\n        );\n    }\n\n    /**\n     * Determines if protocol being used is HTTPS\n     * @return {boolean}\n     */\n    private _isHttps(): boolean {\n        return location.protocol === 'https:';\n    }\n}\n\nexport function isFullTokenStore(store: ReadOnlyTokenStore | TokenStore): store is TokenStore {\n    return (store as TokenStore).setTokens !== undefined;\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n// import AuthTokenHelper from './AuthTokenHelper.js';\nimport BytesHelper from './BytesHelper.js';\nimport { authResult } from './Passage.js';\nimport { PassageError, PassageErrorCode } from './PassageError.js';\nimport { ReadOnlyTokenStore, TokenStore } from './TokenStore.js';\nimport { getHeaders } from './utils/GetHeaders.js';\nimport { handleResponse } from './utils/HandleResponse.js';\nimport { storeResponseTokens } from './utils/StoreResponseTokens.js';\n\nconst bytesHelper = new BytesHelper();\n// const authTokenHelper = new AuthTokenHelper();\ndeclare const navigator: Navigator;\n\n/**\n * LogIn assists with authenticating Passage Users via WebAuthn\n */\nexport default class LogIn {\n    apiUrl: string;\n    identifier: string;\n\n    /**\n     * LogIn constructor initializing apiURL and identifier class vars\n     * @param {string} baseUrl\n     * @param {strting} identifier\n     */\n    constructor(\n        baseUrl: string,\n        private tokenStore: TokenStore | ReadOnlyTokenStore,\n        identifier?: string\n    ) {\n        this.apiUrl = baseUrl + '/login/';\n        this.identifier = identifier ?? '';\n    }\n\n    /**\n     * Begin authentication via WebAuthn\n     * @return {Promise<authResult>}\n     */\n    async withWebAuthn(): Promise<authResult> {\n        const identifierBody = JSON.stringify({\n            identifier: this.identifier,\n        });\n        const body = this.identifier ? identifierBody : undefined;\n        const webAuthnStartResponse = await fetch(this.apiUrl + 'webauthn/start', {\n            headers: getHeaders(),\n            method: 'POST',\n            body,\n        }).then(handleResponse);\n\n        /* const psgCredIDExists = await authTokenHelper.psgCredIDExists(webAuthnStartResponse);\n        if (!psgCredIDExists) {\n            throw new PassageError('psg_cred_obj does not exist in the allow list', {\n                status: PassageErrorCode.PSGCredObjectDoesNotExist,\n                statusText: 'psg_cred_obj does not exist in the allow list',\n            });\n        } */\n\n        const assertion: PublicKeyCredential | null = await navigator.credentials\n            .get({\n                publicKey: this._parsePublicKey(\n                    webAuthnStartResponse.handshake.challenge.publicKey\n                ),\n            })\n            .catch((err) => {\n                throw new PassageError('error parsing public key for webAuthn', {\n                    status: PassageErrorCode.PSGParsePublicKeyForLoginFailed,\n                    statusText: 'PSG Parse Public Key For Login Failed',\n                });\n            })\n            .then((credValue) => {\n                return credValue as PublicKeyCredential;\n            });\n\n        if (!assertion) {\n            return {\n                auth_token: '',\n                redirect_url: '',\n            };\n        }\n        const webAuthnFinishResponse = await fetch(this.apiUrl + 'webauthn/finish', {\n            headers: getHeaders(),\n            method: 'POST',\n            body: JSON.stringify({\n                user_id: this.identifier ? webAuthnStartResponse.user.id : undefined,\n                handshake_id: webAuthnStartResponse.handshake.id,\n                handshake_response: {\n                    id: assertion.id,\n                    rawId: bytesHelper.encodeBytes(assertion.rawId),\n                    type: assertion.type,\n                    response: {\n                        clientDataJSON: bytesHelper.encodeBytes(assertion.response.clientDataJSON),\n                        authenticatorData: bytesHelper.encodeBytes(\n                            // @ts-ignore\n                            assertion.response.authenticatorData\n                        ),\n                        // @ts-ignore\n                        signature: bytesHelper.encodeBytes(assertion.response.signature),\n                        // @ts-ignore\n                        userHandle: bytesHelper.encodeBytes(assertion.response.userHandle),\n                    },\n                },\n            }),\n        })\n            .then(handleResponse)\n            .then((response) => storeResponseTokens(response, this.tokenStore));\n\n        // @ts-ignore\n        // const userID = String.fromCharCode(...new Uint8Array(assertion.response.userHandle));\n        // authTokenHelper.setPsgCredID(userID, assertion);\n        return webAuthnFinishResponse.auth_result;\n    }\n\n    /**\n     * Parse the public key via credential request options\n     * @param {PublicKeyCredentialRequestOptions} publicKey\n     * @return {PublicKeyCredentialRequestOptions}\n     */\n    private _parsePublicKey(\n        publicKey: PublicKeyCredentialRequestOptions\n    ): PublicKeyCredentialRequestOptions {\n        publicKey.challenge = bytesHelper.decodeBytes(publicKey.challenge.toString());\n        if (publicKey.allowCredentials) {\n            for (let i = 0; i < publicKey.allowCredentials.length; i++) {\n                const e = publicKey.allowCredentials[i];\n                e.id = bytesHelper.decodeBytes(e.id.toString());\n            }\n            return publicKey;\n        }\n        return publicKey;\n    }\n}\n","import { PassageAppInfo } from './types/PassageApp';\nimport { PassageUser } from './types/PassageUser';\nimport { getHeaders } from './utils/GetHeaders';\nimport { handleResponse } from './utils/HandleResponse';\n\n/**\n * UnAuth assists in determining whether or not an identifier exists\n * (i.e. if the user is unauthenticated)\n */\nexport default class UnAuth {\n    apiUrl: string;\n\n    /**\n     * UnAuth constructor assigning apiURL\n     * @param {string} baseUrl App's base URL\n     */\n    constructor(baseUrl: string) {\n        this.apiUrl = baseUrl;\n    }\n\n    /**\n     * Get the App's info from Passage\n     * @return {Promise<PassageAppInfo>}\n     */\n    async appInfo(): Promise<PassageAppInfo> {\n        const appInfo = await fetch(this.apiUrl, {\n            headers: getHeaders(),\n            method: 'GET',\n        }).then(handleResponse);\n\n        return appInfo.app;\n    }\n\n    /**\n     * Checks to see if the identifier exists\n     * @param {string} identifier\n     * @return {Promise}\n     */\n    async identifierExists(identifier: string): Promise<PassageUser> {\n        const identifierExists = await fetch(\n            this.apiUrl + '/users?identifier=' + encodeURIComponent(identifier),\n            {\n                headers: getHeaders(),\n                method: 'GET',\n            }\n        ).then(handleResponse);\n\n        return identifierExists.user;\n    }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/explicit-function-return-type */\nimport BytesHelper from './BytesHelper.js';\nimport { authResult } from './Passage.js';\nimport AuthTokenHelper from './AuthTokenHelper.js';\nimport { PassageMagicLinkRequest } from './types/PassageMagicLinkRequest.js';\nimport { handleResponse } from './utils/HandleResponse.js';\nimport { PassageError, PassageErrorCode } from './PassageError.js';\nimport { _isFirefox98Win, _modifyAttestationObject } from './utils/FirefoxHandlers.js';\nimport { getHeaders } from './utils/GetHeaders.js';\nimport { ReadOnlyTokenStore, TokenStore } from './TokenStore.js';\nimport { storeResponseTokens } from './utils/StoreResponseTokens.js';\n\nconst bytesHelper = new BytesHelper();\nconst authTokenHelper = new AuthTokenHelper();\ndeclare const navigator: Navigator;\n\n/**\n * MagicLink assists with Passage MagicLink functionality for\n * authentication and registration\n */\nexport default class MagicLink {\n    apiUrl: string;\n\n    /**\n     * Constructor for Passage's magicLink\n     * @param {string} baseUrl the base URL for the Passage app\n     */\n    constructor(baseUrl: string, private tokenStore: TokenStore | ReadOnlyTokenStore) {\n        this.apiUrl = baseUrl;\n    }\n\n    /**\n     * Process a new registration via Passage's magicLink\n     * @param {string} identifier the Passage user's identifier (email/phone)\n     * @param {string?} language the language string for localizing emails, if no lanuage or an invalid language is provided the application default lanuage will be used\n     * @return {PassageMagicLinkRequest}\n     */\n    async newRegister(identifier: string, language?: string): Promise<PassageMagicLinkRequest> {\n        const newRegisterResponse = await fetch(this.apiUrl + '/register/magic-link', {\n            headers: getHeaders(),\n            method: 'POST',\n            body: JSON.stringify({\n                identifier: identifier,\n                magic_link_path: window.location.pathname,\n                language,\n            }),\n        }).then(handleResponse);\n\n        return newRegisterResponse.magic_link;\n    }\n\n    /**\n     * Process a new login via Passage magicLink\n     * @param {string} identifier the Passage user's identifier (phone/email)\n     * @param {string?} language the language string for localizing emails, if no lanuage or an invalid language is provided the application default lanuage will be used\n     * @return {PassageMagicLinkRequest}\n     */\n    async newLogin(identifier: string, language?: string): Promise<PassageMagicLinkRequest> {\n        const newLoginResponse = await fetch(this.apiUrl + '/login/magic-link', {\n            headers: getHeaders(),\n            method: 'POST',\n            body: JSON.stringify({\n                identifier: identifier,\n                magic_link_path: window.location.pathname,\n                language,\n            }),\n        }).then(handleResponse);\n\n        return newLoginResponse.magic_link;\n    }\n\n    /**\n     * Get status of a Passage magicLink\n     * @param {string} id The magicLink ID\n     * @return {Promise<authResult>}\n     */\n    async getStatus(id: string): Promise<authResult> {\n        const magicLinkStatusResponse = await fetch(this.apiUrl + '/magic-link/status', {\n            headers: getHeaders(),\n            method: 'POST',\n            body: JSON.stringify({\n                id: id,\n            }),\n        })\n            .then(handleResponse)\n            .then((response) => storeResponseTokens(response, this.tokenStore));\n\n        return magicLinkStatusResponse.auth_result;\n    }\n\n    /**\n     * Activate Passage magicLink via Passage's API\n     * @param {string} magicLink The magicLink to be activated\n     * @return {Promise<authResult>}\n     */\n    async activate(magicLink: string): Promise<authResult> {\n        const activateMagicLinkResponse = await fetch(this.apiUrl + '/magic-link/activate', {\n            headers: getHeaders(),\n            method: 'PATCH',\n            body: JSON.stringify({\n                magic_link: magicLink,\n            }),\n        })\n            .then(handleResponse)\n            .then((response) => storeResponseTokens(response, this.tokenStore));\n\n        return activateMagicLinkResponse.auth_result;\n    }\n\n    /**\n     * Activate a Passage magicLink via WebAuthn\n     * @param {string} magicLink The magicLink to be activated via webAuthn\n     * @return {Promise<authResult>}\n     */\n    async activateWebAuthnLogin(magicLink: string): Promise<authResult> {\n        const webAuthnStartResponse = await fetch(\n            this.apiUrl + '/magic-link/webauthn/login/start',\n            {\n                headers: getHeaders(),\n                body: JSON.stringify({\n                    magic_link: magicLink,\n                }),\n                method: 'POST',\n            }\n        ).then(handleResponse);\n\n        const psgCredIDExists = await authTokenHelper.psgCredIDExists(webAuthnStartResponse);\n        if (!psgCredIDExists) {\n            throw new PassageError('psg_cred_obj does not exist in the allow list', {\n                status: PassageErrorCode.PSGCredObjectDoesNotExist,\n                statusText: 'Not Found',\n            });\n        }\n\n        const assertion: Credential | null = await navigator.credentials\n            .get({\n                publicKey: this._parsePublicKeyLogin(\n                    webAuthnStartResponse.handshake.challenge.publicKey\n                ),\n            })\n            .catch((_) => {\n                throw new PassageError('could not parse publickey for login', {\n                    status: PassageErrorCode.PSGParsePublicKeyForLoginFailed,\n                    statusText: 'PSG Parse Public Key For Login Failed',\n                });\n            });\n\n        if (!assertion) {\n            return {\n                auth_token: '',\n                redirect_url: '',\n            };\n        }\n\n        const webAuthnFinishResponse = await fetch(\n            this.apiUrl + '/magic-link/webauthn/login/finish',\n            {\n                headers: getHeaders(),\n                method: 'POST',\n                body: JSON.stringify({\n                    magic_link: magicLink,\n                    user_id: webAuthnStartResponse.user.id,\n                    handshake_id: webAuthnStartResponse.handshake.id,\n                    handshake_response: {\n                        id: assertion.id,\n                        // @ts-ignore\n                        rawId: bytesHelper.encodeBytes(assertion.rawId),\n                        type: assertion.type,\n                        response: {\n                            clientDataJSON: bytesHelper.encodeBytes(\n                                // @ts-ignore\n                                assertion.response.clientDataJSON\n                            ),\n                            authenticatorData: bytesHelper.encodeBytes(\n                                // @ts-ignore\n                                assertion.response.authenticatorData\n                            ),\n                            // @ts-ignore\n                            signature: bytesHelper.encodeBytes(assertion.response.signature),\n                            // @ts-ignore\n                            userHandle: bytesHelper.encodeBytes(assertion.response.userHandle),\n                        },\n                    },\n                }),\n            }\n        )\n            .then(handleResponse)\n            .then((response) => storeResponseTokens(response, this.tokenStore));\n\n        return webAuthnFinishResponse.auth_result;\n    }\n\n    /**\n     * Initiate WebAuthn for a new device\n     * @param {string} magicLink The Passage magicLink being used for a new WebAuthn start\n     * @return {Promise<authResult>}\n     */\n    async activateWebAuthnNewDevice(magicLink: string): Promise<authResult> {\n        const webAuthnStartResponse = await fetch(this.apiUrl + '/magic-link/webauthn/new/start', {\n            headers: getHeaders(),\n            body: JSON.stringify({\n                magic_link: magicLink,\n            }),\n            method: 'POST',\n        }).then(handleResponse);\n\n        const credential: Credential | null = await navigator.credentials\n            .create({\n                publicKey: this._parsePublicKeyNewDevice(\n                    webAuthnStartResponse.handshake.challenge.publicKey\n                ),\n            })\n            .catch((_) => {\n                throw new PassageError('could not parse public key for new device', {\n                    status: PassageErrorCode.PSGParsePublicKeyForNewDeviceFailed,\n                    statusText: 'PSG Parse Public Key For New Device Failed',\n                });\n            });\n\n        // @ts-ignore\n        let attestationObject = new Uint8Array(credential?.response.attestationObject);\n        if (_isFirefox98Win()) {\n            attestationObject = _modifyAttestationObject(attestationObject);\n        }\n        const webAuthnFinishResponse = await fetch(\n            this.apiUrl + '/magic-link/webauthn/new/finish',\n            {\n                headers: getHeaders(),\n                method: 'POST',\n                body: JSON.stringify({\n                    magic_link: magicLink,\n                    user_id: webAuthnStartResponse.user.id,\n                    handshake_id: webAuthnStartResponse.handshake.id,\n                    handshake_response: {\n                        // @ts-ignore\n                        rawId: bytesHelper.encodeBytes(credential.rawId),\n                        // @ts-ignore\n                        id: credential.id,\n                        // @ts-ignore\n                        type: credential.type,\n                        response: {\n                            attestationObject: bytesHelper.encodeBytes(attestationObject),\n                            // @ts-ignore\n                            clientDataJSON: bytesHelper.encodeBytes(\n                                // @ts-ignore\n                                credential.response.clientDataJSON\n                            ),\n                        },\n                    },\n                    device_name: navigator.userAgent,\n                }),\n            }\n        )\n            .then(handleResponse)\n            .then((response) => storeResponseTokens(response, this.tokenStore));\n\n        const userID: string = webAuthnStartResponse.user.id;\n        authTokenHelper.setPsgCredID(userID, credential);\n\n        return webAuthnFinishResponse.auth_result;\n    }\n\n    /**\n     * Parse the public key for login\n     * @param {PublicKeyCredentialRequestOptions} publicKey\n     * @return {PublicKeyCredentialRequestOptions}\n     */\n    private _parsePublicKeyLogin(\n        publicKey: PublicKeyCredentialRequestOptions\n    ): PublicKeyCredentialRequestOptions {\n        publicKey.challenge = bytesHelper.decodeBytes(publicKey.challenge.toString());\n        if (publicKey.allowCredentials) {\n            for (let i = 0; i < publicKey.allowCredentials.length; i++) {\n                const e = publicKey.allowCredentials[i];\n                e.id = bytesHelper.decodeBytes(e.id.toString());\n            }\n            return publicKey;\n        }\n        return publicKey;\n    }\n\n    /**\n     * Parse the public key for new device\n     * @param {PublicKeyCredentialCreationOptions} publicKey\n     * @return {PublicKeyCredentialCreationOptions}\n     */\n    private _parsePublicKeyNewDevice(\n        publicKey: PublicKeyCredentialCreationOptions\n    ): PublicKeyCredentialCreationOptions {\n        publicKey.challenge = bytesHelper.decodeBytes(publicKey.challenge.toString());\n        publicKey.user.id = bytesHelper.decodeBytes(publicKey.user.id.toString());\n        // ###In case we want to add excludeList in the future###\n        /* if (publicKey.excludeCredentials) {\n            for (let i = 0; i < publicKey.excludeCredentials.length; i++) {\n                const e = publicKey.excludeCredentials[i]\n                e.id = bytesHelper.DecodeBytes(e.id)\n            }\n        }*/\n        return publicKey;\n    }\n}\n","import { PassageUserInfo } from './types/PassageUserInfo';\nimport { Metadata, PassageMagicLinkRequest, PassageUser } from '.';\nimport { PassageEditDeviceRequest } from './types/PassageEditDeviceRequest';\nimport { PassageDevice } from './types/PassageDevice';\nimport BytesHelper from './BytesHelper.js';\nimport { PassageError, PassageErrorCode } from './PassageError';\nimport { handleResponse } from './utils/HandleResponse';\nimport AuthTokenHelper from './AuthTokenHelper';\nimport BrowserHelper from './BrowserHelper';\nimport { getHeaders } from './utils/GetHeaders';\nimport { Session } from './Session';\nimport { ReadOnlyTokenStore, TokenStore } from './TokenStore';\nimport { getBaseURL } from './utils/getBaseURL';\n\nconst bytesHelper = new BytesHelper();\nconst authTokenHelper = new AuthTokenHelper();\nconst browserHelper = new BrowserHelper();\n\n/**\n * The User class used to retrieve information about a Passage User.\n */\nexport class User {\n    private apiUrl: string;\n    private session: Session;\n\n    /**\n     * constructor for the User class.\n     * @param {string} [appID] the App's corresponding AppID\n     * @param {ReadOnlyTokenStore | TokenStore} [tokenStore] A tokenStore object that enables getting Passage User information from an externally stored token.\n     */\n    constructor(appID: string, private tokenStore: TokenStore | ReadOnlyTokenStore) {\n        this.apiUrl = getBaseURL(appID) + '/currentuser';\n        this.session = new Session(appID, this.tokenStore);\n    }\n\n    /**\n     * userInfo returns the user information for the currently authenticated user.\n     * @return {PassageCurrentUser | undefined} the current Passage user's info, or undefined if the\n     * current Passage user's authentication token could not be validated.\n     */\n    async userInfo(): Promise<PassageUserInfo | undefined> {\n        const token = await this._getToken();\n        const userInfoResponse = await fetch(this.apiUrl, {\n            method: 'GET',\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n            }),\n        })\n            .then(async (res) => {\n                if (res.status !== 200) return undefined;\n                const userInfo = await res.json();\n                return userInfo;\n            })\n            .catch((_) => {\n                throw new PassageError('Failed to fetch current user.', {\n                    status: PassageErrorCode.NotFound,\n                    statusText: 'Not Found',\n                });\n            });\n        return userInfoResponse?.user;\n    }\n\n    /**\n     * changeEmail initiate an email change for the authenticated user. An email change requires verification, so an email will be sent to the user which they must verify before the email change takes effect.\n     * @param {string} newEmail\n     * @param {string?} language the language string for localizing emails, if no lanuage or an invalid language is provided the application default lanuage will be used\n     * @return {PassageMagicLinkRequest} the magicLink response on success.\n     */\n    async changeEmail(newEmail: string, language?: string): Promise<PassageMagicLinkRequest> {\n        const token = await this._getToken();\n        const changeEmailResponse = await fetch(`${this.apiUrl}/email`, {\n            method: 'PATCH',\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'application/json',\n            }),\n            body: JSON.stringify({\n                new_email: newEmail,\n                language,\n            }),\n        }).then(handleResponse);\n\n        return changeEmailResponse.magic_link;\n    }\n\n    /**\n     * changePhone initiates a phone number change for the authenticated user. An phone number change requires verification, so an SMS with a link will be sent to the user which they must verify before the phone number change takes effect.\n     * @param {string} newPhone\n     * @param {string?} language the language string for localizing emails, if no lanuage or an invalid language is provided the application default lanuage will be used\n     * @return {PassageMagicLinkRequest} the magicLink response on success.\n     */\n    async changePhone(newPhone: string, language?: string): Promise<PassageMagicLinkRequest> {\n        const token = await this._getToken();\n        const changePhoneResponse = await fetch(`${this.apiUrl}/phone`, {\n            method: 'PATCH',\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'application/json',\n            }),\n            body: JSON.stringify({\n                new_phone: newPhone,\n                language,\n            }),\n        }).then(handleResponse);\n\n        return changePhoneResponse.magic_link;\n    }\n\n    /**\n     * editDevice is used to edit the current user's device attributes such as device_name\n     * @param {string} deviceID\n     * @param {PassageEditDeviceRequest} editDeviceRequest\n     * @return {PassageDevice} the edited device after applying the requested device attribute changes.\n     */\n    async editDevice(\n        deviceID: string,\n        editDeviceRequest: PassageEditDeviceRequest\n    ): Promise<PassageDevice> {\n        if (deviceID === '' || deviceID === undefined) {\n            throw new PassageError('A deviceID is required for an edit device request.', {\n                status: PassageErrorCode.BadRequest,\n                statusText: 'Bad Request',\n            });\n        }\n\n        if (Object.keys(editDeviceRequest).length === 0) {\n            throw new PassageError('Edit device request must not have an empty request body.', {\n                status: PassageErrorCode.BadRequest,\n                statusText: 'Bad Request',\n            });\n        }\n\n        const token = await this._getToken();\n        const passageDeviceResponse = await fetch(`${this.apiUrl}/devices/${deviceID}`, {\n            method: 'PATCH',\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'application/json',\n            }),\n            body: JSON.stringify({\n                ...editDeviceRequest,\n            }),\n        }).then(handleResponse);\n\n        return passageDeviceResponse.device;\n    }\n\n    /**\n     * listDevices is used to list the current user's devices.\n     * @param {string} deviceID\n     * @param {PassageEditDeviceRequest} editDeviceRequest\n     * @return {PassageDevice[]} the array of devices.\n     */\n    async listDevices(): Promise<PassageDevice[]> {\n        const token = await this._getToken();\n        const deviceResponse = await fetch(`${this.apiUrl}/devices/`, {\n            method: 'GET',\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'application/json',\n            }),\n        }).then(handleResponse);\n\n        return deviceResponse.devices;\n    }\n\n    /**\n     * addDevice is used to add a new webAuthn device for the current user.\n     * @return {PassageDevice} the new webAuthn device registered with Passage.\n     */\n    async addDevice(): Promise<PassageDevice> {\n        const token = await this._getToken();\n        const { createPassKeySupported } = await browserHelper.getBrowserInfo();\n        const webAuthnStartResponse = await fetch(this.apiUrl + '/devices/start', {\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n            }),\n            method: 'POST',\n        }).then(handleResponse);\n\n        const credential: PublicKeyCredential | null = await navigator.credentials\n            .create({\n                // @ts-ignore\n                publicKey: this._parsePublicKey(\n                    webAuthnStartResponse.handshake.challenge.publicKey\n                ),\n            })\n            .catch((_) => {\n                throw new PassageError('failed to parse public key', {\n                    status: PassageErrorCode.PSGParsePublicKeyForNewDeviceFailed,\n                    statusText: 'PSG Parse Public Key For New Device Failed',\n                });\n            })\n            .then((credValue) => {\n                return credValue as PublicKeyCredential;\n            });\n\n        let transports: string[] = [];\n        // getTransports() is not defined in all browsers (i.e. Firefox)\n        // make sure the function is defined before trying to use it\n        if (\n            // @ts-ignore\n            credential?.response.getTransports &&\n            // @ts-ignore\n            typeof credential?.response.getTransports === 'function'\n        ) {\n            // @ts-ignore\n            transports = credential?.response.getTransports();\n        }\n        const userID = webAuthnStartResponse.user.id;\n        const webAuthnFinishResponse = await fetch(this.apiUrl + '/devices/finish', {\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n            }),\n            method: 'POST',\n            body: JSON.stringify({\n                user_id: userID,\n                handshake_id: webAuthnStartResponse.handshake.id,\n                handshake_response: {\n                    rawId: bytesHelper.encodeBytes(credential?.rawId!),\n                    id: credential?.id,\n                    type: credential?.type,\n                    response: {\n                        attestationObject: bytesHelper.encodeBytes(\n                            // @ts-ignore\n                            credential?.response.attestationObject\n                        ),\n\n                        clientDataJSON: bytesHelper.encodeBytes(\n                            credential?.response.clientDataJSON!\n                        ),\n                    },\n                    transports: transports,\n                },\n                cred_type: createPassKeySupported ? 'passkey' : 'platform',\n            }),\n        }).then(handleResponse);\n\n        authTokenHelper.setPsgCredID(userID, credential);\n        return webAuthnFinishResponse.device;\n    }\n\n    /**\n     * deleteDevice deletes an existing webAuthn device for the current user.\n     * @param {string | PassageDevice} deviceID the ID of the device to be deleted or a PassageDevice object\n     * @return {boolean} true if the device has been deleted successfully.\n     */\n    async deleteDevice(deviceID: string | PassageDevice): Promise<boolean> {\n        // we do this type check for backwards compatibility\n        // old versions of passage-js 3.0.1 and earlier only accepted a deviceID string\n        // To support updating the psg_cred_obj we added support for passing a PassageDevice object as well\n        const typedID = typeof deviceID === 'string' ? deviceID : deviceID.id;\n        const credID = typeof deviceID === 'string' ? undefined : deviceID.cred_id;\n        if (!typedID) {\n            throw new PassageError('A deviceID is required to delete a device.', {\n                status: PassageErrorCode.NotFound,\n                statusText: 'Not Found',\n            });\n        }\n        let deviceResponse = false;\n        const token = await this._getToken();\n        deviceResponse = await fetch(`${this.apiUrl}/devices/${typedID}`, {\n            method: 'DELETE',\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'application/json',\n            }),\n        }).then(async (res) => {\n            if (!res.ok) {\n                return await res.text().then((psgErrorResponse) => {\n                    throw new PassageError(psgErrorResponse, res);\n                });\n            }\n            return true;\n        });\n\n        // if the remove was successful and we know the matching credID, remove from psg_cred_obj\n        if (deviceResponse && credID !== undefined) {\n            authTokenHelper.removeCredential(credID);\n        }\n        return deviceResponse;\n    }\n\n    /**\n     * getMetadata returns the metadata for the currently authenticated user.\n     * @return {Metadata | undefined} the current Passage user's info, or undefined if the\n     * current Passage user's authentication token could not be validated.\n     */\n    async getMetadata(): Promise<Metadata | undefined> {\n        const token = await this._getToken();\n        const metadataResponse = await fetch(`${this.apiUrl}/user-metadata`, {\n            method: 'GET',\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n            }),\n        }).then(handleResponse);\n\n        return metadataResponse.user_metadata;\n    }\n\n    /**\n     * updateMetadata updates the metadata for the currentuser. Note that only metadata fields set for the app can be updated.\n     * @param {Metadata} metadata\n     * @return {PassageUser} the current user with their newly updated metadata field.\n     */\n    async updateMetadata(metadata: Metadata): Promise<PassageUser> {\n        const token = await this._getToken();\n        const metadataUpdateResponse = await fetch(`${this.apiUrl}/user-metadata`, {\n            method: 'PATCH',\n            headers: getHeaders({\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'application/json',\n            }),\n            body: JSON.stringify({\n                user_metadata: metadata,\n            }),\n        }).then(handleResponse);\n\n        return metadataUpdateResponse.user;\n    }\n\n    /**\n     * Parse the public key via credential creation options.\n     * @param {PublicKeyCredentialCreationOptions} publicKey\n     * @return {PublicKeyCredentialCreationOptions}\n     */\n    private _parsePublicKey(\n        publicKey: PublicKeyCredentialCreationOptions\n    ): PublicKeyCredentialCreationOptions {\n        publicKey.challenge = bytesHelper.decodeBytes(publicKey.challenge.toString());\n        publicKey.user.id = bytesHelper.decodeBytes(publicKey.user.id.toString());\n        // ###In case we want to add excludeList in the future###\n        /* if (publicKey.excludeCredentials) {\n            for (let i = 0; i < publicKey.excludeCredentials.length; i++) {\n                const e = publicKey.excludeCredentials[i]\n                e.id = bytesHelper.DecodeBytes(e.id)\n            }\n        }*/\n        return publicKey;\n    }\n\n    /**\n     * Returns the external token if used or gets the current auth token, and performs a refresh operation if necessary.\n     * @return {Promise<string>}\n     */\n    private async _getToken(): Promise<string> {\n        return await this.session.getAuthToken();\n    }\n}\n","import jwtDecode, { JwtPayload } from 'jwt-decode';\nimport { PassageError, PassageErrorCode } from './PassageError';\nimport { getHeaders } from './utils/GetHeaders';\nimport { handleResponse } from './utils/HandleResponse';\nimport { authResult } from './Passage';\nimport { ReadOnlyTokenStore, TokenStore, isFullTokenStore } from './TokenStore';\nimport { getBaseURL } from './utils/getBaseURL';\n\ninterface JwtHeader {\n    alg: string;\n    typ: string;\n}\n\n/**\n * The Session class used to manage Passage sessions using refresh tokens.\n */\nexport class Session {\n    private apiUrl: string;\n\n    /**\n     * Session constructor initializing apiURL and identifier class vars\n     * @param {string} [appID] the App's corresponding AppID\n     * @param {ReadOnlyTokenStore | TokenStore} [tokenStore] A tokenStore object that enables getting Passage User information from an externally stored token.\n     * If the tokenStore implements the full TokenStore class, the Session will handle refreshing Passage sessions via the refresh token.\n     */\n    constructor(appID: string, private tokenStore: TokenStore | ReadOnlyTokenStore) {\n        this.apiUrl = getBaseURL(appID) + '/tokens/';\n    }\n\n    /**\n     * authGuard checks if the current user has a JWT that is valid and potentially verifiable.\n     * IMPORTANT: this is not verifying the JWT, it is only checking if the JWT is formatted properly.\n     * @return {boolean} true if the user has a valid (but unverified) JWT, false if not.\n     */\n    async authGuard(): Promise<boolean> {\n        try {\n            const authToken = await this.tokenStore.getAuthToken();\n            const header = jwtDecode<JwtHeader>(authToken, { header: true });\n            const payload = jwtDecode<JwtPayload>(authToken);\n            if (payload !== undefined && header !== undefined) {\n                if (this._validJWTPayload(payload) && this._validJWTHeader(header)) {\n                    return true;\n                }\n            }\n            return false;\n        } catch (e) {\n            return false;\n        }\n    }\n\n    /**\n     * Sign out a user by deleting their AuthToken from local storage and revoking their refresh token.\n     * @return {boolean} true if the device has been deleted successfully.\n     */\n    async signOut(): Promise<boolean> {\n        const refreshToken = await this.tokenStore.getRefreshToken();\n        if (!refreshToken) {\n            if (isFullTokenStore(this.tokenStore)) {\n                this.tokenStore.clearTokens();\n            }\n            return true;\n        }\n        return fetch(`${this.apiUrl}?` + new URLSearchParams({ refresh_token: refreshToken }), {\n            method: 'DELETE',\n        })\n            .then(({ status }) => status === 200)\n            .finally(() => {\n                if (isFullTokenStore(this.tokenStore)) {\n                    this.tokenStore.clearTokens();\n                }\n            });\n    }\n\n    /**\n     * getAuthToken gets the current authToken for the currently authenticated user.\n     * @return {string} returns the user's authToken if it exists or fetches a new one with a refresh token if it exists\n     */\n    async getAuthToken(): Promise<string> {\n        const authToken = await this.tokenStore.getAuthToken();\n        const refreshToken = await this.tokenStore.getRefreshToken();\n        if (refreshToken === undefined) {\n            // if there is no refresh token just pass through the auth token\n            // particularly important for the external token case in the User class with authorizers\n            return authToken;\n        }\n        const payload = jwtDecode<JwtPayload>(authToken);\n        if (payload !== undefined && this._validJWTPayload(payload)) {\n            return Promise.resolve(authToken);\n        }\n        return this.refresh().then((authResult) => authResult.auth_token);\n    }\n\n    /**\n     * refresh gets and saves a new authToken for the currently authenticated user using their refresh token\n     * @return {string} returns the user's authToken if successful\n     */\n    async refresh(): Promise<authResult> {\n        const err = new PassageError('Login required', {\n            status: PassageErrorCode.PSGLoginRequired,\n            statusText: 'Login required',\n        });\n        const refreshToken = this.tokenStore.getRefreshToken();\n        if (!refreshToken) return Promise.reject(err);\n        return fetch(this.apiUrl, {\n            headers: getHeaders(),\n            method: 'POST',\n            body: JSON.stringify({ refresh_token: refreshToken }),\n        })\n            .then(handleResponse)\n            .then((response: { auth_result: authResult }) => {\n                if (isFullTokenStore(this.tokenStore)) {\n                    this.tokenStore.setTokens(response.auth_result);\n                }\n                return response.auth_result;\n            })\n            .catch(() => {\n                throw err;\n            });\n    }\n\n    /**\n     * _validJWTPayload checks to see if the current JWT is valid (formatted as expected and isn't expired).\n     * @param {JwtPayload} payload the payload from the JWT.\n     * @return {boolean} true if the JWT payload is valid, false if not.\n     */\n    private _validJWTPayload(payload: JwtPayload): boolean {\n        const expectedKeys = ['exp', 'iss', 'sub'];\n        const currentTime = Math.floor(Date.now() / 1000);\n\n        expectedKeys.forEach((expectedKey) => {\n            if (!(expectedKey in payload)) return false;\n        });\n\n        if (payload.exp && currentTime > payload.exp) return false;\n        return true;\n    }\n\n    /**\n     * _validJWTHeader checkts to see if the JWT header is valid (formatted as expected).\n     * @param {JwtHeader} header the header from the JWT.\n     * @return {boolean} true if the JWT header is valid, false if not.\n     */\n    private _validJWTHeader(header: JwtHeader): boolean {\n        const expectedObject = { alg: 'RS256', typ: 'JWT' };\n\n        if (header.alg !== expectedObject.alg) return false;\n\n        if (header.typ !== expectedObject.typ) return false;\n        return true;\n    }\n}\n","import { env } from '../config/Environment';\n\n/**\n * Builds the base URL for Passage backend operations\n * @param {string} appID The app ID\n * @return {string} base URL\n */\nexport function getBaseURL(appID: string): string {\n    const baseUrl = env.URL;\n    const apiVersion = 'v1';\n    return `${baseUrl}/${apiVersion}/apps/${appID}`;\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Call an async function with a maximum time limit (in milliseconds) for the timeout\n * @param {Promise<any>} asyncPromise An asynchronous promise to resolve\n * @param {number} timeLimit Time limit to attempt function in milliseconds\n * @return {Promise<any>} Resolved promise for async function call\n */\nexport const asyncCallWithTimeout = async (\n    asyncPromise: Promise<any>,\n    timeLimit: number\n): Promise<any> => {\n    let timeoutHandle: any;\n\n    const timeoutPromise = new Promise((resolve) => {\n        timeoutHandle = setTimeout(resolve, timeLimit);\n    });\n\n    return Promise.race([asyncPromise, timeoutPromise]).then((result) => {\n        clearTimeout(timeoutHandle);\n        return result;\n    });\n};\n/* eslint-enable @typescript-eslint/no-explicit-any */\n","import { ErrorObject, serializeError } from 'serialize-error';\nimport { env } from './config/Environment';\n\nexport type PassageSentryProject = 'passage-js' | 'passage-elements';\n\nexport interface ISentryConfig {\n    url?: string;\n    project?: PassageSentryProject;\n    dsn?: string;\n    environment?: string;\n    release?: string;\n    version?: string;\n}\n\nexport interface ICaptureEventProps {\n    error?: Error | string;\n    message?: string;\n    sentryConfig?: ISentryConfig;\n}\n\nexport interface CaptureEventBody {\n    error?: Error | string;\n    serializedError?: ErrorObject;\n    message?: string;\n    project: PassageSentryProject;\n    release?: string;\n    dsn?: string;\n    environment?: string;\n    version?: string;\n}\n\nexport const cleanSentryConfig = (config: ISentryConfig): ISentryConfig => {\n    return JSON.parse(\n        JSON.stringify(config, (key, value): unknown => {\n            if (value === null || value === undefined || value === 'undefined') {\n                return undefined;\n            }\n            return value;\n        })\n    );\n};\n\nexport const captureEvent = async (props: ICaptureEventProps): Promise<void> => {\n    try {\n        const {\n            error,\n            message,\n            sentryConfig: {\n                url = env.CAPTURE_EVENT_URL,\n                project = env.SENTRY_PROJECT,\n                dsn = env.SENTRY_PROJECT_DSN,\n                environment = env.SENTRY_PROJECT_ENV,\n                release = env.SENTRY_RELEASE,\n                version = env.SENTRY_PROJECT_VERSION,\n            } = {},\n        } = props;\n\n        const sentryConfig = cleanSentryConfig({\n            project,\n            dsn,\n            environment,\n            url,\n            release,\n            version,\n        });\n\n        if (!(sentryConfig.project && sentryConfig.url) || !(error || message)) {\n            return;\n        }\n\n        let body: CaptureEventBody = {\n            project: sentryConfig.project,\n            dsn: sentryConfig.dsn,\n            environment: sentryConfig.environment,\n            release: sentryConfig.release,\n            version: sentryConfig.version,\n        };\n\n        if (message) {\n            body = {\n                ...body,\n                message,\n            };\n        }\n\n        if (error) {\n            body = {\n                ...body,\n                serializedError: serializeError(\n                    typeof error === 'string' ? new Error(error) : error\n                ),\n            };\n        }\n\n        await fetch(sentryConfig.url, {\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json',\n            },\n            method: 'POST',\n            body: JSON.stringify(body),\n        });\n    } catch (error) {\n        console.error(error);\n    }\n    return;\n};\n\nexport default captureEvent;\n","/* eslint-disable no-unused-vars */\n/* eslint-disable camelcase */\n\nexport enum Identifier {\n    email = 'email',\n    phone = 'phone',\n    both = 'both',\n}\n\nexport enum RequiredIdentifier {\n    Phone = 'phone',\n    Email = 'email',\n    Both = 'both',\n    Either = 'either',\n}\n\nexport enum UserMetadataType {\n    STRING = 'string',\n    BOOLEAN = 'boolean',\n    INTEGER = 'integer',\n    DATE = 'date',\n    PHONE = 'phone',\n    EMAIL = 'email',\n}\n\nexport interface UserMetadataSchema {\n    id: string;\n    field_name: string;\n    type: UserMetadataType;\n    friendly_name: string;\n    registration: boolean;\n    profile: boolean;\n}\n\nexport interface UserMetadataLayout {\n    id: string;\n    x: number;\n    y: number;\n    w: number;\n    h: number;\n}\n\nexport interface PassageAppInfo {\n    name: string;\n    id: string;\n    auth_origin: string;\n    redirect_url: string;\n    rsa_public_key: string;\n    ephemeral: boolean;\n    allowed_identifier: Identifier;\n    require_identifier_verification: boolean;\n    session_timeout_length: number;\n    required_identifier: RequiredIdentifier;\n    user_metadata_schema: UserMetadataSchema[];\n    layouts: {\n        profile: UserMetadataLayout[];\n        registration: UserMetadataLayout[];\n    };\n    public_signup: boolean;\n    default_language: string;\n}\n","export interface PassageMagicLinkRequest {\n    id: string;\n}\n","/* eslint-disable no-unused-vars */\nexport enum PassageUserStatus {\n    ACTIVE = 'active',\n    INACTIVE = 'inactive',\n    PENDING = 'pending',\n}\n\nexport enum WebAuthnType {\n    Platform = 'platform',\n    Passkey = 'passkey',\n}\n\nexport interface PassageUser {\n    id: string;\n    webauthn: boolean;\n    webauthn_types: WebAuthnType[];\n    status: PassageUserStatus;\n    email?: string;\n    email_verified: boolean;\n    phone?: string;\n    phone_verified: boolean;\n    user_metadata?: object | null;\n}\n\nexport interface Metadata {\n    [key: string]: boolean | string | number;\n}\n\nexport interface CreateUserPayload {\n    identifier: string;\n    user_metadata?: Metadata;\n}\n","import { PassageDevice } from './PassageDevice';\nimport { Metadata, WebAuthnType } from './PassageUser';\n\nexport interface PassageUserInfo {\n    created_at: string;\n    update_at: string;\n    status: string;\n    id: string;\n    email: string;\n    email_verified: boolean;\n    phone: string;\n    phone_verified: boolean;\n    webauthn: boolean;\n    webauthn_devices: PassageDevice[];\n    last_login_at: string;\n    login_count: number;\n    user_metadata: Metadata | null;\n    webauthn_types: WebAuthnType[];\n}\n","import { WebAuthnType } from './PassageUser';\n\nexport interface PassageDevice {\n    id: string;\n    cred_id: string;\n    friendly_name: string;\n    usage_count: number;\n    updated_at: string;\n    created_at: string;\n    last_login_at: string;\n    type: WebAuthnType;\n    user_id: string;\n}\n","export interface PassageEditDeviceRequest {\n    friendly_name: string;\n}\n"],"mappings":"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","names":["init_cjs_shims","__esmMin","require_ua_parser","__commonJSMin","exports","module","init_cjs_shims","window","undefined","LIBVERSION","EMPTY","UNKNOWN","FUNC_TYPE","UNDEF_TYPE","OBJ_TYPE","STR_TYPE","MAJOR","MODEL","NAME","TYPE","VENDOR","VERSION","ARCHITECTURE","CONSOLE","MOBILE","TABLET","SMARTTV","WEARABLE","EMBEDDED","UA_MAX_LENGTH","AMAZON","APPLE","ASUS","BLACKBERRY","BROWSER","CHROME","EDGE","FIREFOX","GOOGLE","HUAWEI","LG","MICROSOFT","MOTOROLA","OPERA","SAMSUNG","SHARP","SONY","XIAOMI","ZEBRA","FACEBOOK","extend","regexes","extensions","mergedRegexes","i","enumerize","arr","enums","has","str1","str2","lowerize","str","majorize","version","trim","len","rgxMapper","ua","arrays","j","k","p","q","matches","match","regex","props","strMapper","map","oldSafariMap","windowsVersionMap","UAParser","_ua","_rgxmap","_browser","_cpu","_device","_engine","_os","$","parser","result","prop","src_exports","__export","Identifier","Passage","PassageError","PassageErrorCode","PassageTokenStore","PassageUserStatus","ReadOnlyTokenStore","RequiredIdentifier","Session","TokenStore","User","UserMetadataType","WebAuthnType","captureEvent","cleanSentryConfig","isFullTokenStore","__toCommonJS","init_cjs_shims","init_cjs_shims","init_cjs_shims","init_cjs_shims","BytesHelper","arrayBuffer","b64URLStr","removePadding","b64Str","b64StrWithoutPadding","c","s","padIdx","init_cjs_shims","init_cjs_shims","PassageError","psgErrorResponse","res","PassageErrorCode","import_js_cookie","bytesHelper","BytesHelper","AuthTokenHelper","responseBody1","userID","allowCredentials","psgCredObj","PassageError","psgCredID","credential","passageCredentialObject","parsedCredentialObject","credID","cookieCredObj","Cookies","localStorageCredObj","value","init_cjs_shims","import_ua_parser_js","BrowserHelper","UaParser","init_cjs_shims","handleResponse","res","psgErrorResponse","PassageError","init_cjs_shims","_isFirefox98Win","isFirefox","match","firefoxVersion","_modifyAttestationObject","object","first","rest","buffer","newFirefoxBuffer","updateLength","init_cjs_shims","init_cjs_shims","init_cjs_shims","env_config_default","env","env_config_default","getHeaders","init","headers","version","env","init_cjs_shims","init_cjs_shims","ReadOnlyTokenStore","TokenStore","PassageTokenStore","f","localToken","err","PassageError","authToken","leaveUnsecure","refreshToken","authResult","isFullTokenStore","store","isAuthResponse","res","storeResponseTokens","tokenStore","isFullTokenStore","bytesHelper","BytesHelper","authTokenHelper","AuthTokenHelper","browserHelper","BrowserHelper","SignUp","baseUrl","tokenStore","identifier","createPassKeySupported","webAuthnStartResponse","getHeaders","handleResponse","credential","_","PassageError","credValue","attestationObject","_isFirefox98Win","_modifyAttestationObject","transports","userID","webAuthnFinishResponse","response","storeResponseTokens","publicKey","init_cjs_shims","bytesHelper","BytesHelper","LogIn","baseUrl","tokenStore","identifier","identifierBody","body","webAuthnStartResponse","getHeaders","handleResponse","assertion","err","PassageError","credValue","response","storeResponseTokens","publicKey","i","e","init_cjs_shims","UnAuth","baseUrl","getHeaders","handleResponse","identifier","init_cjs_shims","bytesHelper","BytesHelper","authTokenHelper","AuthTokenHelper","MagicLink","baseUrl","tokenStore","identifier","language","getHeaders","handleResponse","id","response","storeResponseTokens","magicLink","webAuthnStartResponse","PassageError","assertion","_","credential","attestationObject","_isFirefox98Win","_modifyAttestationObject","webAuthnFinishResponse","userID","publicKey","i","e","init_cjs_shims","init_cjs_shims","import_jwt_decode","init_cjs_shims","getBaseURL","appID","env","Session","appID","tokenStore","getBaseURL","authToken","header","jwtDecode","payload","refreshToken","status","isFullTokenStore","authResult","err","PassageError","getHeaders","handleResponse","response","expectedKeys","currentTime","expectedKey","expectedObject","bytesHelper","BytesHelper","authTokenHelper","AuthTokenHelper","browserHelper","BrowserHelper","User","appID","tokenStore","getBaseURL","Session","token","userInfoResponse","getHeaders","res","_","PassageError","newEmail","language","handleResponse","newPhone","deviceID","editDeviceRequest","createPassKeySupported","webAuthnStartResponse","credential","credValue","transports","userID","webAuthnFinishResponse","typedID","credID","deviceResponse","psgErrorResponse","metadata","publicKey","init_cjs_shims","asyncCallWithTimeout","asyncPromise","timeLimit","timeoutHandle","timeoutPromise","resolve","result","Passage","appID","config","getBaseURL","PassageTokenStore","userID","psgCredObj","AuthTokenHelper","identifier","SignUp","LogIn","UnAuth","BrowserHelper","appInfo","webauthnAllowed","roaming","webauthn","asyncCallWithTimeout","available","language","MagicLink","userMagicLink","id","User","Session","payload","getHeaders","handleResponse","init_cjs_shims","import_serialize_error","cleanSentryConfig","config","key","value","captureEvent","props","error","message","url","env","project","dsn","environment","release","version","sentryConfig","body","init_cjs_shims","Identifier","RequiredIdentifier","UserMetadataType","init_cjs_shims","init_cjs_shims","PassageUserStatus","WebAuthnType","init_cjs_shims","init_cjs_shims","init_cjs_shims"]}