var rt=Object.create;var Ke=Object.defineProperty;var nt=Object.getOwnPropertyDescriptor;var ot=Object.getOwnPropertyNames;var st=Object.getPrototypeOf,at=Object.prototype.hasOwnProperty;var lt=(l,e)=>()=>(l&&(e=l(l=0)),e);var ut=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports);var ct=(l,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ot(e))!at.call(l,n)&&n!==t&&Ke(l,n,{get:()=>e[n],enumerable:!(i=nt(e,n))||i.enumerable});return l};var pt=(l,e,t)=>(t=l!=null?rt(st(l)):{},ct(e||!l||!l.__esModule?Ke(t,"default",{value:l,enumerable:!0}):t,l));var p=lt(()=>{});var ze=ut((ee,fe)=>{p();(function(l,e){"use strict";var t="1.0.33",i="",n="?",P="function",h="undefined",x="object",O="string",D="major",o="model",u="name",s="type",a="vendor",c="version",B="architecture",V="console",f="mobile",d="tablet",N="smarttv",Y="wearable",Be="embedded",Se=350,ve="Amazon",oe="Apple",Ie="ASUS",je="BlackBerry",H="Browser",se="Chrome",et="Edge",ae="Firefox",le="Google",De="Huawei",_e="LG",Te="Microsoft",Ce="Motorola",ue="Opera",Pe="Samsung",Ee="Sharp",ce="Sony",Re="Xiaomi",xe="Zebra",qe="Facebook",tt=function(m,k){var g={};for(var R in m)k[R]&&k[R].length%2===0?g[R]=k[R].concat(m[R]):g[R]=m[R];return g},pe=function(m){for(var k={},g=0;g<m.length;g++)k[m[g].toUpperCase()]=m[g];return k},Fe=function(m,k){return typeof m===O?Z(k).indexOf(Z(m))!==-1:!1},Z=function(m){return m.toLowerCase()},it=function(m){return typeof m===O?m.replace(/[^\d\.]/g,i).split(".")[0]:e},Oe=function(m,k){if(typeof m===O)return m=m.replace(/^\s\s*/,i),typeof k===h?m:m.substring(0,Se)},X=function(m,k){for(var g=0,R,w,de,T,Q,C;g<k.length&&!Q;){var He=k[g],Ge=k[g+1];for(R=w=0;R<He.length&&!Q;)if(Q=He[R++].exec(m),Q)for(de=0;de<Ge.length;de++)C=Q[++w],T=Ge[de],typeof T===x&&T.length>0?T.length===2?typeof T[1]==P?this[T[0]]=T[1].call(this,C):this[T[0]]=T[1]:T.length===3?typeof T[1]===P&&!(T[1].exec&&T[1].test)?this[T[0]]=C?T[1].call(this,C,T[2]):e:this[T[0]]=C?C.replace(T[1],T[2]):e:T.length===4&&(this[T[0]]=C?T[3].call(this,C.replace(T[1],T[2])):e):this[T]=C||e;g+=2}},Ae=function(m,k){for(var g in k)if(typeof k[g]===x&&k[g].length>0){for(var R=0;R<k[g].length;R++)if(Fe(k[g][R],m))return g===n?e:g}else if(Fe(k[g],m))return g===n?e:g;return m},r={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Me={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Je={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[c,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[c,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,c],[/opios[\/ ]+([\w\.]+)/i],[c,[u,ue+" Mini"]],[/\bopr\/([\w\.]+)/i],[c,[u,ue]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[u,c],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[c,[u,"UC"+H]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[c,[u,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[c,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[c,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[c,[u,"IE"]],[/yabrowser\/([\w\.]+)/i],[c,[u,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+H],c],[/\bfocus\/([\w\.]+)/i],[c,[u,ae+" Focus"]],[/\bopt\/([\w\.]+)/i],[c,[u,ue+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[c,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[c,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[c,[u,ue+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[c,[u,"MIUI "+H]],[/fxios\/([-\w\.]+)/i],[c,[u,ae]],[/\bqihu|(qi?ho?o?|360)browser/i],[[u,"360 "+H]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1 "+H],c],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],c],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[u,c],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,qe],c],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[u,c],[/\bgsa\/([\w\.]+) .*safari\//i],[c,[u,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[c,[u,se+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,se+" WebView"],c],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[c,[u,"Android "+H]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,c],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[c,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[c,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[c,Ae,r]],[/(webkit|khtml)\/([\w\.]+)/i],[u,c],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],c],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[c,[u,ae+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[u,c],[/(cobalt)\/([\w\.]+)/i],[u,[c,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[B,"amd64"]],[/(ia32(?=;))/i],[[B,Z]],[/((?:i[346]|x)86)[;\)]/i],[[B,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[B,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[B,"armhf"]],[/windows (ce|mobile); ppc;/i],[[B,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[B,/ower/,i,Z]],[/(sun4\w)[;\)]/i],[[B,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[B,Z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[o,[a,Pe],[s,d]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[o,[a,Pe],[s,f]],[/\((ip(?:hone|od)[\w ]*);/i],[o,[a,oe],[s,f]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[o,[a,oe],[s,d]],[/(macintosh);/i],[o,[a,oe]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[o,[a,De],[s,d]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[o,[a,De],[s,f]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[o,/_/g," "],[a,Re],[s,f]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[o,/_/g," "],[a,Re],[s,d]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[o,[a,"OPPO"],[s,f]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[o,[a,"Vivo"],[s,f]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[o,[a,"Realme"],[s,f]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[o,[a,Ce],[s,f]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[o,[a,Ce],[s,d]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[o,[a,_e],[s,d]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[o,[a,_e],[s,f]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[o,[a,"Lenovo"],[s,d]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[o,/_/g," "],[a,"Nokia"],[s,f]],[/(pixel c)\b/i],[o,[a,le],[s,d]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[o,[a,le],[s,f]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[a,ce],[s,f]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[o,"Xperia Tablet"],[a,ce],[s,d]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[o,[a,"OnePlus"],[s,f]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[o,[a,ve],[s,d]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[o,/(.+)/g,"Fire Phone $1"],[a,ve],[s,f]],[/(playbook);[-\w\),; ]+(rim)/i],[o,a,[s,d]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[o,[a,je],[s,f]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[o,[a,Ie],[s,d]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[o,[a,Ie],[s,f]],[/(nexus 9)/i],[o,[a,"HTC"],[s,d]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[a,[o,/_/g," "],[s,f]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[o,[a,"Acer"],[s,d]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[o,[a,"Meizu"],[s,f]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[o,[a,Ee],[s,f]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[a,o,[s,f]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[a,o,[s,d]],[/(surface duo)/i],[o,[a,Te],[s,d]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[o,[a,"Fairphone"],[s,f]],[/(u304aa)/i],[o,[a,"AT&T"],[s,f]],[/\bsie-(\w*)/i],[o,[a,"Siemens"],[s,f]],[/\b(rct\w+) b/i],[o,[a,"RCA"],[s,d]],[/\b(venue[\d ]{2,7}) b/i],[o,[a,"Dell"],[s,d]],[/\b(q(?:mv|ta)\w+) b/i],[o,[a,"Verizon"],[s,d]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[o,[a,"Barnes & Noble"],[s,d]],[/\b(tm\d{3}\w+) b/i],[o,[a,"NuVision"],[s,d]],[/\b(k88) b/i],[o,[a,"ZTE"],[s,d]],[/\b(nx\d{3}j) b/i],[o,[a,"ZTE"],[s,f]],[/\b(gen\d{3}) b.+49h/i],[o,[a,"Swiss"],[s,f]],[/\b(zur\d{3}) b/i],[o,[a,"Swiss"],[s,d]],[/\b((zeki)?tb.*\b) b/i],[o,[a,"Zeki"],[s,d]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[a,"Dragon Touch"],o,[s,d]],[/\b(ns-?\w{0,9}) b/i],[o,[a,"Insignia"],[s,d]],[/\b((nxa|next)-?\w{0,9}) b/i],[o,[a,"NextBook"],[s,d]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[a,"Voice"],o,[s,f]],[/\b(lvtel\-)?(v1[12]) b/i],[[a,"LvTel"],o,[s,f]],[/\b(ph-1) /i],[o,[a,"Essential"],[s,f]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[o,[a,"Envizen"],[s,d]],[/\b(trio[-\w\. ]+) b/i],[o,[a,"MachSpeed"],[s,d]],[/\btu_(1491) b/i],[o,[a,"Rotor"],[s,d]],[/(shield[\w ]+) b/i],[o,[a,"Nvidia"],[s,d]],[/(sprint) (\w+)/i],[a,o,[s,f]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[a,Te],[s,f]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[o,[a,xe],[s,d]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[o,[a,xe],[s,f]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[a,o,[s,V]],[/droid.+; (shield) bui/i],[o,[a,"Nvidia"],[s,V]],[/(playstation [345portablevi]+)/i],[o,[a,ce],[s,V]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[o,[a,Te],[s,V]],[/smart-tv.+(samsung)/i],[a,[s,N]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[a,Pe],[s,N]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[a,_e],[s,N]],[/(apple) ?tv/i],[a,[o,oe+" TV"],[s,N]],[/crkey/i],[[o,se+"cast"],[a,le],[s,N]],[/droid.+aft(\w)( bui|\))/i],[o,[a,ve],[s,N]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[o,[a,Ee],[s,N]],[/(bravia[\w ]+)( bui|\))/i],[o,[a,ce],[s,N]],[/(mitv-\w{5}) bui/i],[o,[a,Re],[s,N]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[a,Oe],[o,Oe],[s,N]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[s,N]],[/((pebble))app/i],[a,o,[s,Y]],[/droid.+; (glass) \d/i],[o,[a,le],[s,Y]],[/droid.+; (wt63?0{2,3})\)/i],[o,[a,xe],[s,Y]],[/(quest( 2)?)/i],[o,[a,qe],[s,Y]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[a,[s,Be]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[o,[s,f]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[o,[s,d]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[s,d]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[s,f]],[/(android[-\w\. ]{0,9});.+buil/i],[o,[a,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[c,[u,et+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[c,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[u,c],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[c,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,c],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[u,[c,Ae,Me]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[u,"Windows"],[c,Ae,Me]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[c,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,"Mac OS"],[c,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[c,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[u,c],[/\(bb(10);/i],[c,[u,je]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[c,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[c,[u,ae+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[c,[u,"webOS"]],[/crkey\/([\d\.]+)/i],[c,[u,se+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[u,"Chromium OS"],c],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,c],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],c],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[u,c]]},A=function(m,k){if(typeof m===x&&(k=m,m=e),!(this instanceof A))return new A(m,k).getResult();var g=m||(typeof l!==h&&l.navigator&&l.navigator.userAgent?l.navigator.userAgent:i),R=k?tt(Je,k):Je;return this.getBrowser=function(){var w={};return w[u]=e,w[c]=e,X.call(w,g,R.browser),w.major=it(w.version),w},this.getCPU=function(){var w={};return w[B]=e,X.call(w,g,R.cpu),w},this.getDevice=function(){var w={};return w[a]=e,w[o]=e,w[s]=e,X.call(w,g,R.device),w},this.getEngine=function(){var w={};return w[u]=e,w[c]=e,X.call(w,g,R.engine),w},this.getOS=function(){var w={};return w[u]=e,w[c]=e,X.call(w,g,R.os),w},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return g},this.setUA=function(w){return g=typeof w===O&&w.length>Se?Oe(w,Se):w,this},this.setUA(g),this};A.VERSION=t,A.BROWSER=pe([u,c,D]),A.CPU=pe([B]),A.DEVICE=pe([o,a,s,V,f,N,d,Y,Be]),A.ENGINE=A.OS=pe([u,c]),typeof ee!==h?(typeof fe!==h&&fe.exports&&(ee=fe.exports=A),ee.UAParser=A):typeof define===P&&define.amd?define(function(){return A}):typeof l!==h&&(l.UAParser=A);var G=typeof l!==h&&(l.jQuery||l.Zepto);if(G&&!G.ua){var he=new A;G.ua=he.getResult(),G.ua.get=function(){return he.getUA()},G.ua.set=function(m){he.setUA(m);var k=he.getResult();for(var g in k)G.ua[g]=k[g]}}})(typeof window=="object"?window:ee)});p();p();p();p();var U=class{encodeBytes(e){let i=btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\+/g,"-").replace(/\//g,"_");return We(i)}decodeBytes(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),i=We(t);return Uint8Array.from(atob(i),P=>P.charCodeAt(0))}},We=l=>{let e=l.indexOf("=");return l.slice(0,e===-1?l.length:e)};p();p();var _=class extends Error{constructor(t,i){super();this.name="PassageError",this.statusCode=i.status,this.statusText=i.statusText,this.message=this._parsePsgErrorResponse(t)}_parsePsgErrorResponse(t){try{return t=JSON.parse(t),t.error?t.error:""}catch{return t}}},M=(r=>(r[r.MultipleChoice=300]="MultipleChoice",r[r.MovedPermanantly=301]="MovedPermanantly",r[r.Found=302]="Found",r[r.SeeOther=303]="SeeOther",r[r.NotModified=304]="NotModified",r[r.TemporaryRedirect=307]="TemporaryRedirect",r[r.PermanentRedirect=308]="PermanentRedirect",r[r.BadRequest=400]="BadRequest",r[r.Unauthorized=401]="Unauthorized",r[r.PaymentRequired=402]="PaymentRequired",r[r.Forbidden=403]="Forbidden",r[r.NotFound=404]="NotFound",r[r.MethodNotAllowed=405]="MethodNotAllowed",r[r.NotAcceptable=406]="NotAcceptable",r[r.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",r[r.RequestTimeout=408]="RequestTimeout",r[r.Conflict=409]="Conflict",r[r.Gone=410]="Gone",r[r.LengthRequired=411]="LengthRequired",r[r.PreconditionFailed=412]="PreconditionFailed",r[r.PayloadTooLarge=413]="PayloadTooLarge",r[r.URITooLong=414]="URITooLong",r[r.UnsupportedMediaType=415]="UnsupportedMediaType",r[r.RangeNotSatisfiable=416]="RangeNotSatisfiable",r[r.ExpectationFailed=417]="ExpectationFailed",r[r.MisdirectedRequest=421]="MisdirectedRequest",r[r.UnprocessableEntity=422]="UnprocessableEntity",r[r.Locked=423]="Locked",r[r.FailedDependency=424]="FailedDependency",r[r.TooEarly=425]="TooEarly",r[r.UpgradeRequired=426]="UpgradeRequired",r[r.PreconditionRequired=428]="PreconditionRequired",r[r.TooManyRequests=429]="TooManyRequests",r[r.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",r[r.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",r[r.InternalServerError=500]="InternalServerError",r[r.NotImplemented=501]="NotImplemented",r[r.BadGateway=502]="BadGateway",r[r.ServiceUnavailable=503]="ServiceUnavailable",r[r.GatewayTimeout=504]="GatewayTimeout",r[r.HTTPVersionNotSupported=505]="HTTPVersionNotSupported",r[r.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",r[r.InsufficientStorage=507]="InsufficientStorage",r[r.LoopDetected=508]="LoopDetected",r[r.NotExtended=510]="NotExtended",r[r.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",r[r.PSGCredObjectDoesNotExist=700]="PSGCredObjectDoesNotExist",r[r.PSGParsePublicKeyForNewDeviceFailed=701]="PSGParsePublicKeyForNewDeviceFailed",r[r.PSGParsePublicKeyForLoginFailed=702]="PSGParsePublicKeyForLoginFailed",r[r.PSGCouldNotGetUserCredential=703]="PSGCouldNotGetUserCredential",r[r.PSGLoginRequired=704]="PSGLoginRequired",r))(M||{});import me from"js-cookie";var ge=new U,I=class{psgCredIDExists(e){let t=e.user.id,i=e.handshake.challenge.publicKey.allowCredentials,n=this.getPsgCredObj();if(!n)throw new _("Could not get psg_cred_obj",{status:700,statusText:"PSG Cred Object Does Not Exist"});let P=JSON.parse(n)[t];return P?i.find(x=>{if(ge.encodeBytes(ge.decodeBytes(x.id))===ge.encodeBytes(ge.decodeBytes(P)))return!0}):!1}setPsgCredID(e,t){if(!t)throw new _("Could not get user's credential",{status:703,statusText:"PSG Could Not Get User Credential"});let i=this.getPsgCredObj();if(i){let n=JSON.parse(i);n[e]=t==null?void 0:t.id,this.setPsgCredObj(JSON.stringify(n))}else this.setPsgCredObj(JSON.stringify({[e]:t==null?void 0:t.id}))}removeCredential(e){let t=this.getPsgCredObj();if(t===void 0)return;let i=JSON.parse(t);Object.keys(i).forEach(n=>{i[n]===e&&delete i[n]}),this.setPsgCredObj(JSON.stringify(i))}getPsgCredObj(){let e=me.get("psg_cred_obj"),t=localStorage.getItem("psg_cred_obj");if(e!==void 0)return me.set("psg_cred_obj",e,{expires:400,sameSite:"Strict"}),t===null&&localStorage.setItem("psg_cred_obj",e),e;if(t!==null)return me.set("psg_cred_obj",t,{expires:400,sameSite:"Strict"}),t}setPsgCredObj(e){me.set("psg_cred_obj",e,{expires:400,sameSite:"Strict"}),localStorage.setItem("psg_cred_obj",e)}};p();var $e=pt(ze(),1),q=class{constructor(){this.userAgent=new $e.default}async getBrowserInfo(){return{createPassKeySupported:await this._canBrowserCreatePassKey(),getPassKeySupported:await this._canBrowserGetPasskey(),conditionalUISupported:await this._isConditionalMediationAvailable()}}async _canBrowserCreatePassKey(){return!!(this._isiOSPasskeySupported()||this._isMacPasskeySupported())}_canBrowserGetPasskey(){return this._isiOSPasskeySupported()||this._isMacPasskeySupported()||this._isDesktopChrome108()?Promise.resolve(!0):Promise.resolve(!1)}async _isConditionalMediationAvailable(){return!1}_isiOSPasskeySupported(){return this.userAgent.getOS().name=="iOS"&&parseFloat(this.userAgent.getOS().version||"")>=16}_isMacPasskeySupported(){return this.userAgent.getBrowser().name=="Safari"&&parseFloat(this.userAgent.getBrowser().version||"")>=16&&this.userAgent.getOS().name=="Mac OS"}_isDesktopChrome108(){return this.userAgent.getBrowser().name=="Chrome"&&parseFloat(this.userAgent.getBrowser().version||"")>=108}};p();async function y(l){return l.ok?l.json():await l.text().then(e=>{throw new _(e,l)})}p();function we(){let l=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,e=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./),t=e?parseInt(e[1]):0;return navigator.platform.indexOf("Win")!==-1&&l&&t===98}function be(l){let e=new Uint8Array(68);e.set(l.slice(0,68));let t=new Uint8Array(l.byteLength-68);t.set(l.slice(68,l.byteLength));let i=new Uint8Array(15),n=new Uint8Array(e.byteLength+i.byteLength+t.byteLength);n.set(e,0),n.set(i,e.byteLength),n.set(t,e.byteLength+i.byteLength);let P=n[30]+15;return n.set([P],30),n}p();p();p();var Ve={URL:"https://auth.passage.id",version:"@passageidentity/passage-js 3.1.0",CAPTURE_EVENT_URL:"https://us-central1-passage-prod.cloudfunctions.net/capture-event",SENTRY_RELEASE:"passage-js@3.1.0-prod",SENTRY_PROJECT:"passage-js",SENTRY_PROJECT_DSN:"",SENTRY_PROJECT_ENV:"prod",SENTRY_PROJECT_VERSION:"3.1.0"};var j=Ve;function b(l){let e=new Headers(l),t=j.version;return t&&e.append("Passage-Version",t),e}p();p();var Ue=class{getRefreshToken(){return Promise.resolve(void 0)}},Ne=class extends Ue{clearTokens(){return Promise.resolve()}},ye=class extends Ne{constructor(){super(...arguments);this.noLocalStorage=typeof window>"u";this.noLocalStorageError=t=>"Failed to access localStorage or cookies. Must be run client-side."}getAuthToken(){if(this.noLocalStorage)return Promise.reject(this.noLocalStorageError("getAuthToken"));let t=localStorage.getItem("psg_auth_token");if(t===null){let i=new _("Login required",{status:704,statusText:"Login required"});return Promise.reject(i)}return Promise.resolve(t)}setAuthToken(t){if(this.noLocalStorage)return Promise.reject(this.noLocalStorageError("setAuthToken"));localStorage.setItem("psg_auth_token",t);let i=!this._isHttps()&&this._isLocalHost();return document.cookie=`psg_auth_token = ${t}; path=/ ${i?"":";secure"}`,Promise.resolve()}getRefreshToken(){this.noLocalStorage&&Promise.reject(this.noLocalStorageError("getRefreshToken"));let t=localStorage.getItem("psg_refresh_token");return t===null?Promise.resolve(void 0):Promise.resolve(t)}setRefreshToken(t){return this.noLocalStorage&&Promise.reject(this.noLocalStorageError("setRefreshToken")),localStorage.setItem("psg_refresh_token",t),Promise.resolve()}setTokens(t){return this.noLocalStorage&&Promise.reject(this.noLocalStorageError("setTokens")),this.setAuthToken(t.auth_token),t.refresh_token&&this.setRefreshToken(t.refresh_token),Promise.resolve()}clearTokens(){return this.noLocalStorage&&Promise.reject(this.noLocalStorageError("clearTokens")),localStorage.removeItem("psg_auth_token"),document.cookie="psg_auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC;",localStorage.removeItem("psg_refresh_token"),Promise.resolve()}_isLocalHost(){return Boolean(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))}_isHttps(){return location.protocol==="https:"}};function K(l){return l.setTokens!==void 0}var ht=l=>typeof l=="object"&&l!==null&&typeof l.auth_result<"u";function F(l,e){return ht(l)?(K(e)&&e.setTokens(l.auth_result),l):(console.warn("Not a valid auth response"),l)}var te=new U,dt=new I,mt=new q,ie=class{constructor(e,t,i){this.tokenStore=t;this.apiUrl=e+"/register/",this.identifier=i}async withWebAuthn(){let{createPassKeySupported:e}=await mt.getBrowserInfo(),t=await fetch(this.apiUrl+"webauthn/start",{headers:b(),body:JSON.stringify({identifier:this.identifier}),method:"POST"}).then(y),i=await navigator.credentials.create({publicKey:this._parsePublicKey(t.handshake.challenge.publicKey)}).catch(O=>{throw new _("error parsing public key for webAuthn",{status:702,statusText:"PSG Parse Public Key For Login Failed"})}).then(O=>O),n=new Uint8Array(i==null?void 0:i.response.attestationObject);we()&&(n=be(n));let P=[];(i==null?void 0:i.response.getTransports)&&typeof(i==null?void 0:i.response.getTransports)=="function"&&(P=i==null?void 0:i.response.getTransports());let h=t.user.id,x=await fetch(this.apiUrl+"webauthn/finish",{headers:b(),method:"POST",body:JSON.stringify({user_id:h,handshake_id:t.handshake.id,handshake_response:{rawId:te.encodeBytes(i==null?void 0:i.rawId),id:i==null?void 0:i.id,type:i==null?void 0:i.type,response:{attestationObject:te.encodeBytes(n),clientDataJSON:te.encodeBytes(i==null?void 0:i.response.clientDataJSON)},transports:P},cred_type:e?"passkey":"platform"})}).then(y).then(O=>F(O,this.tokenStore));return dt.setPsgCredID(h,i),x.auth_result}_parsePublicKey(e){return e.challenge=te.decodeBytes(e.challenge.toString()),e.user.id=te.decodeBytes(e.user.id.toString()),e}};p();var J=new U,re=class{constructor(e,t,i){this.tokenStore=t;this.apiUrl=e+"/login/",this.identifier=i!=null?i:""}async withWebAuthn(){let e=JSON.stringify({identifier:this.identifier}),t=this.identifier?e:void 0,i=await fetch(this.apiUrl+"webauthn/start",{headers:b(),method:"POST",body:t}).then(y),n=await navigator.credentials.get({publicKey:this._parsePublicKey(i.handshake.challenge.publicKey)}).catch(h=>{throw new _("error parsing public key for webAuthn",{status:702,statusText:"PSG Parse Public Key For Login Failed"})}).then(h=>h);return n?(await fetch(this.apiUrl+"webauthn/finish",{headers:b(),method:"POST",body:JSON.stringify({user_id:this.identifier?i.user.id:void 0,handshake_id:i.handshake.id,handshake_response:{id:n.id,rawId:J.encodeBytes(n.rawId),type:n.type,response:{clientDataJSON:J.encodeBytes(n.response.clientDataJSON),authenticatorData:J.encodeBytes(n.response.authenticatorData),signature:J.encodeBytes(n.response.signature),userHandle:J.encodeBytes(n.response.userHandle)}}})}).then(y).then(h=>F(h,this.tokenStore))).auth_result:{auth_token:"",redirect_url:""}}_parsePublicKey(e){if(e.challenge=J.decodeBytes(e.challenge.toString()),e.allowCredentials){for(let t=0;t<e.allowCredentials.length;t++){let i=e.allowCredentials[t];i.id=J.decodeBytes(i.id.toString())}return e}return e}};p();var W=class{constructor(e){this.apiUrl=e}async appInfo(){return(await fetch(this.apiUrl,{headers:b(),method:"GET"}).then(y)).app}async identifierExists(e){return(await fetch(this.apiUrl+"/users?identifier="+encodeURIComponent(e),{headers:b(),method:"GET"}).then(y)).user}};p();var L=new U,Ye=new I,E=class{constructor(e,t){this.tokenStore=t;this.apiUrl=e}async newRegister(e,t){return(await fetch(this.apiUrl+"/register/magic-link",{headers:b(),method:"POST",body:JSON.stringify({identifier:e,magic_link_path:window.location.pathname,language:t})}).then(y)).magic_link}async newLogin(e,t){return(await fetch(this.apiUrl+"/login/magic-link",{headers:b(),method:"POST",body:JSON.stringify({identifier:e,magic_link_path:window.location.pathname,language:t})}).then(y)).magic_link}async getStatus(e){return(await fetch(this.apiUrl+"/magic-link/status",{headers:b(),method:"POST",body:JSON.stringify({id:e})}).then(y).then(i=>F(i,this.tokenStore))).auth_result}async activate(e){return(await fetch(this.apiUrl+"/magic-link/activate",{headers:b(),method:"PATCH",body:JSON.stringify({magic_link:e})}).then(y).then(i=>F(i,this.tokenStore))).auth_result}async activateWebAuthnLogin(e){let t=await fetch(this.apiUrl+"/magic-link/webauthn/login/start",{headers:b(),body:JSON.stringify({magic_link:e}),method:"POST"}).then(y);if(!await Ye.psgCredIDExists(t))throw new _("psg_cred_obj does not exist in the allow list",{status:700,statusText:"Not Found"});let n=await navigator.credentials.get({publicKey:this._parsePublicKeyLogin(t.handshake.challenge.publicKey)}).catch(h=>{throw new _("could not parse publickey for login",{status:702,statusText:"PSG Parse Public Key For Login Failed"})});return n?(await fetch(this.apiUrl+"/magic-link/webauthn/login/finish",{headers:b(),method:"POST",body:JSON.stringify({magic_link:e,user_id:t.user.id,handshake_id:t.handshake.id,handshake_response:{id:n.id,rawId:L.encodeBytes(n.rawId),type:n.type,response:{clientDataJSON:L.encodeBytes(n.response.clientDataJSON),authenticatorData:L.encodeBytes(n.response.authenticatorData),signature:L.encodeBytes(n.response.signature),userHandle:L.encodeBytes(n.response.userHandle)}}})}).then(y).then(h=>F(h,this.tokenStore))).auth_result:{auth_token:"",redirect_url:""}}async activateWebAuthnNewDevice(e){let t=await fetch(this.apiUrl+"/magic-link/webauthn/new/start",{headers:b(),body:JSON.stringify({magic_link:e}),method:"POST"}).then(y),i=await navigator.credentials.create({publicKey:this._parsePublicKeyNewDevice(t.handshake.challenge.publicKey)}).catch(x=>{throw new _("could not parse public key for new device",{status:701,statusText:"PSG Parse Public Key For New Device Failed"})}),n=new Uint8Array(i==null?void 0:i.response.attestationObject);we()&&(n=be(n));let P=await fetch(this.apiUrl+"/magic-link/webauthn/new/finish",{headers:b(),method:"POST",body:JSON.stringify({magic_link:e,user_id:t.user.id,handshake_id:t.handshake.id,handshake_response:{rawId:L.encodeBytes(i.rawId),id:i.id,type:i.type,response:{attestationObject:L.encodeBytes(n),clientDataJSON:L.encodeBytes(i.response.clientDataJSON)}},device_name:navigator.userAgent})}).then(y).then(x=>F(x,this.tokenStore)),h=t.user.id;return Ye.setPsgCredID(h,i),P.auth_result}_parsePublicKeyLogin(e){if(e.challenge=L.decodeBytes(e.challenge.toString()),e.allowCredentials){for(let t=0;t<e.allowCredentials.length;t++){let i=e.allowCredentials[t];i.id=L.decodeBytes(i.id.toString())}return e}return e}_parsePublicKeyNewDevice(e){return e.challenge=L.decodeBytes(e.challenge.toString()),e.user.id=L.decodeBytes(e.user.id.toString()),e}};p();p();import Le from"jwt-decode";p();function z(l){return`${j.URL}/v1/apps/${l}`}var $=class{constructor(e,t){this.tokenStore=t;this.apiUrl=z(e)+"/tokens/"}async authGuard(){try{let e=await this.tokenStore.getAuthToken(),t=Le(e,{header:!0}),i=Le(e);return!!(i!==void 0&&t!==void 0&&this._validJWTPayload(i)&&this._validJWTHeader(t))}catch{return!1}}async signOut(){let e=await this.tokenStore.getRefreshToken();return e?fetch(`${this.apiUrl}?`+new URLSearchParams({refresh_token:e}),{method:"DELETE"}).then(({status:t})=>t===200).finally(()=>{K(this.tokenStore)&&this.tokenStore.clearTokens()}):(K(this.tokenStore)&&this.tokenStore.clearTokens(),!0)}async getAuthToken(){let e=await this.tokenStore.getAuthToken();if(await this.tokenStore.getRefreshToken()===void 0)return e;let i=Le(e);return i!==void 0&&this._validJWTPayload(i)?Promise.resolve(e):this.refresh().then(n=>n.auth_token)}async refresh(){let e=new _("Login required",{status:704,statusText:"Login required"}),t=this.tokenStore.getRefreshToken();return t?fetch(this.apiUrl,{headers:b(),method:"POST",body:JSON.stringify({refresh_token:t})}).then(y).then(i=>(K(this.tokenStore)&&this.tokenStore.setTokens(i.auth_result),i.auth_result)).catch(()=>{throw e}):Promise.reject(e)}_validJWTPayload(e){let t=["exp","iss","sub"],i=Math.floor(Date.now()/1e3);return t.forEach(n=>{if(!(n in e))return!1}),!(e.exp&&i>e.exp)}_validJWTHeader(e){let t={alg:"RS256",typ:"JWT"};return!(e.alg!==t.alg||e.typ!==t.typ)}};var ne=new U,Ze=new I,gt=new q,ke=class{constructor(e,t){this.tokenStore=t;this.apiUrl=z(e)+"/currentuser",this.session=new $(e,this.tokenStore)}async userInfo(){let e=await this._getToken(),t=await fetch(this.apiUrl,{method:"GET",headers:b({Authorization:`Bearer ${e}`})}).then(async i=>i.status!==200?void 0:await i.json()).catch(i=>{throw new _("Failed to fetch current user.",{status:404,statusText:"Not Found"})});return t==null?void 0:t.user}async changeEmail(e,t){let i=await this._getToken();return(await fetch(`${this.apiUrl}/email`,{method:"PATCH",headers:b({Authorization:`Bearer ${i}`,"Content-Type":"application/json"}),body:JSON.stringify({new_email:e,language:t})}).then(y)).magic_link}async changePhone(e,t){let i=await this._getToken();return(await fetch(`${this.apiUrl}/phone`,{method:"PATCH",headers:b({Authorization:`Bearer ${i}`,"Content-Type":"application/json"}),body:JSON.stringify({new_phone:e,language:t})}).then(y)).magic_link}async editDevice(e,t){if(e===""||e===void 0)throw new _("A deviceID is required for an edit device request.",{status:400,statusText:"Bad Request"});if(Object.keys(t).length===0)throw new _("Edit device request must not have an empty request body.",{status:400,statusText:"Bad Request"});let i=await this._getToken();return(await fetch(`${this.apiUrl}/devices/${e}`,{method:"PATCH",headers:b({Authorization:`Bearer ${i}`,"Content-Type":"application/json"}),body:JSON.stringify({...t})}).then(y)).device}async listDevices(){let e=await this._getToken();return(await fetch(`${this.apiUrl}/devices/`,{method:"GET",headers:b({Authorization:`Bearer ${e}`,"Content-Type":"application/json"})}).then(y)).devices}async addDevice(){let e=await this._getToken(),{createPassKeySupported:t}=await gt.getBrowserInfo(),i=await fetch(this.apiUrl+"/devices/start",{headers:b({Authorization:`Bearer ${e}`}),method:"POST"}).then(y),n=await navigator.credentials.create({publicKey:this._parsePublicKey(i.handshake.challenge.publicKey)}).catch(O=>{throw new _("failed to parse public key",{status:701,statusText:"PSG Parse Public Key For New Device Failed"})}).then(O=>O),P=[];(n==null?void 0:n.response.getTransports)&&typeof(n==null?void 0:n.response.getTransports)=="function"&&(P=n==null?void 0:n.response.getTransports());let h=i.user.id,x=await fetch(this.apiUrl+"/devices/finish",{headers:b({Authorization:`Bearer ${e}`}),method:"POST",body:JSON.stringify({user_id:h,handshake_id:i.handshake.id,handshake_response:{rawId:ne.encodeBytes(n==null?void 0:n.rawId),id:n==null?void 0:n.id,type:n==null?void 0:n.type,response:{attestationObject:ne.encodeBytes(n==null?void 0:n.response.attestationObject),clientDataJSON:ne.encodeBytes(n==null?void 0:n.response.clientDataJSON)},transports:P},cred_type:t?"passkey":"platform"})}).then(y);return Ze.setPsgCredID(h,n),x.device}async deleteDevice(e){let t=typeof e=="string"?e:e.id,i=typeof e=="string"?void 0:e.cred_id;if(!t)throw new _("A deviceID is required to delete a device.",{status:404,statusText:"Not Found"});let n=!1,P=await this._getToken();return n=await fetch(`${this.apiUrl}/devices/${t}`,{method:"DELETE",headers:b({Authorization:`Bearer ${P}`,"Content-Type":"application/json"})}).then(async h=>h.ok?!0:await h.text().then(x=>{throw new _(x,h)})),n&&i!==void 0&&Ze.removeCredential(i),n}async getMetadata(){let e=await this._getToken();return(await fetch(`${this.apiUrl}/user-metadata`,{method:"GET",headers:b({Authorization:`Bearer ${e}`})}).then(y)).user_metadata}async updateMetadata(e){let t=await this._getToken();return(await fetch(`${this.apiUrl}/user-metadata`,{method:"PATCH",headers:b({Authorization:`Bearer ${t}`,"Content-Type":"application/json"}),body:JSON.stringify({user_metadata:e})}).then(y)).user}_parsePublicKey(e){return e.challenge=ne.decodeBytes(e.challenge.toString()),e.user.id=ne.decodeBytes(e.user.id.toString()),e}async _getToken(){return await this.session.getAuthToken()}};p();var Xe=async(l,e)=>{let t,i=new Promise(n=>{t=setTimeout(n,e)});return Promise.race([l,i]).then(n=>(clearTimeout(t),n))};var Qe=class{constructor(e,t){this.appID=e;this.fullUrl=z(this.appID),(t==null?void 0:t.tokenStore)===void 0?this.tokenStore=new ye:this.tokenStore=t.tokenStore}credIDExists(e){let t=new I().getPsgCredObj();return t?!!JSON.parse(t)[e]:!1}async register(e){return await new ie(this.fullUrl,this.tokenStore,e).withWebAuthn()}async login(e){return await new re(this.fullUrl,this.tokenStore,e).withWebAuthn()}async appInfo(){return await new W(this.fullUrl).appInfo()}async browserInfo(){return await new q().getBrowserInfo()}checkWebauthnConfig(e){let t=!0;return e.auth_origin.replace(/\/$/,"")!=window.location.origin.replace(/\/$/,"")&&(console.error('The auth_origin configured for webauthn in your app settings does not match the "origin" of your current URL.  Please reconfigure this in the admin console. (Your current "origin" is `'+window.location.origin+"`) Passage will continue to work with other authentication methods."),t=!1),t}async isWebauthnSupported(e){let t=!1;return window.PublicKeyCredential&&(e?t=!0:await Xe(window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable().then(i=>{t=i}).catch(()=>console.log("Something went wrong.")),500)),t}async identifierExists(e){return await new W(this.fullUrl).identifierExists(e)}async newRegisterMagicLink(e,t){return await new E(this.fullUrl,this.tokenStore).newRegister(e,t)}async newLoginMagicLink(e,t){return await new E(this.fullUrl,this.tokenStore).newLogin(e,t)}async magicLinkActivate(e){return await new E(this.fullUrl,this.tokenStore).activate(e)}async magicLinkActivateWebAuthnLogin(e){return await new E(this.fullUrl,this.tokenStore).activateWebAuthnLogin(e)}async magicLinkActivateWebAuthnNewDevice(e){return await new E(this.fullUrl,this.tokenStore).activateWebAuthnNewDevice(e)}async getMagicLinkStatus(e){return await new E(this.fullUrl,this.tokenStore).getStatus(e)}getCurrentUser(){return new ke(this.appID,this.tokenStore)}getCurrentSession(){return new $(this.appID,this.tokenStore)}async createUser(e){return(await fetch(`${this.fullUrl}/users`,{headers:b(),body:JSON.stringify({...e}),method:"POST"}).then(y)).user}};p();import{serializeError as ft}from"serialize-error";var wt=l=>JSON.parse(JSON.stringify(l,(e,t)=>{if(!(t==null||t==="undefined"))return t})),ar=async l=>{try{let{error:e,message:t,sentryConfig:{url:i=j.CAPTURE_EVENT_URL,project:n=j.SENTRY_PROJECT,dsn:P=j.SENTRY_PROJECT_DSN,environment:h=j.SENTRY_PROJECT_ENV,release:x=j.SENTRY_RELEASE,version:O=j.SENTRY_PROJECT_VERSION}={}}=l,D=wt({project:n,dsn:P,environment:h,url:i,release:x,version:O});if(!(D.project&&D.url)||!(e||t))return;let o={project:D.project,dsn:D.dsn,environment:D.environment,release:D.release,version:D.version};t&&(o={...o,message:t}),e&&(o={...o,serializedError:ft(typeof e=="string"?new Error(e):e)}),await fetch(D.url,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(o)})}catch(e){console.error(e)}};p();var bt=(i=>(i.email="email",i.phone="phone",i.both="both",i))(bt||{}),yt=(n=>(n.Phone="phone",n.Email="email",n.Both="both",n.Either="either",n))(yt||{}),kt=(h=>(h.STRING="string",h.BOOLEAN="boolean",h.INTEGER="integer",h.DATE="date",h.PHONE="phone",h.EMAIL="email",h))(kt||{});p();p();var St=(i=>(i.ACTIVE="active",i.INACTIVE="inactive",i.PENDING="pending",i))(St||{}),vt=(t=>(t.Platform="platform",t.Passkey="passkey",t))(vt||{});p();p();p();export{bt as Identifier,Qe as Passage,_ as PassageError,M as PassageErrorCode,ye as PassageTokenStore,St as PassageUserStatus,Ue as ReadOnlyTokenStore,yt as RequiredIdentifier,$ as Session,Ne as TokenStore,ke as User,kt as UserMetadataType,vt as WebAuthnType,ar as captureEvent,wt as cleanSentryConfig,K as isFullTokenStore};
//# sourceMappingURL=index.js.map