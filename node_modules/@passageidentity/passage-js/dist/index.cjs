"use strict";var pt=Object.create;var fe=Object.defineProperty;var ht=Object.getOwnPropertyDescriptor;var dt=Object.getOwnPropertyNames;var mt=Object.getPrototypeOf,gt=Object.prototype.hasOwnProperty;var ft=(l,e)=>()=>(l&&(e=l(l=0)),e);var wt=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),bt=(l,e)=>{for(var t in e)fe(l,t,{get:e[t],enumerable:!0})},ze=(l,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of dt(e))!gt.call(l,n)&&n!==t&&fe(l,n,{get:()=>e[n],enumerable:!(i=ht(e,n))||i.enumerable});return l};var Be=(l,e,t)=>(t=l!=null?pt(mt(l)):{},ze(e||!l||!l.__esModule?fe(t,"default",{value:l,enumerable:!0}):t,l)),yt=l=>ze(fe({},"__esModule",{value:!0}),l);var p=ft(()=>{});var Ve=wt((ee,be)=>{p();(function(l,e){"use strict";var t="1.0.33",i="",n="?",T="function",h="undefined",R="object",x="string",j="major",s="model",u="name",o="type",a="vendor",c="version",L="architecture",$="console",f="mobile",d="tablet",U="smarttv",V="wearable",je="embedded",Te=350,Pe="Amazon",ae="Apple",De="ASUS",Ce="BlackBerry",G="Browser",le="Chrome",lt="Edge",ue="Firefox",ce="Google",Ee="Huawei",Re="LG",xe="Microsoft",Me="Motorola",pe="Opera",Oe="Samsung",qe="Sharp",he="Sony",Ae="Xiaomi",Ue="Zebra",Fe="Facebook",ut=function(m,k){var g={};for(var P in m)k[P]&&k[P].length%2===0?g[P]=k[P].concat(m[P]):g[P]=m[P];return g},de=function(m){for(var k={},g=0;g<m.length;g++)k[m[g].toUpperCase()]=m[g];return k},Je=function(m,k){return typeof m===x?Y(k).indexOf(Y(m))!==-1:!1},Y=function(m){return m.toLowerCase()},ct=function(m){return typeof m===x?m.replace(/[^\d\.]/g,i).split(".")[0]:e},Ne=function(m,k){if(typeof m===x)return m=m.replace(/^\s\s*/,i),typeof k===h?m:m.substring(0,Te)},Z=function(m,k){for(var g=0,P,w,ge,_,X,D;g<k.length&&!X;){var Ke=k[g],We=k[g+1];for(P=w=0;P<Ke.length&&!X;)if(X=Ke[P++].exec(m),X)for(ge=0;ge<We.length;ge++)D=X[++w],_=We[ge],typeof _===R&&_.length>0?_.length===2?typeof _[1]==T?this[_[0]]=_[1].call(this,D):this[_[0]]=_[1]:_.length===3?typeof _[1]===T&&!(_[1].exec&&_[1].test)?this[_[0]]=D?_[1].call(this,D,_[2]):e:this[_[0]]=D?D.replace(_[1],_[2]):e:_.length===4&&(this[_[0]]=D?_[3].call(this,D.replace(_[1],_[2])):e):this[_]=D||e;g+=2}},Le=function(m,k){for(var g in k)if(typeof k[g]===R&&k[g].length>0){for(var P=0;P<k[g].length;P++)if(Je(k[g][P],m))return g===n?e:g}else if(Je(k[g],m))return g===n?e:g;return m},r={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},He={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Ge={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[c,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[c,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,c],[/opios[\/ ]+([\w\.]+)/i],[c,[u,pe+" Mini"]],[/\bopr\/([\w\.]+)/i],[c,[u,pe]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[u,c],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[c,[u,"UC"+G]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[c,[u,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[c,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[c,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[c,[u,"IE"]],[/yabrowser\/([\w\.]+)/i],[c,[u,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+G],c],[/\bfocus\/([\w\.]+)/i],[c,[u,ue+" Focus"]],[/\bopt\/([\w\.]+)/i],[c,[u,pe+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[c,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[c,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[c,[u,pe+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[c,[u,"MIUI "+G]],[/fxios\/([-\w\.]+)/i],[c,[u,ue]],[/\bqihu|(qi?ho?o?|360)browser/i],[[u,"360 "+G]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1 "+G],c],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],c],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[u,c],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,Fe],c],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[u,c],[/\bgsa\/([\w\.]+) .*safari\//i],[c,[u,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[c,[u,le+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,le+" WebView"],c],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[c,[u,"Android "+G]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,c],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[c,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[c,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[c,Le,r]],[/(webkit|khtml)\/([\w\.]+)/i],[u,c],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],c],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[c,[u,ue+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[u,c],[/(cobalt)\/([\w\.]+)/i],[u,[c,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[L,"amd64"]],[/(ia32(?=;))/i],[[L,Y]],[/((?:i[346]|x)86)[;\)]/i],[[L,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[L,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[L,"armhf"]],[/windows (ce|mobile); ppc;/i],[[L,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[L,/ower/,i,Y]],[/(sun4\w)[;\)]/i],[[L,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[L,Y]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[s,[a,Oe],[o,d]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[s,[a,Oe],[o,f]],[/\((ip(?:hone|od)[\w ]*);/i],[s,[a,ae],[o,f]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[s,[a,ae],[o,d]],[/(macintosh);/i],[s,[a,ae]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[s,[a,Ee],[o,d]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[s,[a,Ee],[o,f]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[s,/_/g," "],[a,Ae],[o,f]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[s,/_/g," "],[a,Ae],[o,d]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[s,[a,"OPPO"],[o,f]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[s,[a,"Vivo"],[o,f]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[s,[a,"Realme"],[o,f]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[s,[a,Me],[o,f]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[s,[a,Me],[o,d]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[s,[a,Re],[o,d]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[s,[a,Re],[o,f]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[s,[a,"Lenovo"],[o,d]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[s,/_/g," "],[a,"Nokia"],[o,f]],[/(pixel c)\b/i],[s,[a,ce],[o,d]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[s,[a,ce],[o,f]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[a,he],[o,f]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[s,"Xperia Tablet"],[a,he],[o,d]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[s,[a,"OnePlus"],[o,f]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[s,[a,Pe],[o,d]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[s,/(.+)/g,"Fire Phone $1"],[a,Pe],[o,f]],[/(playbook);[-\w\),; ]+(rim)/i],[s,a,[o,d]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[s,[a,Ce],[o,f]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[s,[a,De],[o,d]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[s,[a,De],[o,f]],[/(nexus 9)/i],[s,[a,"HTC"],[o,d]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[a,[s,/_/g," "],[o,f]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[s,[a,"Acer"],[o,d]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[s,[a,"Meizu"],[o,f]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[s,[a,qe],[o,f]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[a,s,[o,f]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[a,s,[o,d]],[/(surface duo)/i],[s,[a,xe],[o,d]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[s,[a,"Fairphone"],[o,f]],[/(u304aa)/i],[s,[a,"AT&T"],[o,f]],[/\bsie-(\w*)/i],[s,[a,"Siemens"],[o,f]],[/\b(rct\w+) b/i],[s,[a,"RCA"],[o,d]],[/\b(venue[\d ]{2,7}) b/i],[s,[a,"Dell"],[o,d]],[/\b(q(?:mv|ta)\w+) b/i],[s,[a,"Verizon"],[o,d]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[s,[a,"Barnes & Noble"],[o,d]],[/\b(tm\d{3}\w+) b/i],[s,[a,"NuVision"],[o,d]],[/\b(k88) b/i],[s,[a,"ZTE"],[o,d]],[/\b(nx\d{3}j) b/i],[s,[a,"ZTE"],[o,f]],[/\b(gen\d{3}) b.+49h/i],[s,[a,"Swiss"],[o,f]],[/\b(zur\d{3}) b/i],[s,[a,"Swiss"],[o,d]],[/\b((zeki)?tb.*\b) b/i],[s,[a,"Zeki"],[o,d]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[a,"Dragon Touch"],s,[o,d]],[/\b(ns-?\w{0,9}) b/i],[s,[a,"Insignia"],[o,d]],[/\b((nxa|next)-?\w{0,9}) b/i],[s,[a,"NextBook"],[o,d]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[a,"Voice"],s,[o,f]],[/\b(lvtel\-)?(v1[12]) b/i],[[a,"LvTel"],s,[o,f]],[/\b(ph-1) /i],[s,[a,"Essential"],[o,f]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[s,[a,"Envizen"],[o,d]],[/\b(trio[-\w\. ]+) b/i],[s,[a,"MachSpeed"],[o,d]],[/\btu_(1491) b/i],[s,[a,"Rotor"],[o,d]],[/(shield[\w ]+) b/i],[s,[a,"Nvidia"],[o,d]],[/(sprint) (\w+)/i],[a,s,[o,f]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[a,xe],[o,f]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[s,[a,Ue],[o,d]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[s,[a,Ue],[o,f]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[a,s,[o,$]],[/droid.+; (shield) bui/i],[s,[a,"Nvidia"],[o,$]],[/(playstation [345portablevi]+)/i],[s,[a,he],[o,$]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[s,[a,xe],[o,$]],[/smart-tv.+(samsung)/i],[a,[o,U]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[a,Oe],[o,U]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[a,Re],[o,U]],[/(apple) ?tv/i],[a,[s,ae+" TV"],[o,U]],[/crkey/i],[[s,le+"cast"],[a,ce],[o,U]],[/droid.+aft(\w)( bui|\))/i],[s,[a,Pe],[o,U]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[s,[a,qe],[o,U]],[/(bravia[\w ]+)( bui|\))/i],[s,[a,he],[o,U]],[/(mitv-\w{5}) bui/i],[s,[a,Ae],[o,U]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[a,Ne],[s,Ne],[o,U]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[o,U]],[/((pebble))app/i],[a,s,[o,V]],[/droid.+; (glass) \d/i],[s,[a,ce],[o,V]],[/droid.+; (wt63?0{2,3})\)/i],[s,[a,Ue],[o,V]],[/(quest( 2)?)/i],[s,[a,Fe],[o,V]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[a,[o,je]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[s,[o,f]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[s,[o,d]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[o,d]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[o,f]],[/(android[-\w\. ]{0,9});.+buil/i],[s,[a,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[c,[u,lt+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[c,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[u,c],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[c,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,c],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[u,[c,Le,He]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[u,"Windows"],[c,Le,He]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[c,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,"Mac OS"],[c,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[c,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[u,c],[/\(bb(10);/i],[c,[u,Ce]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[c,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[c,[u,ue+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[c,[u,"webOS"]],[/crkey\/([\d\.]+)/i],[c,[u,le+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[u,"Chromium OS"],c],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,c],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],c],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[u,c]]},O=function(m,k){if(typeof m===R&&(k=m,m=e),!(this instanceof O))return new O(m,k).getResult();var g=m||(typeof l!==h&&l.navigator&&l.navigator.userAgent?l.navigator.userAgent:i),P=k?ut(Ge,k):Ge;return this.getBrowser=function(){var w={};return w[u]=e,w[c]=e,Z.call(w,g,P.browser),w.major=ct(w.version),w},this.getCPU=function(){var w={};return w[L]=e,Z.call(w,g,P.cpu),w},this.getDevice=function(){var w={};return w[a]=e,w[s]=e,w[o]=e,Z.call(w,g,P.device),w},this.getEngine=function(){var w={};return w[u]=e,w[c]=e,Z.call(w,g,P.engine),w},this.getOS=function(){var w={};return w[u]=e,w[c]=e,Z.call(w,g,P.os),w},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return g},this.setUA=function(w){return g=typeof w===x&&w.length>Te?Ne(w,Te):w,this},this.setUA(g),this};O.VERSION=t,O.BROWSER=de([u,c,j]),O.CPU=de([L]),O.DEVICE=de([s,a,o,$,f,U,d,V,je]),O.ENGINE=O.OS=de([u,c]),typeof ee!==h?(typeof be!==h&&be.exports&&(ee=be.exports=O),ee.UAParser=O):typeof define===T&&define.amd?define(function(){return O}):typeof l!==h&&(l.UAParser=O);var K=typeof l!==h&&(l.jQuery||l.Zepto);if(K&&!K.ua){var me=new O;K.ua=me.getResult(),K.ua.get=function(){return me.getUA()},K.ua.set=function(m){me.setUA(m);var k=me.getResult();for(var g in k)K.ua[g]=k[g]}}})(typeof window=="object"?window:ee)});var Pt={};bt(Pt,{Identifier:()=>rt,Passage:()=>Ie,PassageError:()=>v,PassageErrorCode:()=>E,PassageTokenStore:()=>te,PassageUserStatus:()=>ot,ReadOnlyTokenStore:()=>Se,RequiredIdentifier:()=>nt,Session:()=>H,TokenStore:()=>ve,User:()=>oe,UserMetadataType:()=>st,WebAuthnType:()=>at,captureEvent:()=>Tt,cleanSentryConfig:()=>it,isFullTokenStore:()=>F});module.exports=yt(Pt);p();p();p();p();var A=class{encodeBytes(e){let i=btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\+/g,"-").replace(/\//g,"_");return $e(i)}decodeBytes(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),i=$e(t);return Uint8Array.from(atob(i),T=>T.charCodeAt(0))}},$e=l=>{let e=l.indexOf("=");return l.slice(0,e===-1?l.length:e)};p();p();var v=class extends Error{constructor(t,i){super();this.name="PassageError",this.statusCode=i.status,this.statusText=i.statusText,this.message=this._parsePsgErrorResponse(t)}_parsePsgErrorResponse(t){try{return t=JSON.parse(t),t.error?t.error:""}catch{return t}}},E=(r=>(r[r.MultipleChoice=300]="MultipleChoice",r[r.MovedPermanantly=301]="MovedPermanantly",r[r.Found=302]="Found",r[r.SeeOther=303]="SeeOther",r[r.NotModified=304]="NotModified",r[r.TemporaryRedirect=307]="TemporaryRedirect",r[r.PermanentRedirect=308]="PermanentRedirect",r[r.BadRequest=400]="BadRequest",r[r.Unauthorized=401]="Unauthorized",r[r.PaymentRequired=402]="PaymentRequired",r[r.Forbidden=403]="Forbidden",r[r.NotFound=404]="NotFound",r[r.MethodNotAllowed=405]="MethodNotAllowed",r[r.NotAcceptable=406]="NotAcceptable",r[r.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",r[r.RequestTimeout=408]="RequestTimeout",r[r.Conflict=409]="Conflict",r[r.Gone=410]="Gone",r[r.LengthRequired=411]="LengthRequired",r[r.PreconditionFailed=412]="PreconditionFailed",r[r.PayloadTooLarge=413]="PayloadTooLarge",r[r.URITooLong=414]="URITooLong",r[r.UnsupportedMediaType=415]="UnsupportedMediaType",r[r.RangeNotSatisfiable=416]="RangeNotSatisfiable",r[r.ExpectationFailed=417]="ExpectationFailed",r[r.MisdirectedRequest=421]="MisdirectedRequest",r[r.UnprocessableEntity=422]="UnprocessableEntity",r[r.Locked=423]="Locked",r[r.FailedDependency=424]="FailedDependency",r[r.TooEarly=425]="TooEarly",r[r.UpgradeRequired=426]="UpgradeRequired",r[r.PreconditionRequired=428]="PreconditionRequired",r[r.TooManyRequests=429]="TooManyRequests",r[r.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",r[r.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",r[r.InternalServerError=500]="InternalServerError",r[r.NotImplemented=501]="NotImplemented",r[r.BadGateway=502]="BadGateway",r[r.ServiceUnavailable=503]="ServiceUnavailable",r[r.GatewayTimeout=504]="GatewayTimeout",r[r.HTTPVersionNotSupported=505]="HTTPVersionNotSupported",r[r.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",r[r.InsufficientStorage=507]="InsufficientStorage",r[r.LoopDetected=508]="LoopDetected",r[r.NotExtended=510]="NotExtended",r[r.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",r[r.PSGCredObjectDoesNotExist=700]="PSGCredObjectDoesNotExist",r[r.PSGParsePublicKeyForNewDeviceFailed=701]="PSGParsePublicKeyForNewDeviceFailed",r[r.PSGParsePublicKeyForLoginFailed=702]="PSGParsePublicKeyForLoginFailed",r[r.PSGCouldNotGetUserCredential=703]="PSGCouldNotGetUserCredential",r[r.PSGLoginRequired=704]="PSGLoginRequired",r))(E||{});var Q=Be(require("js-cookie"),1),we=new A,B=class{psgCredIDExists(e){let t=e.user.id,i=e.handshake.challenge.publicKey.allowCredentials,n=this.getPsgCredObj();if(!n)throw new v("Could not get psg_cred_obj",{status:700,statusText:"PSG Cred Object Does Not Exist"});let T=JSON.parse(n)[t];return T?i.find(R=>{if(we.encodeBytes(we.decodeBytes(R.id))===we.encodeBytes(we.decodeBytes(T)))return!0}):!1}setPsgCredID(e,t){if(!t)throw new v("Could not get user's credential",{status:703,statusText:"PSG Could Not Get User Credential"});let i=this.getPsgCredObj();if(i){let n=JSON.parse(i);n[e]=t==null?void 0:t.id,this.setPsgCredObj(JSON.stringify(n))}else this.setPsgCredObj(JSON.stringify({[e]:t==null?void 0:t.id}))}removeCredential(e){let t=this.getPsgCredObj();if(t===void 0)return;let i=JSON.parse(t);Object.keys(i).forEach(n=>{i[n]===e&&delete i[n]}),this.setPsgCredObj(JSON.stringify(i))}getPsgCredObj(){let e=Q.default.get("psg_cred_obj"),t=localStorage.getItem("psg_cred_obj");if(e!==void 0)return Q.default.set("psg_cred_obj",e,{expires:400,sameSite:"Strict"}),t===null&&localStorage.setItem("psg_cred_obj",e),e;if(t!==null)return Q.default.set("psg_cred_obj",t,{expires:400,sameSite:"Strict"}),t}setPsgCredObj(e){Q.default.set("psg_cred_obj",e,{expires:400,sameSite:"Strict"}),localStorage.setItem("psg_cred_obj",e)}};p();var Ye=Be(Ve(),1),M=class{constructor(){this.userAgent=new Ye.default}async getBrowserInfo(){return{createPassKeySupported:await this._canBrowserCreatePassKey(),getPassKeySupported:await this._canBrowserGetPasskey(),conditionalUISupported:await this._isConditionalMediationAvailable()}}async _canBrowserCreatePassKey(){return!!(this._isiOSPasskeySupported()||this._isMacPasskeySupported())}_canBrowserGetPasskey(){return this._isiOSPasskeySupported()||this._isMacPasskeySupported()||this._isDesktopChrome108()?Promise.resolve(!0):Promise.resolve(!1)}async _isConditionalMediationAvailable(){return!1}_isiOSPasskeySupported(){return this.userAgent.getOS().name=="iOS"&&parseFloat(this.userAgent.getOS().version||"")>=16}_isMacPasskeySupported(){return this.userAgent.getBrowser().name=="Safari"&&parseFloat(this.userAgent.getBrowser().version||"")>=16&&this.userAgent.getOS().name=="Mac OS"}_isDesktopChrome108(){return this.userAgent.getBrowser().name=="Chrome"&&parseFloat(this.userAgent.getBrowser().version||"")>=108}};p();async function y(l){return l.ok?l.json():await l.text().then(e=>{throw new v(e,l)})}p();function ye(){let l=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,e=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./),t=e?parseInt(e[1]):0;return navigator.platform.indexOf("Win")!==-1&&l&&t===98}function ke(l){let e=new Uint8Array(68);e.set(l.slice(0,68));let t=new Uint8Array(l.byteLength-68);t.set(l.slice(68,l.byteLength));let i=new Uint8Array(15),n=new Uint8Array(e.byteLength+i.byteLength+t.byteLength);n.set(e,0),n.set(i,e.byteLength),n.set(t,e.byteLength+i.byteLength);let T=n[30]+15;return n.set([T],30),n}p();p();p();var Ze={URL:"https://auth.passage.id",version:"@passageidentity/passage-js 3.1.0",CAPTURE_EVENT_URL:"https://us-central1-passage-prod.cloudfunctions.net/capture-event",SENTRY_RELEASE:"passage-js@3.1.0-prod",SENTRY_PROJECT:"passage-js",SENTRY_PROJECT_DSN:"",SENTRY_PROJECT_ENV:"prod",SENTRY_PROJECT_VERSION:"3.1.0"};var I=Ze;function b(l){let e=new Headers(l),t=I.version;return t&&e.append("Passage-Version",t),e}p();p();var Se=class{getRefreshToken(){return Promise.resolve(void 0)}},ve=class extends Se{clearTokens(){return Promise.resolve()}},te=class extends ve{constructor(){super(...arguments);this.noLocalStorage=typeof window>"u";this.noLocalStorageError=t=>"Failed to access localStorage or cookies. Must be run client-side."}getAuthToken(){if(this.noLocalStorage)return Promise.reject(this.noLocalStorageError("getAuthToken"));let t=localStorage.getItem("psg_auth_token");if(t===null){let i=new v("Login required",{status:704,statusText:"Login required"});return Promise.reject(i)}return Promise.resolve(t)}setAuthToken(t){if(this.noLocalStorage)return Promise.reject(this.noLocalStorageError("setAuthToken"));localStorage.setItem("psg_auth_token",t);let i=!this._isHttps()&&this._isLocalHost();return document.cookie=`psg_auth_token = ${t}; path=/ ${i?"":";secure"}`,Promise.resolve()}getRefreshToken(){this.noLocalStorage&&Promise.reject(this.noLocalStorageError("getRefreshToken"));let t=localStorage.getItem("psg_refresh_token");return t===null?Promise.resolve(void 0):Promise.resolve(t)}setRefreshToken(t){return this.noLocalStorage&&Promise.reject(this.noLocalStorageError("setRefreshToken")),localStorage.setItem("psg_refresh_token",t),Promise.resolve()}setTokens(t){return this.noLocalStorage&&Promise.reject(this.noLocalStorageError("setTokens")),this.setAuthToken(t.auth_token),t.refresh_token&&this.setRefreshToken(t.refresh_token),Promise.resolve()}clearTokens(){return this.noLocalStorage&&Promise.reject(this.noLocalStorageError("clearTokens")),localStorage.removeItem("psg_auth_token"),document.cookie="psg_auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC;",localStorage.removeItem("psg_refresh_token"),Promise.resolve()}_isLocalHost(){return Boolean(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))}_isHttps(){return location.protocol==="https:"}};function F(l){return l.setTokens!==void 0}var kt=l=>typeof l=="object"&&l!==null&&typeof l.auth_result<"u";function q(l,e){return kt(l)?(F(e)&&e.setTokens(l.auth_result),l):(console.warn("Not a valid auth response"),l)}var ie=new A,St=new B,vt=new M,re=class{constructor(e,t,i){this.tokenStore=t;this.apiUrl=e+"/register/",this.identifier=i}async withWebAuthn(){let{createPassKeySupported:e}=await vt.getBrowserInfo(),t=await fetch(this.apiUrl+"webauthn/start",{headers:b(),body:JSON.stringify({identifier:this.identifier}),method:"POST"}).then(y),i=await navigator.credentials.create({publicKey:this._parsePublicKey(t.handshake.challenge.publicKey)}).catch(x=>{throw new v("error parsing public key for webAuthn",{status:702,statusText:"PSG Parse Public Key For Login Failed"})}).then(x=>x),n=new Uint8Array(i==null?void 0:i.response.attestationObject);ye()&&(n=ke(n));let T=[];(i==null?void 0:i.response.getTransports)&&typeof(i==null?void 0:i.response.getTransports)=="function"&&(T=i==null?void 0:i.response.getTransports());let h=t.user.id,R=await fetch(this.apiUrl+"webauthn/finish",{headers:b(),method:"POST",body:JSON.stringify({user_id:h,handshake_id:t.handshake.id,handshake_response:{rawId:ie.encodeBytes(i==null?void 0:i.rawId),id:i==null?void 0:i.id,type:i==null?void 0:i.type,response:{attestationObject:ie.encodeBytes(n),clientDataJSON:ie.encodeBytes(i==null?void 0:i.response.clientDataJSON)},transports:T},cred_type:e?"passkey":"platform"})}).then(y).then(x=>q(x,this.tokenStore));return St.setPsgCredID(h,i),R.auth_result}_parsePublicKey(e){return e.challenge=ie.decodeBytes(e.challenge.toString()),e.user.id=ie.decodeBytes(e.user.id.toString()),e}};p();var J=new A,ne=class{constructor(e,t,i){this.tokenStore=t;this.apiUrl=e+"/login/",this.identifier=i!=null?i:""}async withWebAuthn(){let e=JSON.stringify({identifier:this.identifier}),t=this.identifier?e:void 0,i=await fetch(this.apiUrl+"webauthn/start",{headers:b(),method:"POST",body:t}).then(y),n=await navigator.credentials.get({publicKey:this._parsePublicKey(i.handshake.challenge.publicKey)}).catch(h=>{throw new v("error parsing public key for webAuthn",{status:702,statusText:"PSG Parse Public Key For Login Failed"})}).then(h=>h);return n?(await fetch(this.apiUrl+"webauthn/finish",{headers:b(),method:"POST",body:JSON.stringify({user_id:this.identifier?i.user.id:void 0,handshake_id:i.handshake.id,handshake_response:{id:n.id,rawId:J.encodeBytes(n.rawId),type:n.type,response:{clientDataJSON:J.encodeBytes(n.response.clientDataJSON),authenticatorData:J.encodeBytes(n.response.authenticatorData),signature:J.encodeBytes(n.response.signature),userHandle:J.encodeBytes(n.response.userHandle)}}})}).then(y).then(h=>q(h,this.tokenStore))).auth_result:{auth_token:"",redirect_url:""}}_parsePublicKey(e){if(e.challenge=J.decodeBytes(e.challenge.toString()),e.allowCredentials){for(let t=0;t<e.allowCredentials.length;t++){let i=e.allowCredentials[t];i.id=J.decodeBytes(i.id.toString())}return e}return e}};p();var W=class{constructor(e){this.apiUrl=e}async appInfo(){return(await fetch(this.apiUrl,{headers:b(),method:"GET"}).then(y)).app}async identifierExists(e){return(await fetch(this.apiUrl+"/users?identifier="+encodeURIComponent(e),{headers:b(),method:"GET"}).then(y)).user}};p();var N=new A,Xe=new B,C=class{constructor(e,t){this.tokenStore=t;this.apiUrl=e}async newRegister(e,t){return(await fetch(this.apiUrl+"/register/magic-link",{headers:b(),method:"POST",body:JSON.stringify({identifier:e,magic_link_path:window.location.pathname,language:t})}).then(y)).magic_link}async newLogin(e,t){return(await fetch(this.apiUrl+"/login/magic-link",{headers:b(),method:"POST",body:JSON.stringify({identifier:e,magic_link_path:window.location.pathname,language:t})}).then(y)).magic_link}async getStatus(e){return(await fetch(this.apiUrl+"/magic-link/status",{headers:b(),method:"POST",body:JSON.stringify({id:e})}).then(y).then(i=>q(i,this.tokenStore))).auth_result}async activate(e){return(await fetch(this.apiUrl+"/magic-link/activate",{headers:b(),method:"PATCH",body:JSON.stringify({magic_link:e})}).then(y).then(i=>q(i,this.tokenStore))).auth_result}async activateWebAuthnLogin(e){let t=await fetch(this.apiUrl+"/magic-link/webauthn/login/start",{headers:b(),body:JSON.stringify({magic_link:e}),method:"POST"}).then(y);if(!await Xe.psgCredIDExists(t))throw new v("psg_cred_obj does not exist in the allow list",{status:700,statusText:"Not Found"});let n=await navigator.credentials.get({publicKey:this._parsePublicKeyLogin(t.handshake.challenge.publicKey)}).catch(h=>{throw new v("could not parse publickey for login",{status:702,statusText:"PSG Parse Public Key For Login Failed"})});return n?(await fetch(this.apiUrl+"/magic-link/webauthn/login/finish",{headers:b(),method:"POST",body:JSON.stringify({magic_link:e,user_id:t.user.id,handshake_id:t.handshake.id,handshake_response:{id:n.id,rawId:N.encodeBytes(n.rawId),type:n.type,response:{clientDataJSON:N.encodeBytes(n.response.clientDataJSON),authenticatorData:N.encodeBytes(n.response.authenticatorData),signature:N.encodeBytes(n.response.signature),userHandle:N.encodeBytes(n.response.userHandle)}}})}).then(y).then(h=>q(h,this.tokenStore))).auth_result:{auth_token:"",redirect_url:""}}async activateWebAuthnNewDevice(e){let t=await fetch(this.apiUrl+"/magic-link/webauthn/new/start",{headers:b(),body:JSON.stringify({magic_link:e}),method:"POST"}).then(y),i=await navigator.credentials.create({publicKey:this._parsePublicKeyNewDevice(t.handshake.challenge.publicKey)}).catch(R=>{throw new v("could not parse public key for new device",{status:701,statusText:"PSG Parse Public Key For New Device Failed"})}),n=new Uint8Array(i==null?void 0:i.response.attestationObject);ye()&&(n=ke(n));let T=await fetch(this.apiUrl+"/magic-link/webauthn/new/finish",{headers:b(),method:"POST",body:JSON.stringify({magic_link:e,user_id:t.user.id,handshake_id:t.handshake.id,handshake_response:{rawId:N.encodeBytes(i.rawId),id:i.id,type:i.type,response:{attestationObject:N.encodeBytes(n),clientDataJSON:N.encodeBytes(i.response.clientDataJSON)}},device_name:navigator.userAgent})}).then(y).then(R=>q(R,this.tokenStore)),h=t.user.id;return Xe.setPsgCredID(h,i),T.auth_result}_parsePublicKeyLogin(e){if(e.challenge=N.decodeBytes(e.challenge.toString()),e.allowCredentials){for(let t=0;t<e.allowCredentials.length;t++){let i=e.allowCredentials[t];i.id=N.decodeBytes(i.id.toString())}return e}return e}_parsePublicKeyNewDevice(e){return e.challenge=N.decodeBytes(e.challenge.toString()),e.user.id=N.decodeBytes(e.user.id.toString()),e}};p();p();var _e=Be(require("jwt-decode"),1);p();function z(l){return`${I.URL}/v1/apps/${l}`}var H=class{constructor(e,t){this.tokenStore=t;this.apiUrl=z(e)+"/tokens/"}async authGuard(){try{let e=await this.tokenStore.getAuthToken(),t=(0,_e.default)(e,{header:!0}),i=(0,_e.default)(e);return!!(i!==void 0&&t!==void 0&&this._validJWTPayload(i)&&this._validJWTHeader(t))}catch{return!1}}async signOut(){let e=await this.tokenStore.getRefreshToken();return e?fetch(`${this.apiUrl}?`+new URLSearchParams({refresh_token:e}),{method:"DELETE"}).then(({status:t})=>t===200).finally(()=>{F(this.tokenStore)&&this.tokenStore.clearTokens()}):(F(this.tokenStore)&&this.tokenStore.clearTokens(),!0)}async getAuthToken(){let e=await this.tokenStore.getAuthToken();if(await this.tokenStore.getRefreshToken()===void 0)return e;let i=(0,_e.default)(e);return i!==void 0&&this._validJWTPayload(i)?Promise.resolve(e):this.refresh().then(n=>n.auth_token)}async refresh(){let e=new v("Login required",{status:704,statusText:"Login required"}),t=this.tokenStore.getRefreshToken();return t?fetch(this.apiUrl,{headers:b(),method:"POST",body:JSON.stringify({refresh_token:t})}).then(y).then(i=>(F(this.tokenStore)&&this.tokenStore.setTokens(i.auth_result),i.auth_result)).catch(()=>{throw e}):Promise.reject(e)}_validJWTPayload(e){let t=["exp","iss","sub"],i=Math.floor(Date.now()/1e3);return t.forEach(n=>{if(!(n in e))return!1}),!(e.exp&&i>e.exp)}_validJWTHeader(e){let t={alg:"RS256",typ:"JWT"};return!(e.alg!==t.alg||e.typ!==t.typ)}};var se=new A,Qe=new B,_t=new M,oe=class{constructor(e,t){this.tokenStore=t;this.apiUrl=z(e)+"/currentuser",this.session=new H(e,this.tokenStore)}async userInfo(){let e=await this._getToken(),t=await fetch(this.apiUrl,{method:"GET",headers:b({Authorization:`Bearer ${e}`})}).then(async i=>i.status!==200?void 0:await i.json()).catch(i=>{throw new v("Failed to fetch current user.",{status:404,statusText:"Not Found"})});return t==null?void 0:t.user}async changeEmail(e,t){let i=await this._getToken();return(await fetch(`${this.apiUrl}/email`,{method:"PATCH",headers:b({Authorization:`Bearer ${i}`,"Content-Type":"application/json"}),body:JSON.stringify({new_email:e,language:t})}).then(y)).magic_link}async changePhone(e,t){let i=await this._getToken();return(await fetch(`${this.apiUrl}/phone`,{method:"PATCH",headers:b({Authorization:`Bearer ${i}`,"Content-Type":"application/json"}),body:JSON.stringify({new_phone:e,language:t})}).then(y)).magic_link}async editDevice(e,t){if(e===""||e===void 0)throw new v("A deviceID is required for an edit device request.",{status:400,statusText:"Bad Request"});if(Object.keys(t).length===0)throw new v("Edit device request must not have an empty request body.",{status:400,statusText:"Bad Request"});let i=await this._getToken();return(await fetch(`${this.apiUrl}/devices/${e}`,{method:"PATCH",headers:b({Authorization:`Bearer ${i}`,"Content-Type":"application/json"}),body:JSON.stringify({...t})}).then(y)).device}async listDevices(){let e=await this._getToken();return(await fetch(`${this.apiUrl}/devices/`,{method:"GET",headers:b({Authorization:`Bearer ${e}`,"Content-Type":"application/json"})}).then(y)).devices}async addDevice(){let e=await this._getToken(),{createPassKeySupported:t}=await _t.getBrowserInfo(),i=await fetch(this.apiUrl+"/devices/start",{headers:b({Authorization:`Bearer ${e}`}),method:"POST"}).then(y),n=await navigator.credentials.create({publicKey:this._parsePublicKey(i.handshake.challenge.publicKey)}).catch(x=>{throw new v("failed to parse public key",{status:701,statusText:"PSG Parse Public Key For New Device Failed"})}).then(x=>x),T=[];(n==null?void 0:n.response.getTransports)&&typeof(n==null?void 0:n.response.getTransports)=="function"&&(T=n==null?void 0:n.response.getTransports());let h=i.user.id,R=await fetch(this.apiUrl+"/devices/finish",{headers:b({Authorization:`Bearer ${e}`}),method:"POST",body:JSON.stringify({user_id:h,handshake_id:i.handshake.id,handshake_response:{rawId:se.encodeBytes(n==null?void 0:n.rawId),id:n==null?void 0:n.id,type:n==null?void 0:n.type,response:{attestationObject:se.encodeBytes(n==null?void 0:n.response.attestationObject),clientDataJSON:se.encodeBytes(n==null?void 0:n.response.clientDataJSON)},transports:T},cred_type:t?"passkey":"platform"})}).then(y);return Qe.setPsgCredID(h,n),R.device}async deleteDevice(e){let t=typeof e=="string"?e:e.id,i=typeof e=="string"?void 0:e.cred_id;if(!t)throw new v("A deviceID is required to delete a device.",{status:404,statusText:"Not Found"});let n=!1,T=await this._getToken();return n=await fetch(`${this.apiUrl}/devices/${t}`,{method:"DELETE",headers:b({Authorization:`Bearer ${T}`,"Content-Type":"application/json"})}).then(async h=>h.ok?!0:await h.text().then(R=>{throw new v(R,h)})),n&&i!==void 0&&Qe.removeCredential(i),n}async getMetadata(){let e=await this._getToken();return(await fetch(`${this.apiUrl}/user-metadata`,{method:"GET",headers:b({Authorization:`Bearer ${e}`})}).then(y)).user_metadata}async updateMetadata(e){let t=await this._getToken();return(await fetch(`${this.apiUrl}/user-metadata`,{method:"PATCH",headers:b({Authorization:`Bearer ${t}`,"Content-Type":"application/json"}),body:JSON.stringify({user_metadata:e})}).then(y)).user}_parsePublicKey(e){return e.challenge=se.decodeBytes(e.challenge.toString()),e.user.id=se.decodeBytes(e.user.id.toString()),e}async _getToken(){return await this.session.getAuthToken()}};p();var et=async(l,e)=>{let t,i=new Promise(n=>{t=setTimeout(n,e)});return Promise.race([l,i]).then(n=>(clearTimeout(t),n))};var Ie=class{constructor(e,t){this.appID=e;this.fullUrl=z(this.appID),(t==null?void 0:t.tokenStore)===void 0?this.tokenStore=new te:this.tokenStore=t.tokenStore}credIDExists(e){let t=new B().getPsgCredObj();return t?!!JSON.parse(t)[e]:!1}async register(e){return await new re(this.fullUrl,this.tokenStore,e).withWebAuthn()}async login(e){return await new ne(this.fullUrl,this.tokenStore,e).withWebAuthn()}async appInfo(){return await new W(this.fullUrl).appInfo()}async browserInfo(){return await new M().getBrowserInfo()}checkWebauthnConfig(e){let t=!0;return e.auth_origin.replace(/\/$/,"")!=window.location.origin.replace(/\/$/,"")&&(console.error('The auth_origin configured for webauthn in your app settings does not match the "origin" of your current URL.  Please reconfigure this in the admin console. (Your current "origin" is `'+window.location.origin+"`) Passage will continue to work with other authentication methods."),t=!1),t}async isWebauthnSupported(e){let t=!1;return window.PublicKeyCredential&&(e?t=!0:await et(window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable().then(i=>{t=i}).catch(()=>console.log("Something went wrong.")),500)),t}async identifierExists(e){return await new W(this.fullUrl).identifierExists(e)}async newRegisterMagicLink(e,t){return await new C(this.fullUrl,this.tokenStore).newRegister(e,t)}async newLoginMagicLink(e,t){return await new C(this.fullUrl,this.tokenStore).newLogin(e,t)}async magicLinkActivate(e){return await new C(this.fullUrl,this.tokenStore).activate(e)}async magicLinkActivateWebAuthnLogin(e){return await new C(this.fullUrl,this.tokenStore).activateWebAuthnLogin(e)}async magicLinkActivateWebAuthnNewDevice(e){return await new C(this.fullUrl,this.tokenStore).activateWebAuthnNewDevice(e)}async getMagicLinkStatus(e){return await new C(this.fullUrl,this.tokenStore).getStatus(e)}getCurrentUser(){return new oe(this.appID,this.tokenStore)}getCurrentSession(){return new H(this.appID,this.tokenStore)}async createUser(e){return(await fetch(`${this.fullUrl}/users`,{headers:b(),body:JSON.stringify({...e}),method:"POST"}).then(y)).user}};p();var tt=require("serialize-error");var it=l=>JSON.parse(JSON.stringify(l,(e,t)=>{if(!(t==null||t==="undefined"))return t})),Tt=async l=>{try{let{error:e,message:t,sentryConfig:{url:i=I.CAPTURE_EVENT_URL,project:n=I.SENTRY_PROJECT,dsn:T=I.SENTRY_PROJECT_DSN,environment:h=I.SENTRY_PROJECT_ENV,release:R=I.SENTRY_RELEASE,version:x=I.SENTRY_PROJECT_VERSION}={}}=l,j=it({project:n,dsn:T,environment:h,url:i,release:R,version:x});if(!(j.project&&j.url)||!(e||t))return;let s={project:j.project,dsn:j.dsn,environment:j.environment,release:j.release,version:j.version};t&&(s={...s,message:t}),e&&(s={...s,serializedError:(0,tt.serializeError)(typeof e=="string"?new Error(e):e)}),await fetch(j.url,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(s)})}catch(e){console.error(e)}};p();var rt=(i=>(i.email="email",i.phone="phone",i.both="both",i))(rt||{}),nt=(n=>(n.Phone="phone",n.Email="email",n.Both="both",n.Either="either",n))(nt||{}),st=(h=>(h.STRING="string",h.BOOLEAN="boolean",h.INTEGER="integer",h.DATE="date",h.PHONE="phone",h.EMAIL="email",h))(st||{});p();p();var ot=(i=>(i.ACTIVE="active",i.INACTIVE="inactive",i.PENDING="pending",i))(ot||{}),at=(t=>(t.Platform="platform",t.Passkey="passkey",t))(at||{});p();p();p();0&&(module.exports={Identifier,Passage,PassageError,PassageErrorCode,PassageTokenStore,PassageUserStatus,ReadOnlyTokenStore,RequiredIdentifier,Session,TokenStore,User,UserMetadataType,WebAuthnType,captureEvent,cleanSentryConfig,isFullTokenStore});
//# sourceMappingURL=index.cjs.map